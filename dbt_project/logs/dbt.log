

============================== 2024-07-14 11:29:53.020996 | f23a4b66-5049-4851-af3f-31eaa4d70ddd ==============================
11:29:53.020996 [info ] [MainThread]: Running with dbt=1.0.0
11:29:53.022183 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:29:53.024031 [debug] [MainThread]: Tracking: tracking
11:29:53.029223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397cacfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397cb2fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397cb2fee0>]}
11:29:53.215172 [debug] [MainThread]: Executing "git --help"
11:29:53.221471 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:29:53.222958 [debug] [MainThread]: STDERR: "b''"
11:29:53.228957 [debug] [MainThread]: Acquiring new postgres connection "debug"
11:29:53.233366 [debug] [MainThread]: Using postgres connection "debug"
11:29:53.234640 [debug] [MainThread]: On debug: select 1 as id
11:29:53.235812 [debug] [MainThread]: Opening a new connection, currently in state init
11:29:53.245202 [debug] [MainThread]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "postgres" (192.168.16.2), port 5432 failed: FATAL:  password authentication failed for user "dbt_user"
'
11:29:53.247508 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
11:29:53.248719 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
11:29:53.249970 [debug] [MainThread]: On debug: No close available on handle
11:29:53.251791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397c4fcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397c4fceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397c4fcd60>]}
11:29:53.700112 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 11:46:41.412408 | 0b4b82a4-0265-4e29-80eb-1023920f9ada ==============================
11:46:41.412408 [info ] [MainThread]: Running with dbt=1.0.0
11:46:41.413503 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:46:41.415342 [debug] [MainThread]: Tracking: tracking
11:46:41.419916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8f44fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8f4aedc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8f4aeee0>]}
11:46:41.549219 [debug] [MainThread]: Executing "git --help"
11:46:41.555637 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:46:41.557207 [debug] [MainThread]: STDERR: "b''"
11:46:41.562288 [debug] [MainThread]: Acquiring new postgres connection "debug"
11:46:41.566445 [debug] [MainThread]: Using postgres connection "debug"
11:46:41.568868 [debug] [MainThread]: On debug: select 1 as id
11:46:41.572652 [debug] [MainThread]: Opening a new connection, currently in state init
11:46:41.580428 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
11:46:41.583161 [debug] [MainThread]: On debug: Close
11:46:41.585132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ee89eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ee89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ee893a0>]}
11:46:42.012135 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 11:48:41.401773 | 4ed723bf-575c-4f03-93ba-feadc11c4852 ==============================
11:48:41.401773 [info ] [MainThread]: Running with dbt=1.0.0
11:48:41.402759 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:48:41.404732 [debug] [MainThread]: Tracking: tracking
11:48:41.409740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1d317ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1d317d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1d317d60>]}
11:48:41.578741 [debug] [MainThread]: Executing "git --help"
11:48:41.584688 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:48:41.586162 [debug] [MainThread]: STDERR: "b''"
11:48:41.596780 [debug] [MainThread]: Acquiring new postgres connection "debug"
11:48:41.603924 [debug] [MainThread]: Using postgres connection "debug"
11:48:41.605142 [debug] [MainThread]: On debug: select 1 as id
11:48:41.608087 [debug] [MainThread]: Opening a new connection, currently in state init
11:48:41.621539 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
11:48:41.626016 [debug] [MainThread]: On debug: Close
11:48:41.628852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1cb47100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1cb47a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1cb474f0>]}
11:48:42.081496 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 11:56:02.923725 | d53bfe59-7a05-4cec-9e54-e6145155598b ==============================
11:56:02.923725 [info ] [MainThread]: Running with dbt=1.0.0
11:56:02.924733 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:56:02.926254 [debug] [MainThread]: Tracking: tracking
11:56:02.931463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0688657b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0688657d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0688657c40>]}
11:56:03.060072 [debug] [MainThread]: Executing "git --help"
11:56:03.066406 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:56:03.068087 [debug] [MainThread]: STDERR: "b''"
11:56:03.081456 [debug] [MainThread]: Acquiring new postgres connection "debug"
11:56:03.082997 [debug] [MainThread]: Using postgres connection "debug"
11:56:03.084232 [debug] [MainThread]: On debug: select 1 as id
11:56:03.085415 [debug] [MainThread]: Opening a new connection, currently in state init
11:56:03.093682 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
11:56:03.098162 [debug] [MainThread]: On debug: Close
11:56:03.100308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0688066bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06880663a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0688066fa0>]}
11:56:03.545592 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 11:57:22.465167 | 0c358010-47b4-435d-b3cd-2387728e7898 ==============================
11:57:22.465167 [info ] [MainThread]: Running with dbt=1.0.0
11:57:22.466191 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
11:57:22.468213 [debug] [MainThread]: Tracking: tracking
11:57:22.473638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cbb17be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cbb17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cbb17ca0>]}
11:57:22.614448 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
11:57:22.615846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c358010-47b4-435d-b3cd-2387728e7898', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cafcb3a0>]}
11:57:22.617850 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
11:57:22.619175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c358010-47b4-435d-b3cd-2387728e7898', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9cafcb130>]}
11:57:22.648851 [debug] [MainThread]: Executing "git --help"
11:57:22.655348 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
11:57:22.657291 [debug] [MainThread]: STDERR: "b''"
11:57:22.668639 [debug] [MainThread]: Acquiring new postgres connection "debug"
11:57:22.670633 [debug] [MainThread]: Using postgres connection "debug"
11:57:22.672158 [debug] [MainThread]: On debug: select 1 as id
11:57:22.674078 [debug] [MainThread]: Opening a new connection, currently in state init
11:57:22.687931 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
11:57:22.692642 [debug] [MainThread]: On debug: Close
11:57:22.696039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9caf86100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9caf86a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9caf86250>]}
11:57:23.119274 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 11:59:39.862852 | 3419d745-3f55-4a5f-9d48-0a8c4abd1e8b ==============================
11:59:39.862852 [info ] [MainThread]: Running with dbt=1.0.0
11:59:39.864356 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:59:39.866601 [debug] [MainThread]: Tracking: tracking
11:59:39.873066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332700fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332700fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332700fb50>]}
11:59:39.904677 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
11:59:39.906721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3419d745-3f55-4a5f-9d48-0a8c4abd1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327014310>]}
11:59:39.970541 [debug] [MainThread]: Parsing macros/catalog.sql
11:59:39.978183 [debug] [MainThread]: Parsing macros/adapters.sql
11:59:40.024946 [debug] [MainThread]: Parsing macros/relations.sql
11:59:40.028741 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
11:59:40.032686 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:59:40.052006 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:59:40.070730 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:59:40.076335 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:59:40.082478 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:59:40.097125 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:59:40.101884 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:59:40.110821 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:59:40.127864 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:59:40.137181 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:59:40.142624 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:59:40.146429 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:59:40.150401 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:59:40.155468 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:59:40.163710 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:59:40.178630 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:59:40.184611 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:59:40.189651 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:59:40.193023 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:59:40.207503 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:59:40.213485 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:59:40.237284 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:59:40.241114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:59:40.275382 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:59:40.294992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:59:40.304949 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:59:40.353077 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:59:40.373263 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:59:40.379256 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:59:40.383808 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:59:40.397356 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:59:40.421117 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:59:40.444551 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:59:40.477359 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:59:40.481398 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:59:40.483955 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:59:40.487502 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:59:40.489557 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:59:40.491700 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:59:40.843413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.your_model_name

11:59:40.854402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3419d745-3f55-4a5f-9d48-0a8c4abd1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3326ff4970>]}
11:59:40.876030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3419d745-3f55-4a5f-9d48-0a8c4abd1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33270140a0>]}
11:59:40.877467 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
11:59:40.880635 [info ] [MainThread]: 
11:59:40.882455 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
11:59:40.904886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33270baf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332703e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332703e880>]}


============================== 2024-07-14 12:01:13.483759 | ce9a2437-ca07-47de-bff3-73935e8b86fd ==============================
12:01:13.483759 [info ] [MainThread]: Running with dbt=1.0.0
12:01:13.484803 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
12:01:13.486524 [debug] [MainThread]: Tracking: tracking
12:01:13.491648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cdc56e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cdc562e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cdc565e0>]}
12:01:13.625782 [debug] [MainThread]: Executing "git --help"
12:01:13.632095 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:01:13.633733 [debug] [MainThread]: STDERR: "b''"
12:01:13.642704 [debug] [MainThread]: Acquiring new postgres connection "debug"
12:01:13.645430 [debug] [MainThread]: Using postgres connection "debug"
12:01:13.646738 [debug] [MainThread]: On debug: select 1 as id
12:01:13.647907 [debug] [MainThread]: Opening a new connection, currently in state init
12:01:13.659458 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
12:01:13.661989 [debug] [MainThread]: On debug: Close
12:01:13.663885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cd3f7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cd3f7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5cd3f74f0>]}
12:01:14.102599 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 12:02:32.089075 | e387a805-8624-446b-897d-a2ff95c02369 ==============================
12:02:32.089075 [info ] [MainThread]: Running with dbt=1.0.0
12:02:32.090145 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
12:02:32.091833 [debug] [MainThread]: Tracking: tracking
12:02:32.096716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5429c97c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5429c97cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5429c97d30>]}
12:02:32.237218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
12:02:32.238814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e387a805-8624-446b-897d-a2ff95c02369', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54296ee490>]}
12:02:32.241212 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
12:02:32.242681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e387a805-8624-446b-897d-a2ff95c02369', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54296ee970>]}
12:02:32.272430 [debug] [MainThread]: Executing "git --help"
12:02:32.277913 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:02:32.279332 [debug] [MainThread]: STDERR: "b''"
12:02:32.290511 [debug] [MainThread]: Acquiring new postgres connection "debug"
12:02:32.292053 [debug] [MainThread]: Using postgres connection "debug"
12:02:32.293269 [debug] [MainThread]: On debug: select 1 as id
12:02:32.295231 [debug] [MainThread]: Opening a new connection, currently in state init
12:02:32.309255 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
12:02:32.312467 [debug] [MainThread]: On debug: Close
12:02:32.314212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54296ab100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54296ab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54296ab250>]}
12:02:32.750195 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 17:29:46.142115 | 606a39b0-7c98-4598-a58e-c331443c496b ==============================
17:29:46.142115 [info ] [MainThread]: Running with dbt=1.0.0
17:29:46.144094 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:29:46.146180 [debug] [MainThread]: Tracking: tracking
17:29:46.154547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5ad7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5ad7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b5ad7c70>]}
17:29:46.352659 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:29:46.354036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '606a39b0-7c98-4598-a58e-c331443c496b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b552f130>]}
17:29:46.358476 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:29:46.360450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '606a39b0-7c98-4598-a58e-c331443c496b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b552e0d0>]}
17:29:46.388928 [debug] [MainThread]: Executing "git --help"
17:29:46.420021 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:29:46.421532 [debug] [MainThread]: STDERR: "b''"
17:29:46.432991 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:29:46.435033 [debug] [MainThread]: Using postgres connection "debug"
17:29:46.436147 [debug] [MainThread]: On debug: select 1 as id
17:29:46.437648 [debug] [MainThread]: Opening a new connection, currently in state init
17:29:46.475229 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
17:29:46.478343 [debug] [MainThread]: On debug: Close
17:29:46.480034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b54e9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b54e9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b54e9250>]}
17:29:46.940955 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 17:53:02.709242 | a3f5fc09-8c6b-4923-abca-5cd66c466eb0 ==============================
17:53:02.709242 [info ] [MainThread]: Running with dbt=1.0.0
17:53:02.710217 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:53:02.712087 [debug] [MainThread]: Tracking: tracking
17:53:02.718986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fe297bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fe297d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fe297c70>]}
17:53:02.883742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:53:02.885300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3f5fc09-8c6b-4923-abca-5cd66c466eb0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdcdaee0>]}
17:53:02.887549 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:53:02.889070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3f5fc09-8c6b-4923-abca-5cd66c466eb0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdcd00d0>]}
17:53:02.921203 [debug] [MainThread]: Executing "git --help"
17:53:02.947270 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:53:02.948810 [debug] [MainThread]: STDERR: "b''"
17:53:02.960478 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:53:02.962104 [debug] [MainThread]: Using postgres connection "debug"
17:53:02.963409 [debug] [MainThread]: On debug: select 1 as id
17:53:02.964574 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:02.999305 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
17:53:03.002778 [debug] [MainThread]: On debug: Close
17:53:03.004901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdc8a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdc8aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fdc8a250>]}
17:53:03.452255 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-14 23:27:03.699490 | ce1ab92a-7a07-4f8e-8c5a-a274bf02efcb ==============================
23:27:03.699490 [info ] [MainThread]: Running with dbt=1.0.0
23:27:03.700860 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
23:27:03.703953 [debug] [MainThread]: Tracking: tracking
23:27:03.709065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2d886d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e30e3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2d88c10>]}
23:27:03.838954 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
23:27:03.840441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce1ab92a-7a07-4f8e-8c5a-a274bf02efcb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2524340>]}
23:27:03.842753 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
23:27:03.844229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce1ab92a-7a07-4f8e-8c5a-a274bf02efcb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e25244c0>]}
23:27:03.873971 [debug] [MainThread]: Executing "git --help"
23:27:03.880749 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:27:03.883690 [debug] [MainThread]: STDERR: "b''"
23:27:03.890725 [debug] [MainThread]: Acquiring new postgres connection "debug"
23:27:03.903497 [debug] [MainThread]: Using postgres connection "debug"
23:27:03.904866 [debug] [MainThread]: On debug: select 1 as id
23:27:03.906533 [debug] [MainThread]: Opening a new connection, currently in state init
23:27:03.917136 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
23:27:03.920859 [debug] [MainThread]: On debug: Close
23:27:03.923212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2daef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2d88af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2d88f40>]}
23:27:04.318048 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 20:36:50.604741 | 96fef9d9-7e98-4f51-bda3-cddfc55ed03f ==============================
20:36:50.604741 [info ] [MainThread]: Running with dbt=1.0.0
20:36:50.606408 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
20:36:50.609583 [debug] [MainThread]: Tracking: tracking
20:36:50.617292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546d17b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546d17d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546d17c40>]}
20:36:50.893792 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:36:50.895532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96fef9d9-7e98-4f51-bda3-cddfc55ed03f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65461d8eb0>]}
20:36:50.897819 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:36:50.899355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '96fef9d9-7e98-4f51-bda3-cddfc55ed03f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65461ce850>]}
20:36:50.939843 [debug] [MainThread]: Executing "git --help"
20:36:50.967966 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
20:36:50.970233 [debug] [MainThread]: STDERR: "b''"
20:36:50.981529 [debug] [MainThread]: Acquiring new postgres connection "debug"
20:36:50.988587 [debug] [MainThread]: Using postgres connection "debug"
20:36:50.990811 [debug] [MainThread]: On debug: select 1 as id
20:36:50.992249 [debug] [MainThread]: Opening a new connection, currently in state init
20:36:51.001058 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
20:36:51.005910 [debug] [MainThread]: On debug: Close
20:36:51.008864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546188100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546188a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6546188250>]}
20:36:51.432986 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 21:13:20.824149 | ffd596b3-f9ea-4bf2-abb7-76bc14a7c2da ==============================
21:13:20.824149 [info ] [MainThread]: Running with dbt=1.0.0
21:13:20.825644 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
21:13:20.831704 [debug] [MainThread]: Tracking: tracking
21:13:20.839039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc4f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc4fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc4fe20>]}
21:13:21.034619 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:13:21.036947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ffd596b3-f9ea-4bf2-abb7-76bc14a7c2da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc4f820>]}
21:13:21.039655 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:13:21.041900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ffd596b3-f9ea-4bf2-abb7-76bc14a7c2da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc4f9d0>]}
21:13:21.075215 [debug] [MainThread]: Executing "git --help"
21:13:21.130170 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
21:13:21.131973 [debug] [MainThread]: STDERR: "b''"
21:13:21.140639 [debug] [MainThread]: Acquiring new postgres connection "debug"
21:13:21.148472 [debug] [MainThread]: Using postgres connection "debug"
21:13:21.151352 [debug] [MainThread]: On debug: select 1 as id
21:13:21.152874 [debug] [MainThread]: Opening a new connection, currently in state init
21:13:21.165836 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:13:21.172938 [debug] [MainThread]: On debug: Close
21:13:21.185513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fcc75760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fccafe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fccaffa0>]}
21:13:21.655504 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 21:13:48.598791 | c9af5174-db24-4153-afe6-41d45cb986f9 ==============================
21:13:48.598791 [info ] [MainThread]: Running with dbt=1.0.0
21:13:48.600518 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:13:48.603254 [debug] [MainThread]: Tracking: tracking
21:13:48.610910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96d2cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96d2cfc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96d2cf6d0>]}
21:13:48.681174 [info ] [MainThread]: Unable to do partial parsing because profile has changed
21:13:48.682653 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
21:13:48.684498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9af5174-db24-4153-afe6-41d45cb986f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96d2f5970>]}
21:13:48.778228 [debug] [MainThread]: Parsing macros/catalog.sql
21:13:48.789848 [debug] [MainThread]: Parsing macros/adapters.sql
21:13:48.839701 [debug] [MainThread]: Parsing macros/relations.sql
21:13:48.843620 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
21:13:48.847623 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:13:48.867134 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:13:48.886745 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:13:48.892755 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:13:48.899484 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:13:48.916506 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:13:48.921563 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:13:48.930963 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:13:48.948546 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:13:48.958073 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:13:48.963809 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:13:48.967305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:13:48.971085 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:13:48.976076 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:13:48.984058 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:13:48.998976 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:13:49.005103 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:13:49.012488 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:13:49.015758 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:13:49.030406 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:13:49.036747 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:13:49.065959 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:13:49.071673 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:13:49.124327 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:13:49.148356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:13:49.158313 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:13:49.195343 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:13:49.209425 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:13:49.213893 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:13:49.218077 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:13:49.227843 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:13:49.252532 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:13:49.276675 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:13:49.310685 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:13:49.314892 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:13:49.317918 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:13:49.321564 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:13:49.323674 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:13:49.326106 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:13:49.695522 [debug] [MainThread]: 1699: static parser successfully parsed customers_orders.sql
21:13:49.747766 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.your_model_name

21:13:49.760233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9af5174-db24-4153-afe6-41d45cb986f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c99b0d0>]}
21:13:49.784857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9af5174-db24-4153-afe6-41d45cb986f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c9920d0>]}
21:13:49.786942 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:13:49.801278 [info ] [MainThread]: 
21:13:49.810326 [debug] [MainThread]: Acquiring new postgres connection "master"
21:13:49.813189 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
21:13:49.837847 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
21:13:49.839281 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
21:13:49.840686 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:13:49.848429 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
21:13:49.851451 [debug] [ThreadPool]: On list_dbt_database: Close
21:13:49.854374 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_public"
21:13:49.866570 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_public"
21:13:49.867891 [debug] [ThreadPool]: On list_dbt_database_public: BEGIN
21:13:49.869145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:13:49.875082 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:13:49.876715 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_public"
21:13:49.878360 [debug] [ThreadPool]: On list_dbt_database_public: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database_public"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:13:49.886636 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
21:13:49.890045 [debug] [ThreadPool]: On list_dbt_database_public: ROLLBACK
21:13:49.892068 [debug] [ThreadPool]: On list_dbt_database_public: Close
21:13:49.898881 [debug] [MainThread]: Using postgres connection "master"
21:13:49.900119 [debug] [MainThread]: On master: BEGIN
21:13:49.901148 [debug] [MainThread]: Opening a new connection, currently in state init
21:13:49.906259 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:13:49.907469 [debug] [MainThread]: Using postgres connection "master"
21:13:49.908464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:13:49.922516 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
21:13:49.924847 [debug] [MainThread]: On master: ROLLBACK
21:13:49.926154 [debug] [MainThread]: Using postgres connection "master"
21:13:49.927311 [debug] [MainThread]: On master: BEGIN
21:13:49.928764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:13:49.929879 [debug] [MainThread]: On master: COMMIT
21:13:49.930964 [debug] [MainThread]: Using postgres connection "master"
21:13:49.931900 [debug] [MainThread]: On master: COMMIT
21:13:49.933121 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:13:49.934165 [debug] [MainThread]: On master: Close
21:13:49.935465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:13:49.936823 [info ] [MainThread]: 
21:13:49.962358 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
21:13:49.963610 [info ] [Thread-1  ]: 1 of 1 START view model public.customers_orders................................. [RUN]
21:13:49.966224 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
21:13:49.970119 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
21:13:49.972069 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
21:13:49.976545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
21:13:49.998957 [debug] [Thread-1  ]: finished collecting timing info
21:13:50.000303 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
21:13:50.055909 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
21:13:50.068908 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:13:50.070097 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
21:13:50.071636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:13:50.076569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
21:13:50.077917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:13:50.079103 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."public"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from jaffle_shop.orders as ord
left join jaffle_shop.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
21:13:50.084440 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
21:13:50.093571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:13:50.094644 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."public"."customers_orders__dbt_tmp" rename to "customers_orders"
21:13:50.097082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:13:50.107599 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
21:13:50.108643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:13:50.109537 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
21:13:50.111600 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
21:13:50.118716 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:13:50.119765 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."public"."customers_orders__dbt_backup" cascade
21:13:50.121022 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
21:13:50.123234 [debug] [Thread-1  ]: finished collecting timing info
21:13:50.124241 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
21:13:50.125578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9af5174-db24-4153-afe6-41d45cb986f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c987ee0>]}
21:13:50.127045 [info ] [Thread-1  ]: 1 of 1 OK created view model public.customers_orders............................ [[32mCREATE VIEW[0m in 0.16s]
21:13:50.128371 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
21:13:50.131733 [debug] [MainThread]: Acquiring new postgres connection "master"
21:13:50.133230 [debug] [MainThread]: Using postgres connection "master"
21:13:50.134283 [debug] [MainThread]: On master: BEGIN
21:13:50.135262 [debug] [MainThread]: Opening a new connection, currently in state closed
21:13:50.139694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:13:50.140821 [debug] [MainThread]: On master: COMMIT
21:13:50.141852 [debug] [MainThread]: Using postgres connection "master"
21:13:50.142753 [debug] [MainThread]: On master: COMMIT
21:13:50.143835 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:13:50.144775 [debug] [MainThread]: On master: Close
21:13:50.146468 [info ] [MainThread]: 
21:13:50.148172 [info ] [MainThread]: Finished running 1 view model in 0.34s.
21:13:50.150416 [debug] [MainThread]: Connection 'master' was properly closed.
21:13:50.152351 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
21:13:50.173691 [info ] [MainThread]: 
21:13:50.175381 [info ] [MainThread]: [32mCompleted successfully[0m
21:13:50.178200 [info ] [MainThread]: 
21:13:50.180816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:13:50.184532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c967040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c9fa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96c94d850>]}


============================== 2024-07-15 21:49:36.625843 | 1e5f47d7-0a31-4a93-b627-ea90e603d306 ==============================
21:49:36.625843 [info ] [MainThread]: Running with dbt=1.0.0
21:49:36.629918 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
21:49:36.637717 [debug] [MainThread]: Tracking: tracking
21:49:36.657180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622ca8f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622ca8fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622ca8fe20>]}
21:49:36.889548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:49:36.891910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e5f47d7-0a31-4a93-b627-ea90e603d306', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622ca8f820>]}
21:49:36.895132 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:49:36.897361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1e5f47d7-0a31-4a93-b627-ea90e603d306', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622ca8f9d0>]}
21:49:36.953298 [debug] [MainThread]: Executing "git --help"
21:49:36.991402 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
21:49:36.993423 [debug] [MainThread]: STDERR: "b''"
21:49:37.007155 [debug] [MainThread]: Acquiring new postgres connection "debug"
21:49:37.009959 [debug] [MainThread]: Using postgres connection "debug"
21:49:37.011776 [debug] [MainThread]: On debug: select 1 as id
21:49:37.013461 [debug] [MainThread]: Opening a new connection, currently in state init
21:49:37.029605 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
21:49:37.035361 [debug] [MainThread]: On debug: Close
21:49:37.037966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622cab50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622caefe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622caefeb0>]}
21:49:37.533055 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 21:53:31.189841 | a72ea05f-c5b8-4432-a7b9-06ae55ab1379 ==============================
21:53:31.189841 [info ] [MainThread]: Running with dbt=1.0.0
21:53:31.193285 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
21:53:31.197852 [debug] [MainThread]: Tracking: tracking
21:53:31.211945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a997bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a997d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a997c70>]}
21:53:31.477428 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:53:31.479113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a72ea05f-c5b8-4432-a7b9-06ae55ab1379', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a179ee0>]}
21:53:31.481922 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:53:31.483646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a72ea05f-c5b8-4432-a7b9-06ae55ab1379', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a16f0d0>]}
21:53:31.530706 [debug] [MainThread]: Executing "git --help"
21:53:31.541655 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
21:53:31.543715 [debug] [MainThread]: STDERR: "b''"
21:53:31.559874 [debug] [MainThread]: Acquiring new postgres connection "debug"
21:53:31.562744 [debug] [MainThread]: Using postgres connection "debug"
21:53:31.565707 [debug] [MainThread]: On debug: select 1 as id
21:53:31.567380 [debug] [MainThread]: Opening a new connection, currently in state init
21:53:31.578419 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:53:31.584206 [debug] [MainThread]: On debug: Close
21:53:31.586641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a129100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a129a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26a129250>]}
21:53:32.062531 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 21:56:13.340675 | 9c48a1a0-c90e-41a2-8b8a-bf94b489744c ==============================
21:56:13.340675 [info ] [MainThread]: Running with dbt=1.0.0
21:56:13.342628 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
21:56:13.344969 [debug] [MainThread]: Tracking: tracking
21:56:13.352023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e797be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e797d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78e797ca0>]}
21:56:13.535739 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:56:13.537641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c48a1a0-c90e-41a2-8b8a-bf94b489744c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78df8b3a0>]}
21:56:13.540491 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
21:56:13.542816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c48a1a0-c90e-41a2-8b8a-bf94b489744c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78df8b130>]}
21:56:13.588028 [debug] [MainThread]: Executing "git --help"
21:56:13.596574 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
21:56:13.598542 [debug] [MainThread]: STDERR: "b''"
21:56:13.612140 [debug] [MainThread]: Acquiring new postgres connection "debug"
21:56:13.615805 [debug] [MainThread]: Using postgres connection "debug"
21:56:13.617388 [debug] [MainThread]: On debug: select 1 as id
21:56:13.618936 [debug] [MainThread]: Opening a new connection, currently in state init
21:56:13.629261 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
21:56:13.633226 [debug] [MainThread]: On debug: Close
21:56:13.639134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78df47100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78df47a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc78df47250>]}
21:56:14.093773 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 21:59:43.766514 | b53b1c76-5eaf-46b8-bbec-6969a70e5ad4 ==============================
21:59:43.766514 [info ] [MainThread]: Running with dbt=1.0.0
21:59:43.769034 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
21:59:43.771868 [debug] [MainThread]: Tracking: tracking
21:59:43.778621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d417cfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d417cf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d417cf640>]}
21:59:43.840476 [info ] [MainThread]: Unable to do partial parsing because profile has changed
21:59:43.842433 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
21:59:43.844757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b53b1c76-5eaf-46b8-bbec-6969a70e5ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d41b4efd0>]}
21:59:43.954237 [debug] [MainThread]: Parsing macros/catalog.sql
21:59:43.965547 [debug] [MainThread]: Parsing macros/adapters.sql
21:59:44.023447 [debug] [MainThread]: Parsing macros/relations.sql
21:59:44.028502 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
21:59:44.034350 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:59:44.065443 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:59:44.097201 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:59:44.106097 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:59:44.116085 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:59:44.140249 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:59:44.147824 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:59:44.161841 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:59:44.191187 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:59:44.215809 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:59:44.230467 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:59:44.240573 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:59:44.250471 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:59:44.263988 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:59:44.279861 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:59:44.300488 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:59:44.308240 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:59:44.317101 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:59:44.322588 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:59:44.351443 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:59:44.367205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:59:44.420487 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:59:44.425209 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:59:44.463565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:59:44.486119 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:59:44.497676 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:59:44.539728 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:59:44.557950 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:59:44.564272 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:59:44.571302 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:59:44.586721 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:59:44.627454 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:59:44.663894 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:59:44.730903 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:59:44.738726 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:59:44.743461 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:59:44.750117 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:59:44.753877 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:59:44.758111 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:59:45.211856 [debug] [MainThread]: 1699: static parser successfully parsed customers_orders.sql
21:59:45.284081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.trusted

21:59:45.310411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b53b1c76-5eaf-46b8-bbec-6969a70e5ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40b460d0>]}
21:59:45.341163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b53b1c76-5eaf-46b8-bbec-6969a70e5ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40f8fb50>]}
21:59:45.343111 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:59:45.347996 [info ] [MainThread]: 
21:59:45.350707 [debug] [MainThread]: Acquiring new postgres connection "master"
21:59:45.355478 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
21:59:45.378354 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
21:59:45.379818 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
21:59:45.381301 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:59:45.388326 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
21:59:45.393701 [debug] [ThreadPool]: On list_dbt_database: Close
21:59:45.396222 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_trusted"
21:59:45.398156 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_trusted"
21:59:45.399807 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='trusted', identifier=None)"
21:59:45.410637 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_trusted"
21:59:45.413786 [debug] [ThreadPool]: On create_dbt_database_trusted: BEGIN
21:59:45.415253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:59:45.420939 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:59:45.422312 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_trusted"
21:59:45.423568 [debug] [ThreadPool]: On create_dbt_database_trusted: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_database_trusted"} */
create schema if not exists "trusted"
21:59:45.425586 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
21:59:45.428227 [debug] [ThreadPool]: On create_dbt_database_trusted: COMMIT
21:59:45.429540 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_trusted"
21:59:45.431142 [debug] [ThreadPool]: On create_dbt_database_trusted: COMMIT
21:59:45.434156 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
21:59:45.435806 [debug] [ThreadPool]: On create_dbt_database_trusted: Close
21:59:45.438788 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_trusted"
21:59:45.450362 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_trusted"
21:59:45.451952 [debug] [ThreadPool]: On list_dbt_database_trusted: BEGIN
21:59:45.454070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:59:45.464705 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:59:45.467673 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_trusted"
21:59:45.470078 [debug] [ThreadPool]: On list_dbt_database_trusted: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database_trusted"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trusted'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trusted'
  
21:59:45.479268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
21:59:45.488799 [debug] [ThreadPool]: On list_dbt_database_trusted: ROLLBACK
21:59:45.492077 [debug] [ThreadPool]: On list_dbt_database_trusted: Close
21:59:45.510724 [debug] [MainThread]: Using postgres connection "master"
21:59:45.513024 [debug] [MainThread]: On master: BEGIN
21:59:45.516034 [debug] [MainThread]: Opening a new connection, currently in state init
21:59:45.526853 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:59:45.529369 [debug] [MainThread]: Using postgres connection "master"
21:59:45.532105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:59:45.546624 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
21:59:45.552712 [debug] [MainThread]: On master: ROLLBACK
21:59:45.555589 [debug] [MainThread]: Using postgres connection "master"
21:59:45.557897 [debug] [MainThread]: On master: BEGIN
21:59:45.561672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:59:45.563697 [debug] [MainThread]: On master: COMMIT
21:59:45.565973 [debug] [MainThread]: Using postgres connection "master"
21:59:45.568486 [debug] [MainThread]: On master: COMMIT
21:59:45.571047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:59:45.573208 [debug] [MainThread]: On master: Close
21:59:45.576577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
21:59:45.579474 [info ] [MainThread]: 
21:59:45.651491 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
21:59:45.654138 [info ] [Thread-1  ]: 1 of 1 START view model trusted.customers_orders................................ [RUN]
21:59:45.657805 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
21:59:45.667683 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
21:59:45.670742 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
21:59:45.681290 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
21:59:45.705981 [debug] [Thread-1  ]: finished collecting timing info
21:59:45.710513 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
21:59:45.811354 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
21:59:45.833901 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:59:45.836721 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
21:59:45.839410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:45.852180 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
21:59:45.855202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
21:59:45.857627 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."trusted"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from jaffle_shop.orders as ord
left join jaffle_shop.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
21:59:45.861808 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "jaffle_shop.orders" does not exist
LINE 7: from jaffle_shop.orders as ord
             ^

21:59:45.864304 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: ROLLBACK
21:59:45.867480 [debug] [Thread-1  ]: finished collecting timing info
21:59:45.871010 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
21:59:45.874377 [debug] [Thread-1  ]: Database Error in model customers_orders (models/customers_orders.sql)
  relation "jaffle_shop.orders" does not exist
  LINE 7: from jaffle_shop.orders as ord
               ^
  compiled SQL at target/run/dbt_project/models/customers_orders.sql
21:59:45.877763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53b1c76-5eaf-46b8-bbec-6969a70e5ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40b3c6a0>]}
21:59:45.881295 [error] [Thread-1  ]: 1 of 1 ERROR creating view model trusted.customers_orders....................... [[31mERROR[0m in 0.22s]
21:59:45.885163 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
21:59:45.893107 [debug] [MainThread]: Acquiring new postgres connection "master"
21:59:45.895642 [debug] [MainThread]: Using postgres connection "master"
21:59:45.898117 [debug] [MainThread]: On master: BEGIN
21:59:45.900783 [debug] [MainThread]: Opening a new connection, currently in state closed
21:59:45.912591 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:59:45.918708 [debug] [MainThread]: On master: COMMIT
21:59:45.922019 [debug] [MainThread]: Using postgres connection "master"
21:59:45.924553 [debug] [MainThread]: On master: COMMIT
21:59:45.927207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:59:45.929667 [debug] [MainThread]: On master: Close
21:59:45.934254 [info ] [MainThread]: 
21:59:45.938461 [info ] [MainThread]: Finished running 1 view model in 0.58s.
21:59:45.944451 [debug] [MainThread]: Connection 'master' was properly closed.
21:59:45.949769 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
21:59:45.999390 [info ] [MainThread]: 
21:59:46.005748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:59:46.010564 [info ] [MainThread]: 
21:59:46.017394 [error] [MainThread]: [33mDatabase Error in model customers_orders (models/customers_orders.sql)[0m
21:59:46.024772 [error] [MainThread]:   relation "jaffle_shop.orders" does not exist
21:59:46.029284 [error] [MainThread]:   LINE 7: from jaffle_shop.orders as ord
21:59:46.033917 [error] [MainThread]:                ^
21:59:46.046473 [error] [MainThread]:   compiled SQL at target/run/dbt_project/models/customers_orders.sql
21:59:46.052269 [info ] [MainThread]: 
21:59:46.060644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
21:59:46.064871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40b27df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40b27100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d40b3ce80>]}


============================== 2024-07-15 22:01:44.207856 | f309908e-e3d9-419a-b283-e8a146421842 ==============================
22:01:44.207856 [info ] [MainThread]: Running with dbt=1.0.0
22:01:44.210905 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
22:01:44.215978 [debug] [MainThread]: Tracking: tracking
22:01:44.230042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c1cfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c4dddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c4ddee0>]}
22:01:44.429416 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:01:44.431184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f309908e-e3d9-419a-b283-e8a146421842', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1b9755e0>]}
22:01:44.434028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:01:44.435857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f309908e-e3d9-419a-b283-e8a146421842', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1b975160>]}
22:01:44.471887 [debug] [MainThread]: Executing "git --help"
22:01:44.479922 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:01:44.482447 [debug] [MainThread]: STDERR: "b''"
22:01:44.491840 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:01:44.494304 [debug] [MainThread]: Using postgres connection "debug"
22:01:44.495914 [debug] [MainThread]: On debug: select 1 as id
22:01:44.497584 [debug] [MainThread]: Opening a new connection, currently in state init
22:01:44.509148 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
22:01:44.512483 [debug] [MainThread]: On debug: Close
22:01:44.514443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1c1cf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1b975370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e1b975f10>]}
22:01:44.959289 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 22:01:57.424983 | af6f3618-95b1-407e-b28f-a49bc92f014d ==============================
22:01:57.424983 [info ] [MainThread]: Running with dbt=1.0.0
22:01:57.427051 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:01:57.430041 [debug] [MainThread]: Tracking: tracking
22:01:57.439107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a324fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a324f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a324f040>]}
22:01:57.602926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:01:57.604525 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/customers_orders.sql
22:01:57.628779 [debug] [MainThread]: 1699: static parser successfully parsed customers_orders.sql
22:01:57.658667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.trusted

22:01:57.672664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6f3618-95b1-407e-b28f-a49bc92f014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a25d00d0>]}
22:01:57.697504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6f3618-95b1-407e-b28f-a49bc92f014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a327f4f0>]}
22:01:57.699795 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:01:57.704693 [info ] [MainThread]: 
22:01:57.709621 [debug] [MainThread]: Acquiring new postgres connection "master"
22:01:57.714501 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
22:01:57.735826 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
22:01:57.737442 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
22:01:57.738575 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:57.745968 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
22:01:57.750514 [debug] [ThreadPool]: On list_dbt_database: Close
22:01:57.753601 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_trusted"
22:01:57.764205 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_trusted"
22:01:57.767582 [debug] [ThreadPool]: On list_dbt_database_trusted: BEGIN
22:01:57.769476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:01:57.774538 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:01:57.775878 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_trusted"
22:01:57.776962 [debug] [ThreadPool]: On list_dbt_database_trusted: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_database_trusted"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'trusted'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'trusted'
  
22:01:57.780672 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
22:01:57.783509 [debug] [ThreadPool]: On list_dbt_database_trusted: ROLLBACK
22:01:57.784975 [debug] [ThreadPool]: On list_dbt_database_trusted: Close
22:01:57.793972 [debug] [MainThread]: Using postgres connection "master"
22:01:57.795236 [debug] [MainThread]: On master: BEGIN
22:01:57.796228 [debug] [MainThread]: Opening a new connection, currently in state init
22:01:57.801253 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:01:57.802514 [debug] [MainThread]: Using postgres connection "master"
22:01:57.803712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:01:57.810670 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:01:57.813402 [debug] [MainThread]: On master: ROLLBACK
22:01:57.814820 [debug] [MainThread]: Using postgres connection "master"
22:01:57.816189 [debug] [MainThread]: On master: BEGIN
22:01:57.817691 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:01:57.819004 [debug] [MainThread]: On master: COMMIT
22:01:57.820179 [debug] [MainThread]: Using postgres connection "master"
22:01:57.821340 [debug] [MainThread]: On master: COMMIT
22:01:57.822724 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:01:57.823862 [debug] [MainThread]: On master: Close
22:01:57.825311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:01:57.826892 [info ] [MainThread]: 
22:01:57.835434 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
22:01:57.837088 [info ] [Thread-1  ]: 1 of 1 START view model trusted.customers_orders................................ [RUN]
22:01:57.839635 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
22:01:57.841154 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
22:01:57.842392 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
22:01:57.845513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
22:01:57.856363 [debug] [Thread-1  ]: finished collecting timing info
22:01:57.857914 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
22:01:57.905313 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
22:01:57.914728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:01:57.916361 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
22:01:57.918014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:01:57.923852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:01:57.925352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:01:57.926581 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."trusted"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
22:01:57.929796 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
22:01:57.941189 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:01:57.942746 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."trusted"."customers_orders__dbt_tmp" rename to "customers_orders"
22:01:57.945231 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:01:57.957591 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:01:57.959274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:01:57.960699 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:01:57.963899 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:01:58.005602 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:01:58.007298 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."trusted"."customers_orders__dbt_backup" cascade
22:01:58.008999 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:01:58.012267 [debug] [Thread-1  ]: finished collecting timing info
22:01:58.013987 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
22:01:58.016262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af6f3618-95b1-407e-b28f-a49bc92f014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2546fa0>]}
22:01:58.018026 [info ] [Thread-1  ]: 1 of 1 OK created view model trusted.customers_orders........................... [[32mCREATE VIEW[0m in 0.18s]
22:01:58.019829 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
22:01:58.024135 [debug] [MainThread]: Acquiring new postgres connection "master"
22:01:58.025858 [debug] [MainThread]: Using postgres connection "master"
22:01:58.027662 [debug] [MainThread]: On master: BEGIN
22:01:58.029003 [debug] [MainThread]: Opening a new connection, currently in state closed
22:01:58.035208 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:01:58.036926 [debug] [MainThread]: On master: COMMIT
22:01:58.038962 [debug] [MainThread]: Using postgres connection "master"
22:01:58.040638 [debug] [MainThread]: On master: COMMIT
22:01:58.042726 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:01:58.044889 [debug] [MainThread]: On master: Close
22:01:58.046929 [info ] [MainThread]: 
22:01:58.048672 [info ] [MainThread]: Finished running 1 view model in 0.34s.
22:01:58.051153 [debug] [MainThread]: Connection 'master' was properly closed.
22:01:58.053861 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
22:01:58.077252 [info ] [MainThread]: 
22:01:58.081328 [info ] [MainThread]: [32mCompleted successfully[0m
22:01:58.087559 [info ] [MainThread]: 
22:01:58.091995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:01:58.095004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a3c24100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a3c24be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2591790>]}


============================== 2024-07-15 22:18:19.353417 | 4d5f0625-e7ac-421e-8d97-a0a273812618 ==============================
22:18:19.353417 [info ] [MainThread]: Running with dbt=1.0.0
22:18:19.355517 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
22:18:19.358602 [debug] [MainThread]: Tracking: tracking
22:18:19.366177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259bcfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25d0913d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259ee2df0>]}
22:18:19.435670 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:18:19.437773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d5f0625-e7ac-421e-8d97-a0a273812618', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259b4e730>]}
22:18:19.440918 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:18:19.442709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d5f0625-e7ac-421e-8d97-a0a273812618', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259b4e0a0>]}
22:18:19.481387 [debug] [MainThread]: Executing "git --help"
22:18:19.489531 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:18:19.491898 [debug] [MainThread]: STDERR: "b''"
22:18:19.493933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259bf5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259b6aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259b6ab80>]}


============================== 2024-07-15 22:20:04.591184 | 257a0066-6f99-4579-8fa8-4affe950abd0 ==============================
22:20:04.591184 [info ] [MainThread]: Running with dbt=1.0.0
22:20:04.594481 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
22:20:04.598745 [debug] [MainThread]: Tracking: tracking
22:20:04.612348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5f58fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5f5efdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5f5efee0>]}
22:20:04.930861 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:20:04.933020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '257a0066-6f99-4579-8fa8-4affe950abd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5f5efac0>]}
22:20:04.935290 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:20:04.937337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '257a0066-6f99-4579-8fa8-4affe950abd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5f5efdc0>]}
22:20:04.979389 [debug] [MainThread]: Executing "git --help"
22:20:04.987144 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:20:04.989542 [debug] [MainThread]: STDERR: "b''"
22:20:05.002756 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:20:05.005586 [debug] [MainThread]: Using postgres connection "debug"
22:20:05.007053 [debug] [MainThread]: On debug: select 1 as id
22:20:05.008608 [debug] [MainThread]: Opening a new connection, currently in state init
22:20:05.019029 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
22:20:05.023259 [debug] [MainThread]: On debug: Close
22:20:05.025185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5ed2a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5ed2abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab5ed2ac70>]}
22:20:05.457878 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 22:22:40.322343 | 76a0490c-2b9a-441f-9ec8-ba8caf8f980a ==============================
22:22:40.322343 [info ] [MainThread]: Running with dbt=1.0.0
22:22:40.323738 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
22:22:40.326286 [debug] [MainThread]: Tracking: tracking
22:22:40.336311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a857bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a857d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a857c70>]}
22:22:40.563497 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:22:40.565471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76a0490c-2b9a-441f-9ec8-ba8caf8f980a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a2bbee0>]}
22:22:40.568239 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:22:40.570235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76a0490c-2b9a-441f-9ec8-ba8caf8f980a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a2b1820>]}
22:22:40.614432 [debug] [MainThread]: Executing "git --help"
22:22:40.624393 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:22:40.626111 [debug] [MainThread]: STDERR: "b''"
22:22:40.640360 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:22:40.643050 [debug] [MainThread]: Using postgres connection "debug"
22:22:40.644947 [debug] [MainThread]: On debug: select 1 as id
22:22:40.646770 [debug] [MainThread]: Opening a new connection, currently in state init
22:22:40.656428 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
22:22:40.660169 [debug] [MainThread]: On debug: Close
22:22:40.663338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a269100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a269a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0a269250>]}
22:22:41.096678 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 22:24:32.075748 | f375bde0-6f7d-4f69-ae9f-ae3f4e737bc0 ==============================
22:24:32.075748 [info ] [MainThread]: Running with dbt=1.0.0
22:24:32.079118 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:24:32.083752 [debug] [MainThread]: Tracking: tracking
22:24:32.096418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631b4f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631b4ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631b4f3a0>]}
22:24:32.205039 [info ] [MainThread]: Unable to do partial parsing because profile has changed
22:24:32.209457 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
22:24:32.214524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f375bde0-6f7d-4f69-ae9f-ae3f4e737bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5631b36a60>]}
22:24:32.326227 [debug] [MainThread]: Parsing macros/catalog.sql
22:24:32.339948 [debug] [MainThread]: Parsing macros/adapters.sql
22:24:32.466815 [debug] [MainThread]: Parsing macros/relations.sql
22:24:32.476586 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:24:32.487280 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:24:32.521685 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:24:32.565106 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:24:32.572555 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:24:32.579621 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:24:32.597607 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:24:32.603434 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:24:32.614239 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:24:32.634907 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:24:32.645538 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:24:32.652524 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:24:32.657055 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:24:32.661823 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:24:32.668204 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:24:32.678159 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:24:32.696633 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:24:32.704121 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:24:32.710389 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:24:32.714457 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:24:32.732320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:24:32.739587 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:24:32.768970 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:24:32.774236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:24:32.818942 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:24:32.859109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:24:32.877716 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:24:32.963313 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:24:32.995523 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:24:33.005792 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:24:33.016007 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:24:33.039921 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:24:33.092397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:24:33.136574 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:24:33.218312 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:24:33.227944 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:24:33.234718 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:24:33.243058 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:24:33.247734 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:24:33.253619 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:24:33.957213 [debug] [MainThread]: 1699: static parser successfully parsed customers_orders.sql
22:24:34.009197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.customers_orders

22:24:34.023502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f375bde0-6f7d-4f69-ae9f-ae3f4e737bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630e830d0>]}
22:24:34.048574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f375bde0-6f7d-4f69-ae9f-ae3f4e737bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630ed3130>]}
22:24:34.050321 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:24:34.054137 [info ] [MainThread]: 
22:24:34.057655 [debug] [MainThread]: Acquiring new postgres connection "master"
22:24:34.062338 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
22:24:34.083359 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
22:24:34.084798 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
22:24:34.087538 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:24:34.094600 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
22:24:34.098099 [debug] [ThreadPool]: On list_dbt_database: Close
22:24:34.100127 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_refined"
22:24:34.101615 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_refined"
22:24:34.102798 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='refined', identifier=None)"
22:24:34.143168 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_refined"
22:24:34.179033 [debug] [ThreadPool]: On create_dbt_database_refined: BEGIN
22:24:34.196939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:24:34.202922 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:24:34.204181 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_refined"
22:24:34.205422 [debug] [ThreadPool]: On create_dbt_database_refined: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_refined"} */
create schema if not exists "refined"
22:24:34.207344 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
22:24:34.220953 [debug] [ThreadPool]: On create_dbt_database_refined: COMMIT
22:24:34.223037 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_refined"
22:24:34.224989 [debug] [ThreadPool]: On create_dbt_database_refined: COMMIT
22:24:34.229078 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
22:24:34.230322 [debug] [ThreadPool]: On create_dbt_database_refined: Close
22:24:34.232995 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_refined"
22:24:34.243368 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_refined"
22:24:34.244707 [debug] [ThreadPool]: On list_dbt_database_refined: BEGIN
22:24:34.245751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:24:34.250786 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:24:34.251956 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_refined"
22:24:34.253024 [debug] [ThreadPool]: On list_dbt_database_refined: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_refined"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'refined'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'refined'
  
22:24:34.256892 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
22:24:34.259674 [debug] [ThreadPool]: On list_dbt_database_refined: ROLLBACK
22:24:34.260993 [debug] [ThreadPool]: On list_dbt_database_refined: Close
22:24:34.268725 [debug] [MainThread]: Using postgres connection "master"
22:24:34.269966 [debug] [MainThread]: On master: BEGIN
22:24:34.271063 [debug] [MainThread]: Opening a new connection, currently in state init
22:24:34.275839 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:24:34.277010 [debug] [MainThread]: Using postgres connection "master"
22:24:34.278089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:24:34.284357 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:24:34.287848 [debug] [MainThread]: On master: ROLLBACK
22:24:34.289639 [debug] [MainThread]: Using postgres connection "master"
22:24:34.290535 [debug] [MainThread]: On master: BEGIN
22:24:34.291937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:24:34.293044 [debug] [MainThread]: On master: COMMIT
22:24:34.294119 [debug] [MainThread]: Using postgres connection "master"
22:24:34.295167 [debug] [MainThread]: On master: COMMIT
22:24:34.296398 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:24:34.297479 [debug] [MainThread]: On master: Close
22:24:34.299088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:24:34.300473 [info ] [MainThread]: 
22:24:34.330038 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
22:24:34.331761 [info ] [Thread-1  ]: 1 of 1 START view model refined.customers_orders................................ [RUN]
22:24:34.334349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
22:24:34.337453 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
22:24:34.339107 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
22:24:34.344446 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
22:24:34.353599 [debug] [Thread-1  ]: finished collecting timing info
22:24:34.355138 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
22:24:34.408685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
22:24:34.415843 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:24:34.417142 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
22:24:34.418357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:24:34.424782 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:24:34.425969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:24:34.427080 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."refined"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
22:24:34.430413 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
22:24:34.441917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:24:34.443150 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."refined"."customers_orders__dbt_tmp" rename to "customers_orders"
22:24:34.444715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:24:34.458720 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:24:34.460162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:24:34.461520 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:24:34.463860 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:24:34.474532 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:24:34.475896 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."refined"."customers_orders__dbt_backup" cascade
22:24:34.477612 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:24:34.480716 [debug] [Thread-1  ]: finished collecting timing info
22:24:34.482107 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
22:24:34.484051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f375bde0-6f7d-4f69-ae9f-ae3f4e737bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630bdf8e0>]}
22:24:34.485903 [info ] [Thread-1  ]: 1 of 1 OK created view model refined.customers_orders........................... [[32mCREATE VIEW[0m in 0.15s]
22:24:34.487790 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
22:24:34.493186 [debug] [MainThread]: Acquiring new postgres connection "master"
22:24:34.495036 [debug] [MainThread]: Using postgres connection "master"
22:24:34.496553 [debug] [MainThread]: On master: BEGIN
22:24:34.498071 [debug] [MainThread]: Opening a new connection, currently in state closed
22:24:34.504358 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:24:34.505720 [debug] [MainThread]: On master: COMMIT
22:24:34.507854 [debug] [MainThread]: Using postgres connection "master"
22:24:34.509343 [debug] [MainThread]: On master: COMMIT
22:24:34.511393 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:24:34.513629 [debug] [MainThread]: On master: Close
22:24:34.515710 [info ] [MainThread]: 
22:24:34.517494 [info ] [MainThread]: Finished running 1 view model in 0.46s.
22:24:34.520232 [debug] [MainThread]: Connection 'master' was properly closed.
22:24:34.525000 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
22:24:34.554356 [info ] [MainThread]: 
22:24:34.556701 [info ] [MainThread]: [32mCompleted successfully[0m
22:24:34.559938 [info ] [MainThread]: 
22:24:34.563449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:24:34.567831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630be0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630be08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5630be0f70>]}


============================== 2024-07-15 22:27:29.975009 | a25e7373-ab67-4ab0-9c44-dbdbe8a68402 ==============================
22:27:29.975009 [info ] [MainThread]: Running with dbt=1.0.0
22:27:29.976439 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
22:27:29.978512 [debug] [MainThread]: Tracking: tracking
22:27:29.984435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744db8f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744db8f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744db8f820>]}
22:27:30.175352 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:27:30.177668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a25e7373-ab67-4ab0-9c44-dbdbe8a68402', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744d324eb0>]}
22:27:30.180590 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
22:27:30.182595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a25e7373-ab67-4ab0-9c44-dbdbe8a68402', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744d324880>]}
22:27:30.233784 [debug] [MainThread]: Executing "git --help"
22:27:30.243902 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:27:30.246237 [debug] [MainThread]: STDERR: "b''"
22:27:30.259488 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:27:30.262069 [debug] [MainThread]: Using postgres connection "debug"
22:27:30.263966 [debug] [MainThread]: On debug: select 1 as id
22:27:30.265640 [debug] [MainThread]: Opening a new connection, currently in state init
22:27:30.282663 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
22:27:30.286663 [debug] [MainThread]: On debug: Close
22:27:30.289076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744d32aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744d32a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f744d32a5b0>]}
22:27:30.758949 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-15 22:27:38.559076 | efb280d4-d515-493f-b94b-6a8c704edd79 ==============================
22:27:38.559076 [info ] [MainThread]: Running with dbt=1.0.0
22:27:38.561204 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
22:27:38.566146 [debug] [MainThread]: Tracking: tracking
22:27:38.574341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4940fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4940f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4940fd60>]}
22:27:38.717434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
22:27:38.719102 [debug] [MainThread]: Partial parsing: added file: dbt_project://macros/generate_schema_name.sql
22:27:38.720302 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
22:27:38.725052 [info ] [MainThread]: Change detected to override macro used during parsing. Starting full parse.
22:27:38.726749 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
22:27:38.731001 [debug] [MainThread]: Parsing macros/catalog.sql
22:27:38.738749 [debug] [MainThread]: Parsing macros/adapters.sql
22:27:38.794575 [debug] [MainThread]: Parsing macros/relations.sql
22:27:38.798941 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:27:38.803773 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:27:38.825699 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:27:38.849185 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:27:38.856871 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:27:38.865495 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:27:38.885373 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:27:38.891932 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:27:38.904388 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:27:38.927598 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:27:38.940155 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:27:38.947175 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:27:38.951918 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:27:38.957475 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:27:38.964081 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:27:38.975120 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:27:38.994964 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:27:39.004684 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:27:39.012721 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:27:39.018567 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:27:39.049176 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:27:39.063697 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:27:39.125670 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:27:39.134441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:27:39.226435 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:27:39.276003 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:27:39.300413 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:27:39.411931 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:27:39.435900 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:27:39.443730 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:27:39.449773 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:27:39.464047 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:27:39.491433 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:27:39.515843 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:27:39.554679 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:27:39.559930 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:27:39.563365 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:27:39.567459 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:27:39.570070 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:27:39.573058 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:27:40.165686 [debug] [MainThread]: 1699: static parser successfully parsed customers_orders.sql
22:27:40.281962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.customers_orders

22:27:40.315723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb280d4-d515-493f-b94b-6a8c704edd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b487550d0>]}
22:27:40.361796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb280d4-d515-493f-b94b-6a8c704edd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b494140d0>]}
22:27:40.365147 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:27:40.379471 [info ] [MainThread]: 
22:27:40.383411 [debug] [MainThread]: Acquiring new postgres connection "master"
22:27:40.389755 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
22:27:40.414669 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
22:27:40.416231 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
22:27:40.417844 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:27:40.425663 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
22:27:40.428821 [debug] [ThreadPool]: On list_dbt_database: Close
22:27:40.431511 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_refined"
22:27:40.444190 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_refined"
22:27:40.445515 [debug] [ThreadPool]: On list_dbt_database_refined: BEGIN
22:27:40.446581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:27:40.451510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:27:40.452828 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_refined"
22:27:40.453966 [debug] [ThreadPool]: On list_dbt_database_refined: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_refined"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'refined'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'refined'
  
22:27:40.457865 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
22:27:40.461459 [debug] [ThreadPool]: On list_dbt_database_refined: ROLLBACK
22:27:40.463073 [debug] [ThreadPool]: On list_dbt_database_refined: Close
22:27:40.470952 [debug] [MainThread]: Using postgres connection "master"
22:27:40.472432 [debug] [MainThread]: On master: BEGIN
22:27:40.473556 [debug] [MainThread]: Opening a new connection, currently in state init
22:27:40.478587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:27:40.479927 [debug] [MainThread]: Using postgres connection "master"
22:27:40.480917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:27:40.487046 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:27:40.489737 [debug] [MainThread]: On master: ROLLBACK
22:27:40.491049 [debug] [MainThread]: Using postgres connection "master"
22:27:40.492046 [debug] [MainThread]: On master: BEGIN
22:27:40.493388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:27:40.494519 [debug] [MainThread]: On master: COMMIT
22:27:40.495504 [debug] [MainThread]: Using postgres connection "master"
22:27:40.496601 [debug] [MainThread]: On master: COMMIT
22:27:40.498092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:27:40.499352 [debug] [MainThread]: On master: Close
22:27:40.501115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:27:40.502671 [info ] [MainThread]: 
22:27:40.510612 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
22:27:40.511880 [info ] [Thread-1  ]: 1 of 1 START view model refined.customers_orders................................ [RUN]
22:27:40.513640 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
22:27:40.515360 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
22:27:40.516745 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
22:27:40.521884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
22:27:40.531190 [debug] [Thread-1  ]: finished collecting timing info
22:27:40.532539 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
22:27:40.579698 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
22:27:40.588137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:27:40.589290 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
22:27:40.590274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:27:40.595054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
22:27:40.596394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:27:40.597532 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."refined"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
22:27:40.600629 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
22:27:40.622884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:27:40.625777 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."refined"."customers_orders__dbt_tmp" rename to "customers_orders"
22:27:40.629003 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:27:40.654175 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:27:40.656650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:27:40.659011 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
22:27:40.663322 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:27:40.680781 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
22:27:40.683027 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."refined"."customers_orders__dbt_backup" cascade
22:27:40.685906 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
22:27:40.690796 [debug] [Thread-1  ]: finished collecting timing info
22:27:40.693095 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
22:27:40.696304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb280d4-d515-493f-b94b-6a8c704edd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b48b71dc0>]}
22:27:40.699796 [info ] [Thread-1  ]: 1 of 1 OK created view model refined.customers_orders........................... [[32mCREATE VIEW[0m in 0.18s]
22:27:40.702981 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
22:27:40.711994 [debug] [MainThread]: Acquiring new postgres connection "master"
22:27:40.714906 [debug] [MainThread]: Using postgres connection "master"
22:27:40.718185 [debug] [MainThread]: On master: BEGIN
22:27:40.720814 [debug] [MainThread]: Opening a new connection, currently in state closed
22:27:40.734730 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:27:40.737564 [debug] [MainThread]: On master: COMMIT
22:27:40.739840 [debug] [MainThread]: Using postgres connection "master"
22:27:40.741949 [debug] [MainThread]: On master: COMMIT
22:27:40.744508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:27:40.746973 [debug] [MainThread]: On master: Close
22:27:40.750044 [info ] [MainThread]: 
22:27:40.753668 [info ] [MainThread]: Finished running 1 view model in 0.37s.
22:27:40.757758 [debug] [MainThread]: Connection 'master' was properly closed.
22:27:40.762368 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
22:27:40.810359 [info ] [MainThread]: 
22:27:40.816447 [info ] [MainThread]: [32mCompleted successfully[0m
22:27:40.822804 [info ] [MainThread]: 
22:27:40.831566 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:27:40.838357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b487a60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b487b01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b4879d5e0>]}


============================== 2024-07-20 19:26:41.850229 | 9b244f42-6aab-4b27-83f6-583219dbf90f ==============================
19:26:41.850229 [info ] [MainThread]: Running with dbt=1.0.0
19:26:41.851254 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
19:26:41.853286 [debug] [MainThread]: Tracking: tracking
19:26:41.859684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc50b17b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc50b17d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc50b17c10>]}
19:26:41.993032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:26:41.994476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b244f42-6aab-4b27-83f6-583219dbf90f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ffe94f0>]}
19:26:41.996598 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:26:41.998007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b244f42-6aab-4b27-83f6-583219dbf90f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ffe9790>]}
19:26:42.026787 [debug] [MainThread]: Executing "git --help"
19:26:42.052949 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:26:42.054629 [debug] [MainThread]: STDERR: "b''"
19:26:42.063896 [debug] [MainThread]: Acquiring new postgres connection "debug"
19:26:42.066965 [debug] [MainThread]: Using postgres connection "debug"
19:26:42.068393 [debug] [MainThread]: On debug: select 1 as id
19:26:42.069785 [debug] [MainThread]: Opening a new connection, currently in state init
19:26:42.077288 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:26:42.080965 [debug] [MainThread]: On debug: Close
19:26:42.083306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ff96df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ff96340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4ff96f40>]}
19:26:42.536361 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-20 19:27:38.808879 | 6e83a338-5a8a-455f-b018-b4da77e4e0db ==============================
19:27:38.808879 [info ] [MainThread]: Running with dbt=1.0.0
19:27:38.810262 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:27:38.812608 [debug] [MainThread]: Tracking: tracking
19:27:38.818792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ab809d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ab80a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34ab800a0>]}
19:27:38.885881 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:27:38.887173 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:27:38.889127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e83a338-5a8a-455f-b018-b4da77e4e0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34b408f40>]}
19:27:39.098517 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
19:27:39.101205 [debug] [MainThread]: Parsing macros/catalog.sql
19:27:39.108481 [debug] [MainThread]: Parsing macros/adapters.sql
19:27:39.154956 [debug] [MainThread]: Parsing macros/relations.sql
19:27:39.158708 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:27:39.162851 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:27:39.181811 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:27:39.201183 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:27:39.207023 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:27:39.213203 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:27:39.227911 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:27:39.232793 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:27:39.242964 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:27:39.260530 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:27:39.269864 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:27:39.275283 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:27:39.278829 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:27:39.282727 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:27:39.287597 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:27:39.295621 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:27:39.310414 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:27:39.316331 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:27:39.321219 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:27:39.324471 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:27:39.339796 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:27:39.345788 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:27:39.369656 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:27:39.373330 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:27:39.407686 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:27:39.427795 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:27:39.436992 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:27:39.471480 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:27:39.484079 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:27:39.488269 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:27:39.492306 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:27:39.501842 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:27:39.526056 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:27:39.549708 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:27:39.582385 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:27:39.586466 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:27:39.589044 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:27:39.592834 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:27:39.594956 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:27:39.597190 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:27:39.930474 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers_orders.sql
19:27:39.977473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.commerce.staging
- models.commerce.intermediate

19:27:39.988579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e83a338-5a8a-455f-b018-b4da77e4e0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a7490d0>]}
19:27:40.011017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e83a338-5a8a-455f-b018-b4da77e4e0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a794190>]}
19:27:40.012445 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:27:40.018767 [info ] [MainThread]: 
19:27:40.021397 [debug] [MainThread]: Acquiring new postgres connection "master"
19:27:40.024777 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:27:40.044310 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:27:40.045628 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:27:40.046954 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:27:40.055216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:27:40.058662 [debug] [ThreadPool]: On list_dbt_database: Close
19:27:40.061044 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_mart"
19:27:40.062697 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_mart"
19:27:40.064166 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='mart', identifier=None)"
19:27:40.074287 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_mart"
19:27:40.075514 [debug] [ThreadPool]: On create_dbt_database_mart: BEGIN
19:27:40.076678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:27:40.082378 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:27:40.083969 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_mart"
19:27:40.085047 [debug] [ThreadPool]: On create_dbt_database_mart: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_mart"} */
create schema if not exists "mart"
19:27:40.086567 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
19:27:40.088412 [debug] [ThreadPool]: On create_dbt_database_mart: COMMIT
19:27:40.089399 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_mart"
19:27:40.090287 [debug] [ThreadPool]: On create_dbt_database_mart: COMMIT
19:27:40.092477 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
19:27:40.093461 [debug] [ThreadPool]: On create_dbt_database_mart: Close
19:27:40.095847 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_mart"
19:27:40.105413 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_mart"
19:27:40.106770 [debug] [ThreadPool]: On list_dbt_database_mart: BEGIN
19:27:40.107926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:27:40.113688 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:27:40.115302 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_mart"
19:27:40.116515 [debug] [ThreadPool]: On list_dbt_database_mart: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_mart"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mart'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mart'
  
19:27:40.120669 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:27:40.123750 [debug] [ThreadPool]: On list_dbt_database_mart: ROLLBACK
19:27:40.125376 [debug] [ThreadPool]: On list_dbt_database_mart: Close
19:27:40.134399 [debug] [MainThread]: Using postgres connection "master"
19:27:40.135929 [debug] [MainThread]: On master: BEGIN
19:27:40.137236 [debug] [MainThread]: Opening a new connection, currently in state init
19:27:40.142550 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:27:40.143869 [debug] [MainThread]: Using postgres connection "master"
19:27:40.144952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:27:40.154750 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:27:40.158920 [debug] [MainThread]: On master: ROLLBACK
19:27:40.160362 [debug] [MainThread]: Using postgres connection "master"
19:27:40.161659 [debug] [MainThread]: On master: BEGIN
19:27:40.163469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:27:40.164735 [debug] [MainThread]: On master: COMMIT
19:27:40.165926 [debug] [MainThread]: Using postgres connection "master"
19:27:40.167117 [debug] [MainThread]: On master: COMMIT
19:27:40.168684 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:27:40.170391 [debug] [MainThread]: On master: Close
19:27:40.172269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:27:40.175335 [info ] [MainThread]: 
19:27:40.205945 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
19:27:40.207130 [info ] [Thread-1  ]: 1 of 1 START view model mart.customers_orders................................... [RUN]
19:27:40.208704 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
19:27:40.210450 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
19:27:40.211622 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
19:27:40.215642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
19:27:40.228963 [debug] [Thread-1  ]: finished collecting timing info
19:27:40.230620 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
19:27:40.282529 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
19:27:40.294646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:27:40.295828 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
19:27:40.296928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:27:40.302004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:27:40.303213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:27:40.304403 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."mart"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
19:27:40.307170 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:27:40.316209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:27:40.317327 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."mart"."customers_orders__dbt_tmp" rename to "customers_orders"
19:27:40.318882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:27:40.329287 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:27:40.330420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:27:40.331451 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:27:40.333782 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:27:40.340873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:27:40.341989 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."mart"."customers_orders__dbt_backup" cascade
19:27:40.343273 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:27:40.345658 [debug] [Thread-1  ]: finished collecting timing info
19:27:40.346749 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
19:27:40.348096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e83a338-5a8a-455f-b018-b4da77e4e0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a722040>]}
19:27:40.349473 [info ] [Thread-1  ]: 1 of 1 OK created view model mart.customers_orders.............................. [[32mCREATE VIEW[0m in 0.14s]
19:27:40.350760 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
19:27:40.353915 [debug] [MainThread]: Acquiring new postgres connection "master"
19:27:40.355131 [debug] [MainThread]: Using postgres connection "master"
19:27:40.356293 [debug] [MainThread]: On master: BEGIN
19:27:40.357492 [debug] [MainThread]: Opening a new connection, currently in state closed
19:27:40.362694 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:27:40.363987 [debug] [MainThread]: On master: COMMIT
19:27:40.365700 [debug] [MainThread]: Using postgres connection "master"
19:27:40.367790 [debug] [MainThread]: On master: COMMIT
19:27:40.369118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:27:40.370245 [debug] [MainThread]: On master: Close
19:27:40.371727 [info ] [MainThread]: 
19:27:40.373001 [info ] [MainThread]: Finished running 1 view model in 0.35s.
19:27:40.375001 [debug] [MainThread]: Connection 'master' was properly closed.
19:27:40.376740 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
19:27:40.395659 [info ] [MainThread]: 
19:27:40.397370 [info ] [MainThread]: [32mCompleted successfully[0m
19:27:40.402000 [info ] [MainThread]: 
19:27:40.404005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:27:40.406129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a6d7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a6d7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe34a6d7f10>]}


============================== 2024-07-20 19:29:48.889598 | 6e89e74c-cf74-4475-9ba2-dbc438bff36a ==============================
19:29:48.889598 [info ] [MainThread]: Running with dbt=1.0.0
19:29:48.890641 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
19:29:48.892685 [debug] [MainThread]: Tracking: tracking
19:29:48.897424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7879897b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7879897d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7879897c40>]}
19:29:49.032711 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:29:49.034261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e89e74c-cf74-4475-9ba2-dbc438bff36a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787930aeb0>]}
19:29:49.037158 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:29:49.038564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e89e74c-cf74-4475-9ba2-dbc438bff36a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787930a280>]}
19:29:49.070499 [debug] [MainThread]: Executing "git --help"
19:29:49.078108 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:29:49.079894 [debug] [MainThread]: STDERR: "b''"
19:29:49.081389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787930ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78792f1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78792f1490>]}


============================== 2024-07-20 19:31:29.311588 | ebce16de-b989-40c5-9d2e-ed8cb186998e ==============================
19:31:29.311588 [info ] [MainThread]: Running with dbt=1.0.0
19:31:29.312632 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
19:31:29.314318 [debug] [MainThread]: Tracking: tracking
19:31:29.319219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7256d57be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7256d57d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7256d57ca0>]}
19:31:29.446727 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:31:29.448328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebce16de-b989-40c5-9d2e-ed8cb186998e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72565394c0>]}
19:31:29.450480 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:31:29.452404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebce16de-b989-40c5-9d2e-ed8cb186998e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7256539e20>]}
19:31:29.480862 [debug] [MainThread]: Executing "git --help"
19:31:29.486358 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:31:29.488139 [debug] [MainThread]: STDERR: "b''"
19:31:29.497927 [debug] [MainThread]: Acquiring new postgres connection "debug"
19:31:29.499519 [debug] [MainThread]: Using postgres connection "debug"
19:31:29.501375 [debug] [MainThread]: On debug: select 1 as id
19:31:29.502783 [debug] [MainThread]: Opening a new connection, currently in state init
19:31:29.511071 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:31:29.515046 [debug] [MainThread]: On debug: Close
19:31:29.517880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72561d6d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72561d6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72561d6eb0>]}
19:31:29.956287 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-20 19:31:53.584200 | b90e78ed-9d22-43f4-a7b5-b5661c783ebb ==============================
19:31:53.584200 [info ] [MainThread]: Running with dbt=1.0.0
19:31:53.585722 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:31:53.587810 [debug] [MainThread]: Tracking: tracking
19:31:53.594616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a24cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a24cfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a24cf4c0>]}
19:31:53.646306 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:31:53.647872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b90e78ed-9d22-43f4-a7b5-b5661c783ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a2528df0>]}
19:31:53.739586 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
19:31:53.742079 [debug] [MainThread]: Parsing macros/catalog.sql
19:31:53.748279 [debug] [MainThread]: Parsing macros/adapters.sql
19:31:53.796114 [debug] [MainThread]: Parsing macros/relations.sql
19:31:53.799770 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:31:53.803650 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:31:53.822739 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:31:53.842520 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:31:53.848151 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:31:53.854387 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:31:53.869582 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:31:53.874750 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:31:53.883783 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:31:53.901308 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:31:53.910485 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:31:53.915877 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:31:53.919722 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:31:53.923668 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:31:53.928831 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:31:53.937012 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:31:53.952010 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:31:53.958189 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:31:53.964015 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:31:53.967512 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:31:53.982304 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:31:53.988486 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:31:54.012387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:31:54.015929 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:31:54.050488 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:31:54.070264 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:31:54.079331 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:31:54.113215 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:31:54.125900 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:31:54.130135 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:31:54.134316 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:31:54.148620 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:31:54.194287 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:31:54.254264 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:31:54.302234 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:31:54.306275 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:31:54.308911 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:31:54.312457 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:31:54.315426 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:31:54.317780 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:31:54.661508 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers_orders.sql
19:31:54.708461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.commerce.staging
- models.commerce.intermediate

19:31:54.722291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b90e78ed-9d22-43f4-a7b5-b5661c783ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b9c0d0>]}
19:31:54.744875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b90e78ed-9d22-43f4-a7b5-b5661c783ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b92130>]}
19:31:54.746984 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:31:54.750469 [info ] [MainThread]: 
19:31:54.753905 [debug] [MainThread]: Acquiring new postgres connection "master"
19:31:54.757221 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:31:54.776264 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:31:54.777720 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:31:54.778693 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:31:54.784706 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
19:31:54.787361 [debug] [ThreadPool]: On list_dbt_database: Close
19:31:54.790066 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_commerce"
19:31:54.792579 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_commerce"
19:31:54.794129 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='commerce', identifier=None)"
19:31:54.802363 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_commerce"
19:31:54.803566 [debug] [ThreadPool]: On create_dbt_database_commerce: BEGIN
19:31:54.804706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:31:54.811086 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:31:54.812285 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_commerce"
19:31:54.813278 [debug] [ThreadPool]: On create_dbt_database_commerce: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_commerce"} */
create schema if not exists "commerce"
19:31:54.814791 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
19:31:54.816699 [debug] [ThreadPool]: On create_dbt_database_commerce: COMMIT
19:31:54.817936 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_commerce"
19:31:54.818977 [debug] [ThreadPool]: On create_dbt_database_commerce: COMMIT
19:31:54.821340 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
19:31:54.822997 [debug] [ThreadPool]: On create_dbt_database_commerce: Close
19:31:54.825528 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_commerce"
19:31:54.834481 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:31:54.835661 [debug] [ThreadPool]: On list_dbt_database_commerce: BEGIN
19:31:54.836819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:31:54.842026 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:31:54.843299 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:31:54.844413 [debug] [ThreadPool]: On list_dbt_database_commerce: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_commerce"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'commerce'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'commerce'
  
19:31:54.848043 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:31:54.850407 [debug] [ThreadPool]: On list_dbt_database_commerce: ROLLBACK
19:31:54.851670 [debug] [ThreadPool]: On list_dbt_database_commerce: Close
19:31:54.859213 [debug] [MainThread]: Using postgres connection "master"
19:31:54.860444 [debug] [MainThread]: On master: BEGIN
19:31:54.861470 [debug] [MainThread]: Opening a new connection, currently in state init
19:31:54.865976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:31:54.867199 [debug] [MainThread]: Using postgres connection "master"
19:31:54.868414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:31:54.874107 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
19:31:54.876727 [debug] [MainThread]: On master: ROLLBACK
19:31:54.878144 [debug] [MainThread]: Using postgres connection "master"
19:31:54.879215 [debug] [MainThread]: On master: BEGIN
19:31:54.880708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:31:54.881876 [debug] [MainThread]: On master: COMMIT
19:31:54.882943 [debug] [MainThread]: Using postgres connection "master"
19:31:54.884027 [debug] [MainThread]: On master: COMMIT
19:31:54.885280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:31:54.886347 [debug] [MainThread]: On master: Close
19:31:54.887795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:31:54.889311 [info ] [MainThread]: 
19:31:54.912389 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
19:31:54.913885 [info ] [Thread-1  ]: 1 of 1 START view model commerce.customers_orders............................... [RUN]
19:31:54.915756 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
19:31:54.917402 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
19:31:54.918658 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
19:31:54.922009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
19:31:54.932857 [debug] [Thread-1  ]: finished collecting timing info
19:31:54.934212 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
19:31:54.978127 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
19:31:54.986642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:31:54.988158 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
19:31:54.989927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:31:54.994924 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:31:54.996105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:31:54.997224 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."commerce"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
19:31:54.999971 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:31:55.009250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:31:55.010365 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."commerce"."customers_orders__dbt_tmp" rename to "customers_orders"
19:31:55.011827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:31:55.022998 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:31:55.025049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:31:55.026529 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:31:55.030356 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:31:55.040651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:31:55.041838 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."commerce"."customers_orders__dbt_backup" cascade
19:31:55.043169 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:31:55.045530 [debug] [Thread-1  ]: finished collecting timing info
19:31:55.046734 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
19:31:55.048259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90e78ed-9d22-43f4-a7b5-b5661c783ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b25280>]}
19:31:55.049707 [info ] [Thread-1  ]: 1 of 1 OK created view model commerce.customers_orders.......................... [[32mCREATE VIEW[0m in 0.13s]
19:31:55.051107 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
19:31:55.054471 [debug] [MainThread]: Acquiring new postgres connection "master"
19:31:55.055733 [debug] [MainThread]: Using postgres connection "master"
19:31:55.056850 [debug] [MainThread]: On master: BEGIN
19:31:55.058263 [debug] [MainThread]: Opening a new connection, currently in state closed
19:31:55.062885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:31:55.064053 [debug] [MainThread]: On master: COMMIT
19:31:55.065060 [debug] [MainThread]: Using postgres connection "master"
19:31:55.065983 [debug] [MainThread]: On master: COMMIT
19:31:55.067223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:31:55.068717 [debug] [MainThread]: On master: Close
19:31:55.070495 [info ] [MainThread]: 
19:31:55.073578 [info ] [MainThread]: Finished running 1 view model in 0.32s.
19:31:55.076683 [debug] [MainThread]: Connection 'master' was properly closed.
19:31:55.078597 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
19:31:55.096338 [info ] [MainThread]: 
19:31:55.098147 [info ] [MainThread]: [32mCompleted successfully[0m
19:31:55.101011 [info ] [MainThread]: 
19:31:55.103898 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:31:55.109319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b38700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b38d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04a1b386d0>]}


============================== 2024-07-20 19:37:01.196514 | e053f23d-1dfd-4127-9dde-f0dc5cc51a1d ==============================
19:37:01.196514 [info ] [MainThread]: Running with dbt=1.0.0
19:37:01.198038 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:37:01.200406 [debug] [MainThread]: Tracking: tracking
19:37:01.206052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfbcf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfbcfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfbcf880>]}
19:37:01.372844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:37:01.373998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:37:01.376322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.commerce.staging
- models.commerce.intermediate

19:37:01.387676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e053f23d-1dfd-4127-9dde-f0dc5cc51a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfacb0d0>]}
19:37:01.408007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e053f23d-1dfd-4127-9dde-f0dc5cc51a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfb5ac70>]}
19:37:01.411875 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:37:01.415309 [info ] [MainThread]: 
19:37:01.417636 [debug] [MainThread]: Acquiring new postgres connection "master"
19:37:01.421540 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:37:01.440121 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:37:01.441229 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:37:01.443939 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:37:01.450306 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
19:37:01.453086 [debug] [ThreadPool]: On list_dbt_database: Close
19:37:01.455728 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_commerce"
19:37:01.466650 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:37:01.467934 [debug] [ThreadPool]: On list_dbt_database_commerce: BEGIN
19:37:01.468894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:37:01.473378 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:37:01.474725 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:37:01.477285 [debug] [ThreadPool]: On list_dbt_database_commerce: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_commerce"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'commerce'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'commerce'
  
19:37:01.480676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:37:01.483190 [debug] [ThreadPool]: On list_dbt_database_commerce: ROLLBACK
19:37:01.484548 [debug] [ThreadPool]: On list_dbt_database_commerce: Close
19:37:01.491192 [debug] [MainThread]: Using postgres connection "master"
19:37:01.493813 [debug] [MainThread]: On master: BEGIN
19:37:01.495057 [debug] [MainThread]: Opening a new connection, currently in state init
19:37:01.499569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:37:01.500751 [debug] [MainThread]: Using postgres connection "master"
19:37:01.501934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:37:01.509024 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:37:01.512503 [debug] [MainThread]: On master: ROLLBACK
19:37:01.513848 [debug] [MainThread]: Using postgres connection "master"
19:37:01.514994 [debug] [MainThread]: On master: BEGIN
19:37:01.516479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:37:01.517693 [debug] [MainThread]: On master: COMMIT
19:37:01.518720 [debug] [MainThread]: Using postgres connection "master"
19:37:01.519775 [debug] [MainThread]: On master: COMMIT
19:37:01.521122 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:37:01.522314 [debug] [MainThread]: On master: Close
19:37:01.523701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:37:01.525085 [info ] [MainThread]: 
19:37:01.533152 [debug] [Thread-1  ]: Began running node model.dbt_project.customers_orders
19:37:01.534412 [info ] [Thread-1  ]: 1 of 1 START view model commerce.customers_orders............................... [RUN]
19:37:01.536477 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.customers_orders"
19:37:01.538140 [debug] [Thread-1  ]: Began compiling node model.dbt_project.customers_orders
19:37:01.539450 [debug] [Thread-1  ]: Compiling model.dbt_project.customers_orders
19:37:01.543862 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.customers_orders"
19:37:01.553457 [debug] [Thread-1  ]: finished collecting timing info
19:37:01.555006 [debug] [Thread-1  ]: Began executing node model.dbt_project.customers_orders
19:37:01.597013 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.customers_orders"
19:37:01.606541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.607912 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: BEGIN
19:37:01.611069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:37:01.616083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:37:01.617522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.618877 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */

  create view "dbt_database"."commerce"."customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
19:37:01.622698 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:37:01.636418 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.638389 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."commerce"."customers_orders" rename to "customers_orders__dbt_backup"
19:37:01.640403 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:37:01.648147 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.649655 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
alter table "dbt_database"."commerce"."customers_orders__dbt_tmp" rename to "customers_orders"
19:37:01.651959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:37:01.665129 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:37:01.666417 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.667934 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: COMMIT
19:37:01.671807 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:37:01.683545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.customers_orders"
19:37:01.685683 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.customers_orders"} */
drop view if exists "dbt_database"."commerce"."customers_orders__dbt_backup" cascade
19:37:01.690011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:37:01.695080 [debug] [Thread-1  ]: finished collecting timing info
19:37:01.696426 [debug] [Thread-1  ]: On model.dbt_project.customers_orders: Close
19:37:01.698377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e053f23d-1dfd-4127-9dde-f0dc5cc51a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfa42070>]}
19:37:01.700176 [info ] [Thread-1  ]: 1 of 1 OK created view model commerce.customers_orders.......................... [[32mCREATE VIEW[0m in 0.16s]
19:37:01.701941 [debug] [Thread-1  ]: Finished running node model.dbt_project.customers_orders
19:37:01.705616 [debug] [MainThread]: Acquiring new postgres connection "master"
19:37:01.707748 [debug] [MainThread]: Using postgres connection "master"
19:37:01.710381 [debug] [MainThread]: On master: BEGIN
19:37:01.711899 [debug] [MainThread]: Opening a new connection, currently in state closed
19:37:01.718693 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:37:01.720256 [debug] [MainThread]: On master: COMMIT
19:37:01.721640 [debug] [MainThread]: Using postgres connection "master"
19:37:01.722656 [debug] [MainThread]: On master: COMMIT
19:37:01.723830 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:37:01.724860 [debug] [MainThread]: On master: Close
19:37:01.727457 [info ] [MainThread]: 
19:37:01.729124 [info ] [MainThread]: Finished running 1 view model in 0.31s.
19:37:01.731024 [debug] [MainThread]: Connection 'master' was properly closed.
19:37:01.732713 [debug] [MainThread]: Connection 'model.dbt_project.customers_orders' was properly closed.
19:37:01.749678 [info ] [MainThread]: 
19:37:01.751322 [info ] [MainThread]: [32mCompleted successfully[0m
19:37:01.753944 [info ] [MainThread]: 
19:37:01.756527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:37:01.760060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfaa2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1dfa780d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1df7dd6d0>]}


============================== 2024-07-20 19:52:31.624825 | b75dbda8-b2d3-445b-a7c2-a879bcbaa594 ==============================
19:52:31.624825 [info ] [MainThread]: Running with dbt=1.0.0
19:52:31.626718 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:52:31.628932 [debug] [MainThread]: Tracking: tracking
19:52:31.638587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0b508b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0b507c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0b50820>]}
19:52:31.703407 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
19:52:31.704940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b75dbda8-b2d3-445b-a7c2-a879bcbaa594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0b9b340>]}
19:52:31.845828 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
19:52:31.848440 [debug] [MainThread]: Parsing macros/catalog.sql
19:52:31.856157 [debug] [MainThread]: Parsing macros/adapters.sql
19:52:31.903704 [debug] [MainThread]: Parsing macros/relations.sql
19:52:31.907583 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:52:31.911947 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:52:31.931831 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:52:31.951425 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:52:31.957819 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:52:31.964382 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:52:31.979913 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:52:31.985244 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:52:31.994912 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:52:32.012895 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:52:32.022796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:52:32.028655 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:52:32.032692 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:52:32.037292 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:52:32.043002 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:52:32.051752 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:52:32.067301 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:52:32.073831 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:52:32.079725 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:52:32.083206 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:52:32.100820 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:52:32.106942 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:52:32.143696 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:52:32.147902 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:52:32.214780 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:52:32.235962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:52:32.245546 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:52:32.282450 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:52:32.296746 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:52:32.301214 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:52:32.306262 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:52:32.317716 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:52:32.343653 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:52:32.368744 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:52:32.404241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:52:32.408867 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:52:32.411639 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:52:32.415467 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:52:32.417567 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:52:32.419980 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:52:32.766765 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
19:52:32.818523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.commerce.staging
- models.commerce.intermediate

19:52:32.832276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b75dbda8-b2d3-445b-a7c2-a879bcbaa594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad07450d0>]}
19:52:32.856943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b75dbda8-b2d3-445b-a7c2-a879bcbaa594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad0794580>]}
19:52:32.858827 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:52:32.862409 [info ] [MainThread]: 
19:52:32.869965 [debug] [MainThread]: Acquiring new postgres connection "master"
19:52:32.872976 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:52:32.894588 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:52:32.895822 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:52:32.897188 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:52:32.907096 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
19:52:32.909749 [debug] [ThreadPool]: On list_dbt_database: Close
19:52:32.912020 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_commerce"
19:52:32.924058 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:52:32.925047 [debug] [ThreadPool]: On list_dbt_database_commerce: BEGIN
19:52:32.926080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:52:32.930742 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:52:32.934228 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_commerce"
19:52:32.935911 [debug] [ThreadPool]: On list_dbt_database_commerce: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_commerce"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'commerce'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'commerce'
  
19:52:32.939035 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:52:32.941586 [debug] [ThreadPool]: On list_dbt_database_commerce: ROLLBACK
19:52:32.942821 [debug] [ThreadPool]: On list_dbt_database_commerce: Close
19:52:32.952994 [debug] [MainThread]: Using postgres connection "master"
19:52:32.954091 [debug] [MainThread]: On master: BEGIN
19:52:32.955486 [debug] [MainThread]: Opening a new connection, currently in state init
19:52:32.960598 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:52:32.961789 [debug] [MainThread]: Using postgres connection "master"
19:52:32.963093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:52:32.970400 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:52:32.972968 [debug] [MainThread]: On master: ROLLBACK
19:52:32.974408 [debug] [MainThread]: Using postgres connection "master"
19:52:32.975394 [debug] [MainThread]: On master: BEGIN
19:52:32.977139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:52:32.978342 [debug] [MainThread]: On master: COMMIT
19:52:32.979267 [debug] [MainThread]: Using postgres connection "master"
19:52:32.980160 [debug] [MainThread]: On master: COMMIT
19:52:32.982055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:52:32.983090 [debug] [MainThread]: On master: Close
19:52:32.984720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:52:32.986284 [info ] [MainThread]: 
19:52:33.011632 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_customers_orders
19:52:33.012657 [info ] [Thread-1  ]: 1 of 1 START view model commerce.stg_customers_orders........................... [RUN]
19:52:33.014922 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.016669 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_customers_orders
19:52:33.018319 [debug] [Thread-1  ]: Compiling model.dbt_project.stg_customers_orders
19:52:33.022365 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_customers_orders"
19:52:33.034097 [debug] [Thread-1  ]: finished collecting timing info
19:52:33.036279 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_customers_orders
19:52:33.086431 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_project.stg_customers_orders"
19:52:33.095009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.096127 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: BEGIN
19:52:33.097571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:33.103292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:52:33.104591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.105626 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.stg_customers_orders"} */

  create view "dbt_database"."commerce"."stg_customers_orders__dbt_tmp" as (
    with view_orders_cust as  (

select ord.id,cus.first_name,ord.status
from raw.orders as ord
left join raw.customers as cus on ord.user_id = cus.id

)
select * from view_orders_cust
  );
19:52:33.108678 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:52:33.118154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.119136 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.stg_customers_orders"} */
alter table "dbt_database"."commerce"."stg_customers_orders__dbt_tmp" rename to "stg_customers_orders"
19:52:33.120709 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:52:33.131554 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: COMMIT
19:52:33.132482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.133304 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: COMMIT
19:52:33.135242 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:52:33.142334 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_customers_orders"
19:52:33.143277 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.dbt_project.stg_customers_orders"} */
drop view if exists "dbt_database"."commerce"."stg_customers_orders__dbt_backup" cascade
19:52:33.144621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:52:33.146882 [debug] [Thread-1  ]: finished collecting timing info
19:52:33.147946 [debug] [Thread-1  ]: On model.dbt_project.stg_customers_orders: Close
19:52:33.149436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75dbda8-b2d3-445b-a7c2-a879bcbaa594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad07351c0>]}
19:52:33.150732 [info ] [Thread-1  ]: 1 of 1 OK created view model commerce.stg_customers_orders...................... [[32mCREATE VIEW[0m in 0.13s]
19:52:33.152221 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_customers_orders
19:52:33.155398 [debug] [MainThread]: Acquiring new postgres connection "master"
19:52:33.156598 [debug] [MainThread]: Using postgres connection "master"
19:52:33.157923 [debug] [MainThread]: On master: BEGIN
19:52:33.158895 [debug] [MainThread]: Opening a new connection, currently in state closed
19:52:33.163782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:52:33.165239 [debug] [MainThread]: On master: COMMIT
19:52:33.166447 [debug] [MainThread]: Using postgres connection "master"
19:52:33.168041 [debug] [MainThread]: On master: COMMIT
19:52:33.169313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:52:33.170409 [debug] [MainThread]: On master: Close
19:52:33.172000 [info ] [MainThread]: 
19:52:33.175431 [info ] [MainThread]: Finished running 1 view model in 0.30s.
19:52:33.177702 [debug] [MainThread]: Connection 'master' was properly closed.
19:52:33.179351 [debug] [MainThread]: Connection 'model.dbt_project.stg_customers_orders' was properly closed.
19:52:33.200572 [info ] [MainThread]: 
19:52:33.202784 [info ] [MainThread]: [32mCompleted successfully[0m
19:52:33.205225 [info ] [MainThread]: 
19:52:33.208443 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:52:33.210543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad07e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad07e4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad077e0a0>]}


============================== 2024-07-20 20:03:01.526646 | 0caef0cb-d879-4406-8986-3bf9f3cb6a0f ==============================
20:03:01.526646 [info ] [MainThread]: Running with dbt=1.0.0
20:03:01.527604 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
20:03:01.529532 [debug] [MainThread]: Tracking: tracking
20:03:01.535076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe35296b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe35296d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe35296c10>]}
20:03:01.675950 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:03:01.677386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0caef0cb-d879-4406-8986-3bf9f3cb6a0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe34cff4f0>]}
20:03:01.679291 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:03:01.680674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0caef0cb-d879-4406-8986-3bf9f3cb6a0f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe34cff790>]}
20:03:01.714238 [debug] [MainThread]: Executing "git --help"
20:03:01.744367 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
20:03:01.747703 [debug] [MainThread]: STDERR: "b''"
20:03:01.756491 [debug] [MainThread]: Acquiring new postgres connection "debug"
20:03:01.758345 [debug] [MainThread]: Using postgres connection "debug"
20:03:01.759460 [debug] [MainThread]: On debug: select 1 as id
20:03:01.762754 [debug] [MainThread]: Opening a new connection, currently in state init
20:03:01.770740 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
20:03:01.774290 [debug] [MainThread]: On debug: Close
20:03:01.775984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe34cac100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe34caca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe34cac250>]}
20:03:02.232978 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-20 20:03:09.316045 | 52e10fbe-62b0-43a8-b627-f25839632015 ==============================
20:03:09.316045 [info ] [MainThread]: Running with dbt=1.0.0
20:03:09.317348 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:03:09.319669 [debug] [MainThread]: Tracking: tracking
20:03:09.324995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114858fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114858faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114858f580>]}
20:03:09.380169 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
20:03:09.381750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52e10fbe-62b0-43a8-b627-f25839632015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11485e8df0>]}
20:03:09.486522 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
20:03:09.489030 [debug] [MainThread]: Parsing macros/catalog.sql
20:03:09.495578 [debug] [MainThread]: Parsing macros/adapters.sql
20:03:09.542426 [debug] [MainThread]: Parsing macros/relations.sql
20:03:09.545993 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:03:09.550045 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:03:09.569153 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:03:09.588560 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:03:09.594442 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:03:09.600911 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:03:09.616384 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:03:09.621286 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:03:09.630886 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:03:09.648460 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:03:09.657714 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:03:09.663362 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:03:09.667008 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:03:09.670833 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:03:09.675895 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:03:09.683791 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:03:09.698579 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:03:09.704841 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:03:09.709619 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:03:09.712803 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:03:09.727309 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:03:09.733407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:03:09.757368 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:03:09.761022 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:03:09.796643 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:03:09.816614 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:03:09.825603 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:03:09.859808 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:03:09.872788 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:03:09.877062 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:03:09.881387 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:03:09.891081 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:03:09.915758 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:03:09.939380 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:03:09.971841 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:03:09.976059 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:03:09.978797 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:03:09.982445 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:03:09.984537 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:03:09.986851 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:03:10.323949 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
20:03:10.353334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114790bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114796d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114796d670>]}


============================== 2024-07-20 20:04:34.015963 | 849e3a40-f3ba-4457-b65f-f3be339dc258 ==============================
20:04:34.015963 [info ] [MainThread]: Running with dbt=1.0.0
20:04:34.017357 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:04:34.019484 [debug] [MainThread]: Tracking: tracking
20:04:34.026543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf740f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf740fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf740f100>]}
20:04:34.080540 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:04:34.081984 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
20:04:34.083917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '849e3a40-f3ba-4457-b65f-f3be339dc258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf7468df0>]}
20:04:34.197094 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
20:04:34.199685 [debug] [MainThread]: Parsing macros/catalog.sql
20:04:34.205586 [debug] [MainThread]: Parsing macros/adapters.sql
20:04:34.254626 [debug] [MainThread]: Parsing macros/relations.sql
20:04:34.258352 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:04:34.262413 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:04:34.281387 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:04:34.300498 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:04:34.306129 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:04:34.312249 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:04:34.327247 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:04:34.332299 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:04:34.341259 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:04:34.358873 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:04:34.368187 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:04:34.373521 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:04:34.377222 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:04:34.381102 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:04:34.386287 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:04:34.395253 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:04:34.410306 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:04:34.416437 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:04:34.421497 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:04:34.424915 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:04:34.439822 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:04:34.445839 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:04:34.469922 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:04:34.473751 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:04:34.508330 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:04:34.528134 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:04:34.537271 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:04:34.571336 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:04:34.584132 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:04:34.588555 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:04:34.593093 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:04:34.602713 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:04:34.627094 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:04:34.651014 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:04:34.683559 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:04:34.687559 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:04:34.690071 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:04:34.693431 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:04:34.695327 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:04:34.697432 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:04:35.028163 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
20:04:35.056264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf67c8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf6b2a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf67cb070>]}


============================== 2024-07-20 20:18:18.077412 | ccf41d96-7ca5-4c66-aa52-21e27b6d96d6 ==============================
20:18:18.077412 [info ] [MainThread]: Running with dbt=1.0.0
20:18:18.078445 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
20:18:18.080570 [debug] [MainThread]: Tracking: tracking
20:18:18.086746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75897b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75897d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab75897c40>]}
20:18:18.232921 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:18:18.234292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccf41d96-7ca5-4c66-aa52-21e27b6d96d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752f3af0>]}
20:18:18.236268 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
20:18:18.237574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccf41d96-7ca5-4c66-aa52-21e27b6d96d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752f3610>]}
20:18:18.269689 [debug] [MainThread]: Executing "git --help"
20:18:18.303368 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
20:18:18.305956 [debug] [MainThread]: STDERR: "b''"
20:18:18.321867 [debug] [MainThread]: Acquiring new postgres connection "debug"
20:18:18.323615 [debug] [MainThread]: Using postgres connection "debug"
20:18:18.324708 [debug] [MainThread]: On debug: select 1 as id
20:18:18.326178 [debug] [MainThread]: Opening a new connection, currently in state init
20:18:18.336226 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
20:18:18.339318 [debug] [MainThread]: On debug: Close
20:18:18.340922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752ad100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab752ad250>]}
20:18:18.810021 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-20 20:18:25.088367 | cf777897-965d-4c8c-a276-913b99c79ccb ==============================
20:18:25.088367 [info ] [MainThread]: Running with dbt=1.0.0
20:18:25.089986 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:18:25.092117 [debug] [MainThread]: Tracking: tracking
20:18:25.100208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdef27f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdef24fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdef24f370>]}
20:18:25.156717 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:18:25.158408 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
20:18:25.163523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf777897-965d-4c8c-a276-913b99c79ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdef275970>]}
20:18:25.306397 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
20:18:25.309090 [debug] [MainThread]: Parsing macros/catalog.sql
20:18:25.316651 [debug] [MainThread]: Parsing macros/adapters.sql
20:18:25.364399 [debug] [MainThread]: Parsing macros/relations.sql
20:18:25.368125 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:18:25.372344 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:18:25.391596 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:18:25.411014 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:18:25.416814 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:18:25.423462 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:18:25.440753 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:18:25.447329 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:18:25.463769 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:18:25.489993 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:18:25.508171 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:18:25.516545 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:18:25.520363 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:18:25.524068 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:18:25.529342 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:18:25.537142 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:18:25.552196 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:18:25.558120 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:18:25.563851 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:18:25.567001 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:18:25.581682 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:18:25.587585 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:18:25.611724 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:18:25.615327 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:18:25.649509 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:18:25.673109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:18:25.683125 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:18:25.717639 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:18:25.730562 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:18:25.734816 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:18:25.739195 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:18:25.748990 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:18:25.772846 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:18:25.792877 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:18:25.825842 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:18:25.829869 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:18:25.832929 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:18:25.836550 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:18:25.838581 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:18:25.841055 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:18:26.175314 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
20:18:26.204727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee909ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee975f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdee90c0d0>]}


============================== 2024-07-20 20:18:50.115183 | 321ab9e8-c78e-4bba-b540-e34539a135a5 ==============================
20:18:50.115183 [info ] [MainThread]: Running with dbt=1.0.0
20:18:50.116521 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:18:50.118673 [debug] [MainThread]: Tracking: tracking
20:18:50.125289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29637f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29634f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29634f8e0>]}
20:18:50.175002 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:18:50.176391 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
20:18:50.178470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '321ab9e8-c78e-4bba-b540-e34539a135a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2963fafd0>]}
20:18:50.303010 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
20:18:50.305672 [debug] [MainThread]: Parsing macros/catalog.sql
20:18:50.311971 [debug] [MainThread]: Parsing macros/adapters.sql
20:18:50.362091 [debug] [MainThread]: Parsing macros/relations.sql
20:18:50.365853 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:18:50.370150 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:18:50.389772 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:18:50.413127 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:18:50.420320 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:18:50.427222 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:18:50.444833 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:18:50.450370 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:18:50.460939 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:18:50.480896 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:18:50.491285 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:18:50.497268 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:18:50.501433 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:18:50.505778 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:18:50.511396 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:18:50.520974 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:18:50.538247 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:18:50.544881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:18:50.550331 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:18:50.554587 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:18:50.570211 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:18:50.576341 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:18:50.604197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:18:50.608163 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:18:50.647158 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:18:50.670770 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:18:50.680631 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:18:50.721322 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:18:50.740662 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:18:50.748976 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:18:50.758037 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:18:50.768144 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:18:50.805774 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:18:50.831805 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:18:50.866287 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:18:50.870602 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:18:50.873504 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:18:50.877160 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:18:50.879302 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:18:50.881623 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:18:51.232751 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
20:18:51.266159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295709c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa295775fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2957130a0>]}


============================== 2024-07-21 17:35:37.685585 | 994ea701-e86e-4576-a0ec-d8099e394dc0 ==============================
17:35:37.685585 [info ] [MainThread]: Running with dbt=1.0.0
17:35:37.689087 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:35:37.694208 [debug] [MainThread]: Tracking: tracking
17:35:37.719909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6b097b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6b097d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6b097c10>]}
17:35:37.935043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:35:37.937460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '994ea701-e86e-4576-a0ec-d8099e394dc0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6aad1ac0>]}
17:35:37.941240 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:35:37.943787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '994ea701-e86e-4576-a0ec-d8099e394dc0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6aad1610>]}
17:35:38.003558 [debug] [MainThread]: Executing "git --help"
17:35:38.055426 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:35:38.060064 [debug] [MainThread]: STDERR: "b''"
17:35:38.074902 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:35:38.077650 [debug] [MainThread]: Using postgres connection "debug"
17:35:38.079068 [debug] [MainThread]: On debug: select 1 as id
17:35:38.080536 [debug] [MainThread]: Opening a new connection, currently in state init
17:35:38.091170 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
17:35:38.095370 [debug] [MainThread]: On debug: Close
17:35:38.097638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6aa8b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6aa8ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a6aa8b250>]}
17:35:38.561232 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 17:43:21.350380 | 43ee3ba0-d492-4f71-a03f-85842759f148 ==============================
17:43:21.350380 [info ] [MainThread]: Running with dbt=1.0.0
17:43:21.351833 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
17:43:21.354027 [debug] [MainThread]: Tracking: tracking
17:43:21.359783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4f8fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db844c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4fe8df0>]}
17:43:21.540267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:43:21.543430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43ee3ba0-d492-4f71-a03f-85842759f148', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4fa1a00>]}
17:43:21.548985 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
17:43:21.552201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '43ee3ba0-d492-4f71-a03f-85842759f148', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4fa1a90>]}
17:43:21.700582 [debug] [MainThread]: Executing "git --help"
17:43:21.713898 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:43:21.716537 [debug] [MainThread]: STDERR: "b''"
17:43:21.727311 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:43:21.731479 [debug] [MainThread]: Using postgres connection "debug"
17:43:21.735031 [debug] [MainThread]: On debug: select 1 as id
17:43:21.737248 [debug] [MainThread]: Opening a new connection, currently in state init
17:43:21.751555 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
17:43:21.757456 [debug] [MainThread]: On debug: Close
17:43:21.762725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4782b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4fab100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4fab790>]}
17:43:22.210562 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 17:43:57.422437 | 3e033f7a-4033-493e-98ef-250ec499247c ==============================
17:43:57.422437 [info ] [MainThread]: Running with dbt=1.0.0
17:43:57.424555 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:43:57.427144 [debug] [MainThread]: Tracking: tracking
17:43:57.435279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2cf370>]}
17:43:57.531220 [info ] [MainThread]: Unable to do partial parsing because profile has changed
17:43:57.533233 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
17:43:57.538680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e033f7a-4033-493e-98ef-250ec499247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984b2f5970>]}
17:43:57.904212 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
17:43:57.917468 [debug] [MainThread]: Parsing macros/catalog.sql
17:43:57.941719 [debug] [MainThread]: Parsing macros/adapters.sql
17:43:58.117661 [debug] [MainThread]: Parsing macros/relations.sql
17:43:58.132239 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:43:58.145989 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:43:58.211036 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:43:58.271593 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:43:58.289309 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:43:58.306057 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:43:58.347341 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:43:58.364262 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:43:58.400040 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:43:58.466151 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:43:58.500492 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:43:58.520243 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:43:58.530677 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:43:58.543145 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:43:58.565910 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:43:58.616200 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:43:58.651648 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:43:58.660272 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:43:58.668174 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:43:58.674206 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:43:58.699944 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:43:58.711518 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:43:58.755334 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:43:58.761018 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:43:58.831245 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:43:58.871588 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:43:58.891288 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:43:59.008903 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:43:59.071033 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:43:59.078377 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:43:59.086782 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:43:59.123133 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:43:59.191418 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:43:59.254251 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:43:59.331093 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:43:59.340373 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:43:59.344196 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:43:59.350662 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:43:59.353179 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:43:59.356110 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:44:00.102562 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers_orders.sql
17:44:00.166282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts.core

17:44:00.183669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e033f7a-4033-493e-98ef-250ec499247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a99c0d0>]}
17:44:00.223390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e033f7a-4033-493e-98ef-250ec499247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a98d130>]}
17:44:00.225755 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:44:00.231399 [info ] [MainThread]: 
17:44:00.236507 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:00.241467 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
17:44:00.271769 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
17:44:00.273987 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
17:44:00.275662 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:44:00.289224 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
17:44:00.293226 [debug] [ThreadPool]: On list_dbt_database: Close
17:44:00.296311 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_marts"
17:44:00.298503 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_marts"
17:44:00.299789 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='marts', identifier=None)"
17:44:00.313516 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
17:44:00.315656 [debug] [ThreadPool]: On create_dbt_database_marts: BEGIN
17:44:00.317372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:44:00.324057 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:44:00.325729 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
17:44:00.327101 [debug] [ThreadPool]: On create_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_marts"} */
create schema if not exists "marts"
17:44:00.329052 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
17:44:00.332946 [debug] [ThreadPool]: On create_dbt_database_marts: COMMIT
17:44:00.335262 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
17:44:00.336604 [debug] [ThreadPool]: On create_dbt_database_marts: COMMIT
17:44:00.339932 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
17:44:00.341448 [debug] [ThreadPool]: On create_dbt_database_marts: Close
17:44:00.345714 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
17:44:00.361095 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
17:44:00.363001 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
17:44:00.364851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:44:00.373363 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:44:00.375734 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
17:44:00.377676 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
17:44:00.384014 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:44:00.390163 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
17:44:00.393027 [debug] [ThreadPool]: On list_dbt_database_marts: Close
17:44:00.410402 [debug] [MainThread]: Using postgres connection "master"
17:44:00.412857 [debug] [MainThread]: On master: BEGIN
17:44:00.414829 [debug] [MainThread]: Opening a new connection, currently in state init
17:44:00.424356 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:44:00.426577 [debug] [MainThread]: Using postgres connection "master"
17:44:00.428334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:44:00.442042 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:44:00.447236 [debug] [MainThread]: On master: ROLLBACK
17:44:00.449954 [debug] [MainThread]: Using postgres connection "master"
17:44:00.451975 [debug] [MainThread]: On master: BEGIN
17:44:00.455138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:00.457941 [debug] [MainThread]: On master: COMMIT
17:44:00.460840 [debug] [MainThread]: Using postgres connection "master"
17:44:00.463412 [debug] [MainThread]: On master: COMMIT
17:44:00.465503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:00.467672 [debug] [MainThread]: On master: Close
17:44:00.471798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:44:00.474146 [info ] [MainThread]: 
17:44:00.529793 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers_orders
17:44:00.531757 [info ] [Thread-1  ]: 1 of 1 START table model marts.stg_customers_orders............................. [RUN]
17:44:00.534724 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers_orders"
17:44:00.539820 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers_orders
17:44:00.542288 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers_orders
17:44:00.550596 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers_orders"
17:44:00.587774 [debug] [Thread-1  ]: finished collecting timing info
17:44:00.590210 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers_orders
17:44:00.701982 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers_orders"
17:44:00.750623 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers_orders"
17:44:00.754245 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: BEGIN
17:44:00.758569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:44:00.770542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:44:00.773159 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers_orders"
17:44:00.775463 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers_orders"} */


  create  table "dbt_database"."marts"."stg_customers_orders__dbt_tmp"
  as (
    
SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
17:44:00.780643 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.0 seconds
17:44:00.798964 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers_orders"
17:44:00.801693 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers_orders"} */
alter table "dbt_database"."marts"."stg_customers_orders__dbt_tmp" rename to "stg_customers_orders"
17:44:00.804253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:00.840887 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: COMMIT
17:44:00.843967 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers_orders"
17:44:00.845988 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: COMMIT
17:44:00.850263 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:44:00.869573 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers_orders"
17:44:00.871929 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers_orders"} */
drop table if exists "dbt_database"."marts"."stg_customers_orders__dbt_backup" cascade
17:44:00.874801 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:44:00.880418 [debug] [Thread-1  ]: finished collecting timing info
17:44:00.882688 [debug] [Thread-1  ]: On model.commerce.stg_customers_orders: Close
17:44:00.885805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e033f7a-4033-493e-98ef-250ec499247c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a5c8430>]}
17:44:00.888600 [info ] [Thread-1  ]: 1 of 1 OK created table model marts.stg_customers_orders........................ [[32mSELECT 99[0m in 0.35s]
17:44:00.891427 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers_orders
17:44:00.900004 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:00.902730 [debug] [MainThread]: Using postgres connection "master"
17:44:00.904833 [debug] [MainThread]: On master: BEGIN
17:44:00.906995 [debug] [MainThread]: Opening a new connection, currently in state closed
17:44:00.917850 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:44:00.920425 [debug] [MainThread]: On master: COMMIT
17:44:00.922790 [debug] [MainThread]: Using postgres connection "master"
17:44:00.925483 [debug] [MainThread]: On master: COMMIT
17:44:00.928129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:00.930420 [debug] [MainThread]: On master: Close
17:44:00.934253 [info ] [MainThread]: 
17:44:00.939026 [info ] [MainThread]: Finished running 1 table model in 0.70s.
17:44:00.945612 [debug] [MainThread]: Connection 'master' was properly closed.
17:44:00.952176 [debug] [MainThread]: Connection 'model.commerce.stg_customers_orders' was properly closed.
17:44:00.988308 [info ] [MainThread]: 
17:44:00.992000 [info ] [MainThread]: [32mCompleted successfully[0m
17:44:01.003883 [info ] [MainThread]: 
17:44:01.010834 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
17:44:01.031739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a5c8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a5c8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984a904ee0>]}


============================== 2024-07-21 18:07:24.120225 | af757926-e75c-4b3b-9488-de650c3b8450 ==============================
18:07:24.120225 [info ] [MainThread]: Running with dbt=1.0.0
18:07:24.123671 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
18:07:24.129705 [debug] [MainThread]: Tracking: tracking
18:07:24.143255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8ef8f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8ef8fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8ef8fe20>]}
18:07:24.441366 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:07:24.442993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af757926-e75c-4b3b-9488-de650c3b8450', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8ef8ff40>]}
18:07:24.445432 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:07:24.447341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af757926-e75c-4b3b-9488-de650c3b8450', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8efb5b50>]}
18:07:24.495954 [debug] [MainThread]: Executing "git --help"
18:07:24.503244 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:07:24.508289 [debug] [MainThread]: STDERR: "b''"
18:07:24.516925 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:07:24.530931 [debug] [MainThread]: Using postgres connection "debug"
18:07:24.532480 [debug] [MainThread]: On debug: select 1 as id
18:07:24.535056 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:24.546349 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:07:24.552251 [debug] [MainThread]: On debug: Close
18:07:24.555975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8efbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8efabc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8efab400>]}
18:07:25.012420 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 18:07:32.901372 | af202121-0f99-41b0-9c9e-14b2ab5794c1 ==============================
18:07:32.901372 [info ] [MainThread]: Running with dbt=1.0.0
18:07:32.903450 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:07:32.906994 [debug] [MainThread]: Tracking: tracking
18:07:32.914402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2363c0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2363c0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2363c00a0>]}
18:07:32.979549 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:07:32.981612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2363cb850>]}
18:07:33.274486 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
18:07:33.280791 [debug] [MainThread]: Parsing macros/catalog.sql
18:07:33.294947 [debug] [MainThread]: Parsing macros/adapters.sql
18:07:33.460329 [debug] [MainThread]: Parsing macros/relations.sql
18:07:33.471438 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:07:33.481762 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:07:33.543933 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:07:33.591124 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:07:33.610418 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:07:33.643766 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:07:33.698773 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:07:33.715335 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:07:33.740568 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:07:33.774103 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:07:33.790234 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:07:33.799232 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:07:33.809277 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:07:33.815074 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:07:33.821299 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:07:33.834432 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:07:33.852320 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:07:33.859361 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:07:33.864956 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:07:33.868922 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:07:33.886980 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:07:33.894210 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:07:33.923370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:07:33.928320 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:07:33.973684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:07:34.017116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:07:34.032077 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:07:34.107294 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:07:34.143146 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:07:34.153284 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:07:34.163400 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:07:34.188387 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:07:34.249079 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:07:34.309061 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:07:34.398992 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:07:34.409224 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:07:34.415617 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:07:34.424014 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:07:34.429124 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:07:34.434534 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:07:34.965473 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
18:07:34.990074 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
18:07:34.996502 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
18:07:35.062120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts.core

18:07:35.087996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235fdd0d0>]}
18:07:35.132673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235fcf130>]}
18:07:35.135166 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:07:35.143290 [info ] [MainThread]: 
18:07:35.148665 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:35.153780 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:07:35.179026 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:07:35.181509 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:07:35.183057 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:07:35.191015 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:07:35.195167 [debug] [ThreadPool]: On list_dbt_database: Close
18:07:35.198303 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:07:35.211785 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:07:35.213171 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:07:35.214328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:07:35.219352 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:07:35.220943 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:07:35.222566 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:07:35.226152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
18:07:35.228919 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:07:35.230510 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:07:35.240563 [debug] [MainThread]: Using postgres connection "master"
18:07:35.241647 [debug] [MainThread]: On master: BEGIN
18:07:35.243200 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:35.248678 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:07:35.250028 [debug] [MainThread]: Using postgres connection "master"
18:07:35.251169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:07:35.259046 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:07:35.261859 [debug] [MainThread]: On master: ROLLBACK
18:07:35.263228 [debug] [MainThread]: Using postgres connection "master"
18:07:35.264522 [debug] [MainThread]: On master: BEGIN
18:07:35.266074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:35.267542 [debug] [MainThread]: On master: COMMIT
18:07:35.268700 [debug] [MainThread]: Using postgres connection "master"
18:07:35.269870 [debug] [MainThread]: On master: COMMIT
18:07:35.271207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:35.272439 [debug] [MainThread]: On master: Close
18:07:35.273940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:07:35.275692 [info ] [MainThread]: 
18:07:35.283882 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:07:35.285935 [info ] [Thread-1  ]: 1 of 3 START view model marts.stg_customers..................................... [RUN]
18:07:35.290130 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:07:35.291616 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:07:35.293038 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:07:35.297608 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:07:35.311459 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.312829 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:07:35.377600 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:07:35.389591 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:07:35.391161 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:07:35.392571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:35.399501 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:07:35.400948 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:07:35.402626 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."marts"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:07:35.407364 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:07:35.421385 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:07:35.422758 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."marts"."stg_customers__dbt_tmp" rename to "stg_customers"
18:07:35.424565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:07:35.437277 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:07:35.438616 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:07:35.439930 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:07:35.442917 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:07:35.451722 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:07:35.453841 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."marts"."stg_customers__dbt_backup" cascade
18:07:35.455969 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:07:35.459110 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.460461 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:07:35.462259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235fb4d00>]}
18:07:35.463972 [info ] [Thread-1  ]: 1 of 3 OK created view model marts.stg_customers................................ [[32mCREATE VIEW[0m in 0.17s]
18:07:35.465573 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:07:35.468127 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:07:35.469895 [info ] [Thread-1  ]: 2 of 3 START view model marts.stg_orders........................................ [RUN]
18:07:35.472054 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:07:35.474384 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:07:35.475914 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:07:35.480270 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:07:35.496435 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.498148 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:07:35.505714 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:07:35.523839 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:07:35.525643 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:07:35.527328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:35.534287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:07:35.535857 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:07:35.539011 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."marts"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:07:35.544960 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:07:35.551001 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:07:35.552363 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."marts"."stg_orders__dbt_tmp" rename to "stg_orders"
18:07:35.554559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:07:35.557816 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:07:35.559104 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:07:35.560254 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:07:35.562949 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:07:35.566517 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:07:35.567736 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."marts"."stg_orders__dbt_backup" cascade
18:07:35.569208 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:07:35.572834 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.574114 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:07:35.575771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235f0ffd0>]}
18:07:35.577417 [info ] [Thread-1  ]: 2 of 3 OK created view model marts.stg_orders................................... [[32mCREATE VIEW[0m in 0.10s]
18:07:35.578898 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:07:35.581833 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:07:35.583680 [info ] [Thread-1  ]: 3 of 3 START table model marts.stg_customersorders.............................. [RUN]
18:07:35.586160 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:07:35.588735 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:07:35.590026 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:07:35.595882 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:07:35.606732 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.609463 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:07:35.664665 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:07:35.676944 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:07:35.678379 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:07:35.679701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:35.685907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:07:35.687710 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:07:35.689298 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */


  create  table "dbt_database"."marts"."stg_customersorders__dbt_tmp"
  as (
    select  o.id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."marts"."stg_orders" as o
left join "dbt_database"."marts"."stg_customers"  as c on o.user_id = c.id
  );
18:07:35.691811 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.user_id does not exist
LINE 11: ...n "dbt_database"."marts"."stg_customers"  as c on o.user_id ...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.order_id".

18:07:35.692994 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: ROLLBACK
18:07:35.694373 [debug] [Thread-1  ]: finished collecting timing info
18:07:35.695500 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:07:35.696945 [debug] [Thread-1  ]: Database Error in model stg_customersorders (models/staging/stg_customersorders.sql)
  column o.user_id does not exist
  LINE 11: ...n "dbt_database"."marts"."stg_customers"  as c on o.user_id ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.order_id".
  compiled SQL at target/run/commerce/models/staging/stg_customersorders.sql
18:07:35.698461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af202121-0f99-41b0-9c9e-14b2ab5794c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc236695fd0>]}
18:07:35.700015 [error] [Thread-1  ]: 3 of 3 ERROR creating table model marts.stg_customersorders..................... [[31mERROR[0m in 0.11s]
18:07:35.701413 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:07:35.705829 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:35.707337 [debug] [MainThread]: Using postgres connection "master"
18:07:35.708612 [debug] [MainThread]: On master: BEGIN
18:07:35.709931 [debug] [MainThread]: Opening a new connection, currently in state closed
18:07:35.715114 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:07:35.716293 [debug] [MainThread]: On master: COMMIT
18:07:35.717323 [debug] [MainThread]: Using postgres connection "master"
18:07:35.718357 [debug] [MainThread]: On master: COMMIT
18:07:35.719644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:35.721604 [debug] [MainThread]: On master: Close
18:07:35.723843 [info ] [MainThread]: 
18:07:35.725752 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.58s.
18:07:35.728242 [debug] [MainThread]: Connection 'master' was properly closed.
18:07:35.730468 [debug] [MainThread]: Connection 'model.commerce.stg_customersorders' was properly closed.
18:07:35.757631 [info ] [MainThread]: 
18:07:35.760292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:07:35.763428 [info ] [MainThread]: 
18:07:35.766439 [error] [MainThread]: [33mDatabase Error in model stg_customersorders (models/staging/stg_customersorders.sql)[0m
18:07:35.768993 [error] [MainThread]:   column o.user_id does not exist
18:07:35.772832 [error] [MainThread]:   LINE 11: ...n "dbt_database"."marts"."stg_customers"  as c on o.user_id ...
18:07:35.776003 [error] [MainThread]:                                                                 ^
18:07:35.778806 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "o.order_id".
18:07:35.780883 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_customersorders.sql
18:07:35.783096 [info ] [MainThread]: 
18:07:35.785988 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
18:07:35.788628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235f9a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc235f9aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc23668a760>]}


============================== 2024-07-21 18:08:54.982685 | 36cb676c-05dd-4c11-8815-d059f85cc1da ==============================
18:08:54.982685 [info ] [MainThread]: Running with dbt=1.0.0
18:08:54.984523 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:08:54.988898 [debug] [MainThread]: Tracking: tracking
18:08:54.998068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035978ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035978abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035978a0a0>]}
18:08:55.344163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:55.357522 [debug] [MainThread]: Partial parsing: updated file: commerce://models/staging/stg_customersorders.sql
18:08:55.428058 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
18:08:55.493226 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts.core

18:08:55.530548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36cb676c-05dd-4c11-8815-d059f85cc1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035964bf40>]}
18:08:55.582411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36cb676c-05dd-4c11-8815-d059f85cc1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0359719f70>]}
18:08:55.589936 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:08:55.600290 [info ] [MainThread]: 
18:08:55.609970 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:55.620706 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:08:55.665413 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:08:55.667596 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:08:55.672314 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:55.683307 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:08:55.689707 [debug] [ThreadPool]: On list_dbt_database: Close
18:08:55.697586 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:08:55.716162 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:08:55.718236 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:08:55.720363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:08:55.728304 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:55.729988 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:08:55.731543 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:08:55.738746 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
18:08:55.744533 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:08:55.747017 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:08:55.765942 [debug] [MainThread]: Using postgres connection "master"
18:08:55.768215 [debug] [MainThread]: On master: BEGIN
18:08:55.770371 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:55.781290 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:55.783928 [debug] [MainThread]: Using postgres connection "master"
18:08:55.786250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:55.803195 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:08:55.808608 [debug] [MainThread]: On master: ROLLBACK
18:08:55.811770 [debug] [MainThread]: Using postgres connection "master"
18:08:55.815175 [debug] [MainThread]: On master: BEGIN
18:08:55.820961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:55.823495 [debug] [MainThread]: On master: COMMIT
18:08:55.825627 [debug] [MainThread]: Using postgres connection "master"
18:08:55.827760 [debug] [MainThread]: On master: COMMIT
18:08:55.830043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:55.831962 [debug] [MainThread]: On master: Close
18:08:55.835213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:08:55.837642 [info ] [MainThread]: 
18:08:55.857534 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:08:55.860647 [info ] [Thread-1  ]: 1 of 3 START view model marts.stg_customers..................................... [RUN]
18:08:55.864961 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:08:55.873661 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:08:55.879534 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:08:55.887993 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:08:55.927550 [debug] [Thread-1  ]: finished collecting timing info
18:08:55.930685 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:08:56.013230 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:08:56.024214 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:08:56.025774 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:08:56.027179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:56.033019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:56.034282 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:08:56.035433 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."marts"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:08:56.038332 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:08:56.051479 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:08:56.052870 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."marts"."stg_customers__dbt_tmp" rename to "stg_customers"
18:08:56.055088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:56.069368 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:08:56.070745 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:08:56.072005 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:08:56.075484 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:08:56.124566 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:08:56.126690 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."marts"."stg_customers__dbt_backup" cascade
18:08:56.128723 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:08:56.132364 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.134463 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:08:56.136900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36cb676c-05dd-4c11-8815-d059f85cc1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0359391700>]}
18:08:56.138767 [info ] [Thread-1  ]: 1 of 3 OK created view model marts.stg_customers................................ [[32mCREATE VIEW[0m in 0.27s]
18:08:56.141057 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:08:56.143814 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:08:56.146628 [info ] [Thread-1  ]: 2 of 3 START view model marts.stg_orders........................................ [RUN]
18:08:56.149783 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:08:56.153912 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:08:56.155953 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:08:56.162085 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:08:56.182541 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.184416 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:08:56.191886 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:08:56.209633 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:08:56.211107 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:08:56.212462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:56.224847 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:56.226290 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:08:56.227589 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."marts"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:08:56.230723 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:08:56.237158 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:08:56.239562 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."marts"."stg_orders__dbt_tmp" rename to "stg_orders"
18:08:56.241408 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:56.244647 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:08:56.246265 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:08:56.247650 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:08:56.250302 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:08:56.255201 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:08:56.256551 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."marts"."stg_orders__dbt_backup" cascade
18:08:56.258224 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:08:56.262448 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.264060 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:08:56.266315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36cb676c-05dd-4c11-8815-d059f85cc1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03593fcd90>]}
18:08:56.268162 [info ] [Thread-1  ]: 2 of 3 OK created view model marts.stg_orders................................... [[32mCREATE VIEW[0m in 0.12s]
18:08:56.270301 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:08:56.274496 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:08:56.276670 [info ] [Thread-1  ]: 3 of 3 START table model marts.stg_customersorders.............................. [RUN]
18:08:56.279440 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:08:56.282420 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:08:56.283854 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:08:56.291496 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:08:56.306825 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.311426 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:08:56.377693 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:08:56.389125 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:08:56.390633 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:08:56.392347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:56.399894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:56.401582 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:08:56.403473 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */


  create  table "dbt_database"."marts"."stg_customersorders__dbt_tmp"
  as (
    select  o.id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."marts"."stg_orders" as o
left join "dbt_database"."marts"."stg_customers"  as c on o.customer_id = c.id
  );
18:08:56.406483 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.id does not exist
LINE 6:     select  o.id,
                    ^
HINT:  Perhaps you meant to reference the column "c.id".

18:08:56.407931 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: ROLLBACK
18:08:56.409509 [debug] [Thread-1  ]: finished collecting timing info
18:08:56.410920 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:08:56.412698 [debug] [Thread-1  ]: Database Error in model stg_customersorders (models/staging/stg_customersorders.sql)
  column o.id does not exist
  LINE 6:     select  o.id,
                      ^
  HINT:  Perhaps you meant to reference the column "c.id".
  compiled SQL at target/run/commerce/models/staging/stg_customersorders.sql
18:08:56.414818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36cb676c-05dd-4c11-8815-d059f85cc1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035b1aca30>]}
18:08:56.416621 [error] [Thread-1  ]: 3 of 3 ERROR creating table model marts.stg_customersorders..................... [[31mERROR[0m in 0.14s]
18:08:56.418213 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:08:56.423084 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:56.425024 [debug] [MainThread]: Using postgres connection "master"
18:08:56.426592 [debug] [MainThread]: On master: BEGIN
18:08:56.427913 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:56.436049 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:56.437362 [debug] [MainThread]: On master: COMMIT
18:08:56.438760 [debug] [MainThread]: Using postgres connection "master"
18:08:56.440202 [debug] [MainThread]: On master: COMMIT
18:08:56.442342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:56.446089 [debug] [MainThread]: On master: Close
18:08:56.450634 [info ] [MainThread]: 
18:08:56.454672 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.84s.
18:08:56.459905 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:56.462428 [debug] [MainThread]: Connection 'model.commerce.stg_customersorders' was properly closed.
18:08:56.489933 [info ] [MainThread]: 
18:08:56.492595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:08:56.497291 [info ] [MainThread]: 
18:08:56.503704 [error] [MainThread]: [33mDatabase Error in model stg_customersorders (models/staging/stg_customersorders.sql)[0m
18:08:56.508377 [error] [MainThread]:   column o.id does not exist
18:08:56.513867 [error] [MainThread]:   LINE 6:     select  o.id,
18:08:56.517278 [error] [MainThread]:                       ^
18:08:56.520899 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "c.id".
18:08:56.524800 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_customersorders.sql
18:08:56.528259 [info ] [MainThread]: 
18:08:56.530759 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
18:08:56.537176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03593ede50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03593e73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035b1ac670>]}


============================== 2024-07-21 18:09:40.641034 | a77a6825-9d60-4590-b18f-77446a2711de ==============================
18:09:40.641034 [info ] [MainThread]: Running with dbt=1.0.0
18:09:40.643070 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:09:40.649850 [debug] [MainThread]: Tracking: tracking
18:09:40.657231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c034ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c034abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c034a0a0>]}
18:09:40.976745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:09:40.978898 [debug] [MainThread]: Partial parsing: updated file: commerce://models/staging/stg_customersorders.sql
18:09:41.012427 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
18:09:41.070602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts.core

18:09:41.111561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77a6825-9d60-4590-b18f-77446a2711de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bff0bf40>]}
18:09:41.181132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77a6825-9d60-4590-b18f-77446a2711de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bffd5f70>]}
18:09:41.187754 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:09:41.206768 [info ] [MainThread]: 
18:09:41.212223 [debug] [MainThread]: Acquiring new postgres connection "master"
18:09:41.229079 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:09:41.281849 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:09:41.283621 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:09:41.284969 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:09:41.293200 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:09:41.299203 [debug] [ThreadPool]: On list_dbt_database: Close
18:09:41.302810 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:09:41.316501 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:09:41.317845 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:09:41.319108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:09:41.324652 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:09:41.326048 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:09:41.328695 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:09:41.333800 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
18:09:41.336991 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:09:41.338606 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:09:41.348801 [debug] [MainThread]: Using postgres connection "master"
18:09:41.350225 [debug] [MainThread]: On master: BEGIN
18:09:41.351450 [debug] [MainThread]: Opening a new connection, currently in state init
18:09:41.357354 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:09:41.358857 [debug] [MainThread]: Using postgres connection "master"
18:09:41.361630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:09:41.371845 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:09:41.375339 [debug] [MainThread]: On master: ROLLBACK
18:09:41.377180 [debug] [MainThread]: Using postgres connection "master"
18:09:41.378655 [debug] [MainThread]: On master: BEGIN
18:09:41.380445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:09:41.381986 [debug] [MainThread]: On master: COMMIT
18:09:41.383443 [debug] [MainThread]: Using postgres connection "master"
18:09:41.384914 [debug] [MainThread]: On master: COMMIT
18:09:41.386752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:09:41.388332 [debug] [MainThread]: On master: Close
18:09:41.390630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:09:41.392684 [info ] [MainThread]: 
18:09:41.403672 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:09:41.405836 [info ] [Thread-1  ]: 1 of 3 START view model marts.stg_customers..................................... [RUN]
18:09:41.409157 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:09:41.411741 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:09:41.414510 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:09:41.419255 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:09:41.437545 [debug] [Thread-1  ]: finished collecting timing info
18:09:41.439605 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:09:41.520839 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:09:41.540018 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:09:41.542743 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:09:41.545717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:09:41.556025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:09:41.558815 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:09:41.561318 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."marts"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:09:41.566787 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:09:41.590542 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:09:41.593415 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."marts"."stg_customers__dbt_tmp" rename to "stg_customers"
18:09:41.597689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:09:41.623496 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:09:41.626398 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:09:41.628843 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:09:41.634659 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:09:41.706248 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:09:41.708789 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."marts"."stg_customers__dbt_backup" cascade
18:09:41.711852 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:09:41.716665 [debug] [Thread-1  ]: finished collecting timing info
18:09:41.718658 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:09:41.721647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77a6825-9d60-4590-b18f-77446a2711de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bfe8c700>]}
18:09:41.723949 [info ] [Thread-1  ]: 1 of 3 OK created view model marts.stg_customers................................ [[32mCREATE VIEW[0m in 0.31s]
18:09:41.726301 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:09:41.728585 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:09:41.731089 [info ] [Thread-1  ]: 2 of 3 START view model marts.stg_orders........................................ [RUN]
18:09:41.734386 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:09:41.737086 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:09:41.738997 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:09:41.743354 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:09:41.762811 [debug] [Thread-1  ]: finished collecting timing info
18:09:41.764979 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:09:41.769795 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:09:41.787224 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:09:41.788695 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:09:41.789962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:09:41.797200 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:09:41.799018 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:09:41.800605 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."marts"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:09:41.803719 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:09:41.809271 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:09:41.811201 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."marts"."stg_orders__dbt_tmp" rename to "stg_orders"
18:09:41.814915 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:09:41.818725 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:09:41.820362 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:09:41.821953 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:09:41.825314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:09:41.831673 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:09:41.834397 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."marts"."stg_orders__dbt_backup" cascade
18:09:41.836857 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:09:41.841224 [debug] [Thread-1  ]: finished collecting timing info
18:09:41.845366 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:09:41.847729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77a6825-9d60-4590-b18f-77446a2711de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bfeebd90>]}
18:09:41.849843 [info ] [Thread-1  ]: 2 of 3 OK created view model marts.stg_orders................................... [[32mCREATE VIEW[0m in 0.11s]
18:09:41.851965 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:09:41.855895 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:09:41.858621 [info ] [Thread-1  ]: 3 of 3 START table model marts.stg_customersorders.............................. [RUN]
18:09:41.861876 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:09:41.863686 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:09:41.865117 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:09:41.873152 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:09:41.900453 [debug] [Thread-1  ]: finished collecting timing info
18:09:41.902272 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:09:41.971101 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:09:41.981500 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:09:41.983266 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:09:41.984730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:09:41.990373 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:09:41.991761 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:09:41.992881 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */


  create  table "dbt_database"."marts"."stg_customersorders__dbt_tmp"
  as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."marts"."stg_orders" as o
left join "dbt_database"."marts"."stg_customers"  as c on o.customer_id = c.id
  );
18:09:41.999582 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.01 seconds
18:09:42.003799 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:09:42.006077 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."marts"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:09:42.009025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:09:42.029507 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:09:42.031827 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:09:42.034571 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:09:42.044947 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:09:42.054956 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:09:42.057664 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop table if exists "dbt_database"."marts"."stg_customersorders__dbt_backup" cascade
18:09:42.060714 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:09:42.066755 [debug] [Thread-1  ]: finished collecting timing info
18:09:42.069370 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:09:42.072771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77a6825-9d60-4590-b18f-77446a2711de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c157e520>]}
18:09:42.076080 [info ] [Thread-1  ]: 3 of 3 OK created table model marts.stg_customersorders......................... [[32mSELECT 99[0m in 0.21s]
18:09:42.079297 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:09:42.088462 [debug] [MainThread]: Acquiring new postgres connection "master"
18:09:42.092583 [debug] [MainThread]: Using postgres connection "master"
18:09:42.095720 [debug] [MainThread]: On master: BEGIN
18:09:42.098077 [debug] [MainThread]: Opening a new connection, currently in state closed
18:09:42.109088 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:09:42.112011 [debug] [MainThread]: On master: COMMIT
18:09:42.116564 [debug] [MainThread]: Using postgres connection "master"
18:09:42.121142 [debug] [MainThread]: On master: COMMIT
18:09:42.124788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:09:42.128692 [debug] [MainThread]: On master: Close
18:09:42.137875 [info ] [MainThread]: 
18:09:42.142989 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.93s.
18:09:42.156612 [debug] [MainThread]: Connection 'master' was properly closed.
18:09:42.160058 [debug] [MainThread]: Connection 'model.commerce.stg_customersorders' was properly closed.
18:09:42.215721 [info ] [MainThread]: 
18:09:42.218247 [info ] [MainThread]: [32mCompleted successfully[0m
18:09:42.222363 [info ] [MainThread]: 
18:09:42.226945 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:09:42.233993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c034d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bfee66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c03babb0>]}


============================== 2024-07-21 18:16:52.095722 | 5121c952-927e-4bc4-8d65-5d6b2ee42710 ==============================
18:16:52.095722 [info ] [MainThread]: Running with dbt=1.0.0
18:16:52.098948 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
18:16:52.103825 [debug] [MainThread]: Tracking: tracking
18:16:52.114658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d0fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637d1f03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d68df0>]}
18:16:52.448355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:16:52.450782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5121c952-927e-4bc4-8d65-5d6b2ee42710', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d3f250>]}
18:16:52.454812 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:16:52.457701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5121c952-927e-4bc4-8d65-5d6b2ee42710', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d3fa60>]}
18:16:52.499545 [debug] [MainThread]: Executing "git --help"
18:16:52.510490 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:16:52.512671 [debug] [MainThread]: STDERR: "b''"
18:16:52.521135 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:16:52.523470 [debug] [MainThread]: Using postgres connection "debug"
18:16:52.529648 [debug] [MainThread]: On debug: select 1 as id
18:16:52.531124 [debug] [MainThread]: Opening a new connection, currently in state init
18:16:52.541395 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:16:52.545086 [debug] [MainThread]: On debug: Close
18:16:52.547188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d14610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d0f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6379d0f250>]}
18:16:53.028513 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 18:17:03.015896 | fc681c36-263a-40f5-ab28-887e1eb73b25 ==============================
18:17:03.015896 [info ] [MainThread]: Running with dbt=1.0.0
18:17:03.017683 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:17:03.020369 [debug] [MainThread]: Tracking: tracking
18:17:03.029081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fc7f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194f663d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194f663fa0>]}
18:17:03.098272 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:17:03.099982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194fc75970>]}
18:17:03.256015 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
18:17:03.259397 [debug] [MainThread]: Parsing macros/catalog.sql
18:17:03.267014 [debug] [MainThread]: Parsing macros/adapters.sql
18:17:03.344865 [debug] [MainThread]: Parsing macros/relations.sql
18:17:03.349959 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:17:03.355154 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:17:03.381404 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:17:03.408599 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:17:03.419592 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:17:03.428458 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:17:03.448650 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:17:03.455061 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:17:03.467729 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:17:03.491156 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:17:03.503549 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:17:03.512082 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:17:03.518113 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:17:03.524471 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:17:03.533055 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:17:03.546957 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:17:03.573539 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:17:03.586118 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:17:03.596630 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:17:03.603382 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:17:03.635104 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:17:03.647822 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:17:03.683074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:17:03.687542 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:17:03.751093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:17:03.801262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:17:03.823864 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:17:03.930479 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:17:03.963324 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:17:03.970615 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:17:03.976002 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:17:03.990960 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:17:04.089064 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:17:04.142143 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:17:04.183268 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:17:04.188332 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:17:04.191384 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:17:04.195564 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:17:04.197973 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:17:04.200555 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:17:04.677485 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
18:17:04.709172 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
18:17:04.718558 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
18:17:04.804295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts

18:17:04.832980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194f3190d0>]}
18:17:04.869820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194f303130>]}
18:17:04.873912 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:17:04.878698 [info ] [MainThread]: 
18:17:04.881606 [debug] [MainThread]: Acquiring new postgres connection "master"
18:17:04.886111 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:17:04.912670 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:17:04.914243 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:17:04.915853 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:17:04.928502 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:17:04.932824 [debug] [ThreadPool]: On list_dbt_database: Close
18:17:04.936073 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_staging"
18:17:04.939354 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_staging"
18:17:04.941569 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='staging', identifier=None)"
18:17:04.952088 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:17:04.954111 [debug] [ThreadPool]: On create_dbt_database_staging: BEGIN
18:17:04.956276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:17:04.962596 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:17:04.963942 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:17:04.965123 [debug] [ThreadPool]: On create_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_staging"} */
create schema if not exists "staging"
18:17:04.966853 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:17:04.969206 [debug] [ThreadPool]: On create_dbt_database_staging: COMMIT
18:17:04.970958 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:17:04.972313 [debug] [ThreadPool]: On create_dbt_database_staging: COMMIT
18:17:04.974677 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:17:04.975976 [debug] [ThreadPool]: On create_dbt_database_staging: Close
18:17:04.979850 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
18:17:04.991123 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:17:04.992763 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
18:17:04.993946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:17:04.999321 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:17:05.000770 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:17:05.002220 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
18:17:05.006614 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:17:05.009767 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
18:17:05.011598 [debug] [ThreadPool]: On list_dbt_database_staging: Close
18:17:05.020132 [debug] [MainThread]: Using postgres connection "master"
18:17:05.021445 [debug] [MainThread]: On master: BEGIN
18:17:05.022588 [debug] [MainThread]: Opening a new connection, currently in state init
18:17:05.028181 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:17:05.029579 [debug] [MainThread]: Using postgres connection "master"
18:17:05.030954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:17:05.041483 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:17:05.044604 [debug] [MainThread]: On master: ROLLBACK
18:17:05.046475 [debug] [MainThread]: Using postgres connection "master"
18:17:05.047851 [debug] [MainThread]: On master: BEGIN
18:17:05.050325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:17:05.051902 [debug] [MainThread]: On master: COMMIT
18:17:05.053182 [debug] [MainThread]: Using postgres connection "master"
18:17:05.054438 [debug] [MainThread]: On master: COMMIT
18:17:05.055941 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:17:05.057313 [debug] [MainThread]: On master: Close
18:17:05.058980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:17:05.060461 [info ] [MainThread]: 
18:17:05.069982 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:17:05.071641 [info ] [Thread-1  ]: 1 of 3 START view model staging.stg_customers................................... [RUN]
18:17:05.074783 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:17:05.076570 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:17:05.078087 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:17:05.081292 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:17:05.098345 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.099684 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:17:05.158214 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:17:05.170724 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:17:05.172463 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:17:05.173927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:17:05.180281 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:17:05.181755 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:17:05.183049 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:17:05.186056 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:17:05.197508 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:17:05.198894 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
18:17:05.200771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:17:05.213656 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:17:05.215342 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:17:05.216668 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:17:05.219966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:17:05.228676 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:17:05.230353 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
18:17:05.232027 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:17:05.234783 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.236309 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:17:05.238118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194ef83490>]}
18:17:05.239787 [info ] [Thread-1  ]: 1 of 3 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.16s]
18:17:05.241459 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:17:05.243295 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:17:05.245335 [info ] [Thread-1  ]: 2 of 3 START view model staging.stg_orders...................................... [RUN]
18:17:05.247628 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:17:05.249755 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:17:05.251409 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:17:05.256576 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:17:05.273278 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.275570 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:17:05.281806 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:17:05.295755 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:17:05.297372 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:17:05.298851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:17:05.307447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:17:05.309551 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:17:05.311224 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:17:05.313958 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:17:05.318484 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:17:05.319985 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
18:17:05.323160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:17:05.326487 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:17:05.327768 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:17:05.328932 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:17:05.331513 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:17:05.334813 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:17:05.336036 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
18:17:05.338736 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:17:05.342483 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.343777 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:17:05.345499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194eff4ca0>]}
18:17:05.347390 [info ] [Thread-1  ]: 2 of 3 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.10s]
18:17:05.349195 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:17:05.352719 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:17:05.355315 [info ] [Thread-1  ]: 3 of 3 START view model staging.stg_customersorders............................. [RUN]
18:17:05.358192 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:17:05.360447 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:17:05.361876 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:17:05.368902 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:17:05.391399 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.392904 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:17:05.399766 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:17:05.413784 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:17:05.415331 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:17:05.416996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:17:05.425524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:17:05.427277 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:17:05.428764 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
18:17:05.432366 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:17:05.438289 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:17:05.441002 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:17:05.443178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:17:05.447197 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:17:05.448511 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:17:05.449644 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:17:05.453374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:17:05.458226 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:17:05.459567 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
18:17:05.461149 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:17:05.463912 [debug] [Thread-1  ]: finished collecting timing info
18:17:05.465276 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:17:05.466956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc681c36-263a-40f5-ab28-887e1eb73b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194ef858b0>]}
18:17:05.469865 [info ] [Thread-1  ]: 3 of 3 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.11s]
18:17:05.471870 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:17:05.476009 [debug] [MainThread]: Acquiring new postgres connection "master"
18:17:05.477357 [debug] [MainThread]: Using postgres connection "master"
18:17:05.478588 [debug] [MainThread]: On master: BEGIN
18:17:05.479729 [debug] [MainThread]: Opening a new connection, currently in state closed
18:17:05.484886 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:17:05.486165 [debug] [MainThread]: On master: COMMIT
18:17:05.488205 [debug] [MainThread]: Using postgres connection "master"
18:17:05.489539 [debug] [MainThread]: On master: COMMIT
18:17:05.491727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:17:05.493099 [debug] [MainThread]: On master: Close
18:17:05.494902 [info ] [MainThread]: 
18:17:05.496566 [info ] [MainThread]: Finished running 3 view models in 0.61s.
18:17:05.498674 [debug] [MainThread]: Connection 'master' was properly closed.
18:17:05.501488 [debug] [MainThread]: Connection 'model.commerce.stg_customersorders' was properly closed.
18:17:05.526588 [info ] [MainThread]: 
18:17:05.529457 [info ] [MainThread]: [32mCompleted successfully[0m
18:17:05.533567 [info ] [MainThread]: 
18:17:05.538892 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:17:05.542865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194efe4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194efde460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194ef830a0>]}


============================== 2024-07-21 18:18:30.973267 | a5c52918-b969-4f76-b39a-8a78974c8af7 ==============================
18:18:30.973267 [info ] [MainThread]: Running with dbt=1.0.0
18:18:30.975036 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:18:30.977446 [debug] [MainThread]: Tracking: tracking
18:18:30.987081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e4fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e4f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902e4fac0>]}
18:18:31.053234 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:18:31.055525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902efaee0>]}
18:18:31.189489 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
18:18:31.193480 [debug] [MainThread]: Parsing macros/catalog.sql
18:18:31.200433 [debug] [MainThread]: Parsing macros/adapters.sql
18:18:31.395513 [debug] [MainThread]: Parsing macros/relations.sql
18:18:31.400087 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:18:31.410480 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:18:31.459953 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:18:31.486806 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:18:31.496195 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:18:31.504209 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:18:31.521619 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:18:31.527195 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:18:31.537946 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:18:31.561336 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:18:31.580718 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:18:31.591614 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:18:31.599177 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:18:31.606573 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:18:31.619520 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:18:31.635692 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:18:31.666222 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:18:31.679114 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:18:31.691026 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:18:31.699675 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:18:31.736141 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:18:31.750866 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:18:31.795132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:18:31.800601 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:18:31.850942 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:18:31.883515 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:18:31.900553 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:18:31.947338 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:18:31.968640 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:18:31.975472 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:18:31.982935 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:18:32.002905 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:18:32.053382 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:18:32.103070 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:18:32.147566 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:18:32.151994 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:18:32.155048 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:18:32.159042 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:18:32.161720 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:18:32.164401 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:18:32.802371 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
18:18:32.840831 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
18:18:32.850309 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
18:18:32.942827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.commerce.marts

18:18:32.975938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9025220d0>]}
18:18:33.017895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9024fe130>]}
18:18:33.021678 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:18:33.026344 [info ] [MainThread]: 
18:18:33.028895 [debug] [MainThread]: Acquiring new postgres connection "master"
18:18:33.033894 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:18:33.062560 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:18:33.064303 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:18:33.065776 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:18:33.074469 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
18:18:33.078436 [debug] [ThreadPool]: On list_dbt_database: Close
18:18:33.082262 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
18:18:33.096533 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:18:33.097892 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
18:18:33.098990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:18:33.106571 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:18:33.107869 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:18:33.109029 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
18:18:33.113029 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:18:33.115804 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
18:18:33.117184 [debug] [ThreadPool]: On list_dbt_database_staging: Close
18:18:33.127599 [debug] [MainThread]: Using postgres connection "master"
18:18:33.129051 [debug] [MainThread]: On master: BEGIN
18:18:33.130494 [debug] [MainThread]: Opening a new connection, currently in state init
18:18:33.136156 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:18:33.137447 [debug] [MainThread]: Using postgres connection "master"
18:18:33.138520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:18:33.148615 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:18:33.151989 [debug] [MainThread]: On master: ROLLBACK
18:18:33.153514 [debug] [MainThread]: Using postgres connection "master"
18:18:33.154690 [debug] [MainThread]: On master: BEGIN
18:18:33.156146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:18:33.157392 [debug] [MainThread]: On master: COMMIT
18:18:33.158488 [debug] [MainThread]: Using postgres connection "master"
18:18:33.159531 [debug] [MainThread]: On master: COMMIT
18:18:33.160829 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:18:33.161914 [debug] [MainThread]: On master: Close
18:18:33.163648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:18:33.165073 [info ] [MainThread]: 
18:18:33.173382 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:18:33.174734 [info ] [Thread-1  ]: 1 of 3 START view model staging.stg_customers................................... [RUN]
18:18:33.176969 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:18:33.178692 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:18:33.180036 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:18:33.184024 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:18:33.197569 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.198807 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:18:33.254660 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:18:33.263005 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:18:33.264312 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:18:33.265336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:18:33.270821 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:18:33.272081 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:18:33.273276 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:18:33.275890 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:18:33.286685 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:18:33.287993 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
18:18:33.289570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:18:33.301530 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:18:33.303538 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:18:33.304858 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:18:33.307300 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:18:33.316670 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:18:33.318538 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
18:18:33.320517 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:18:33.323779 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.325421 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:18:33.327329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9021f1e20>]}
18:18:33.329090 [info ] [Thread-1  ]: 1 of 3 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.15s]
18:18:33.331028 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:18:33.333208 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:18:33.334986 [info ] [Thread-1  ]: 2 of 3 START view model staging.stg_orders...................................... [RUN]
18:18:33.337038 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:18:33.339083 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:18:33.341198 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:18:33.346054 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:18:33.362100 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.363687 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:18:33.368640 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:18:33.384341 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:18:33.387438 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:18:33.390155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:18:33.396389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:18:33.397913 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:18:33.399323 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:18:33.403452 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:18:33.411695 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:18:33.413114 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
18:18:33.414953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:18:33.418082 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:18:33.420480 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:18:33.422458 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:18:33.425255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:18:33.429025 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:18:33.430313 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
18:18:33.431930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:18:33.435235 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.437317 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:18:33.439211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902155250>]}
18:18:33.441045 [info ] [Thread-1  ]: 2 of 3 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.10s]
18:18:33.442780 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:18:33.446177 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:18:33.448153 [info ] [Thread-1  ]: 3 of 3 START view model staging.stg_customersorders............................. [RUN]
18:18:33.451632 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:18:33.457480 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:18:33.459699 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:18:33.477442 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:18:33.497126 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.499585 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:18:33.507840 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:18:33.519862 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:18:33.522719 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:18:33.524066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:18:33.529809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:18:33.531188 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:18:33.532385 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
18:18:33.536535 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:18:33.542024 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:18:33.543747 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:18:33.545471 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:18:33.548521 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:18:33.549840 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:18:33.551056 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:18:33.554196 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:18:33.557950 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:18:33.559534 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
18:18:33.561156 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:18:33.564086 [debug] [Thread-1  ]: finished collecting timing info
18:18:33.565568 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:18:33.567619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c52918-b969-4f76-b39a-8a78974c8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc902188df0>]}
18:18:33.569726 [info ] [Thread-1  ]: 3 of 3 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.12s]
18:18:33.571415 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:18:33.575804 [debug] [MainThread]: Acquiring new postgres connection "master"
18:18:33.577133 [debug] [MainThread]: Using postgres connection "master"
18:18:33.578439 [debug] [MainThread]: On master: BEGIN
18:18:33.579695 [debug] [MainThread]: Opening a new connection, currently in state closed
18:18:33.586501 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:18:33.588144 [debug] [MainThread]: On master: COMMIT
18:18:33.589697 [debug] [MainThread]: Using postgres connection "master"
18:18:33.591075 [debug] [MainThread]: On master: COMMIT
18:18:33.592813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:18:33.594225 [debug] [MainThread]: On master: Close
18:18:33.596468 [info ] [MainThread]: 
18:18:33.600725 [info ] [MainThread]: Finished running 3 view models in 0.57s.
18:18:33.604720 [debug] [MainThread]: Connection 'master' was properly closed.
18:18:33.608276 [debug] [MainThread]: Connection 'model.commerce.stg_customersorders' was properly closed.
18:18:33.639438 [info ] [MainThread]: 
18:18:33.642333 [info ] [MainThread]: [32mCompleted successfully[0m
18:18:33.647393 [info ] [MainThread]: 
18:18:33.649820 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:18:33.659565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9021b9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9021d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9021e44c0>]}


============================== 2024-07-21 18:34:35.702424 | cce5a26e-c799-43cb-811e-375055d81a8c ==============================
18:34:35.702424 [info ] [MainThread]: Running with dbt=1.0.0
18:34:35.704689 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:34:35.707657 [debug] [MainThread]: Tracking: tracking
18:34:35.716574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7143f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe70bcab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe70bca580>]}
18:34:36.119987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
18:34:36.123758 [debug] [MainThread]: Partial parsing: added file: commerce://models/marts/customers_nb_orders.sql
18:34:36.174187 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers_nb_orders.sql
18:34:36.319582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7078e0d0>]}
18:34:36.468869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe71435970>]}
18:34:36.471543 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:34:36.477128 [info ] [MainThread]: 
18:34:36.480197 [debug] [MainThread]: Acquiring new postgres connection "master"
18:34:36.490605 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:34:36.534425 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:34:36.536075 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:34:36.538020 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:34:36.547007 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
18:34:36.553771 [debug] [ThreadPool]: On list_dbt_database: Close
18:34:36.555899 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:34:36.560671 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:34:36.561787 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:34:36.562987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:34:36.571156 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
18:34:36.574825 [debug] [ThreadPool]: On list_dbt_database: Close
18:34:36.578432 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:34:36.594387 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:34:36.596247 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:34:36.597534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:34:36.604309 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:34:36.605682 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:34:36.606922 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:34:36.610622 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
18:34:36.613669 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:34:36.615358 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:34:36.617211 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
18:34:36.620862 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:34:36.621896 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
18:34:36.623000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:34:36.628226 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:34:36.629539 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:34:36.630642 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
18:34:36.634307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:34:36.637022 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
18:34:36.638455 [debug] [ThreadPool]: On list_dbt_database_staging: Close
18:34:36.646552 [debug] [MainThread]: Using postgres connection "master"
18:34:36.648121 [debug] [MainThread]: On master: BEGIN
18:34:36.649226 [debug] [MainThread]: Opening a new connection, currently in state init
18:34:36.654297 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:34:36.655422 [debug] [MainThread]: Using postgres connection "master"
18:34:36.656654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:34:36.666268 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:34:36.668941 [debug] [MainThread]: On master: ROLLBACK
18:34:36.670214 [debug] [MainThread]: Using postgres connection "master"
18:34:36.671266 [debug] [MainThread]: On master: BEGIN
18:34:36.672556 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:34:36.673725 [debug] [MainThread]: On master: COMMIT
18:34:36.674720 [debug] [MainThread]: Using postgres connection "master"
18:34:36.675860 [debug] [MainThread]: On master: COMMIT
18:34:36.677002 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:34:36.678121 [debug] [MainThread]: On master: Close
18:34:36.679572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:34:36.682508 [info ] [MainThread]: 
18:34:36.690528 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:34:36.692016 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
18:34:36.694338 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:34:36.696786 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:34:36.698688 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:34:36.703371 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:34:36.720791 [debug] [Thread-1  ]: finished collecting timing info
18:34:36.722218 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:34:36.821884 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:34:36.837110 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:34:36.839166 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:34:36.840770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:34:36.848986 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:34:36.851107 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:34:36.853296 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:34:36.859071 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:34:36.879967 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:34:36.882289 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
18:34:36.885418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:34:36.913414 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:34:36.915946 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:34:36.918289 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:34:36.923105 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:34:36.940826 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:34:36.943603 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
18:34:36.947185 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:34:36.952744 [debug] [Thread-1  ]: finished collecting timing info
18:34:36.955376 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:34:36.958859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7140f1f0>]}
18:34:36.962462 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.27s]
18:34:36.965754 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:34:36.969379 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:34:36.973308 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
18:34:36.977886 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:34:36.983474 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:34:36.986938 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:34:36.994138 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:34:37.022680 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.025954 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:34:37.036302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:34:37.069603 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:34:37.073064 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:34:37.075612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:34:37.087925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:34:37.090379 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:34:37.092641 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:34:37.098307 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:34:37.106737 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:34:37.108822 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
18:34:37.111990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:34:37.116964 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:34:37.119041 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:34:37.120998 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:34:37.125039 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:34:37.131792 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:34:37.133896 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
18:34:37.136663 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:34:37.141217 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.143548 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:34:37.146192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe707af2e0>]}
18:34:37.149176 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.17s]
18:34:37.151897 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:34:37.159247 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:34:37.162422 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
18:34:37.166232 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:34:37.175935 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:34:37.179121 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:34:37.190346 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:34:37.224001 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.227344 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:34:37.238531 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:34:37.268854 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:34:37.272654 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:34:37.274837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:34:37.285668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:34:37.288223 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:34:37.290377 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
18:34:37.296003 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:34:37.305001 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:34:37.307303 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:34:37.310486 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:34:37.316046 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:34:37.318242 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:34:37.320522 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:34:37.324846 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:34:37.331429 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:34:37.333628 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
18:34:37.336765 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:34:37.342254 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.344508 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:34:37.347785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe7071e490>]}
18:34:37.350572 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.18s]
18:34:37.353841 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:34:37.360880 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
18:34:37.364554 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
18:34:37.368909 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
18:34:37.375292 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
18:34:37.378605 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
18:34:37.389280 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
18:34:37.439054 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.447255 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
18:34:37.549856 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
18:34:37.586159 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:34:37.588992 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
18:34:37.591578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:34:37.603893 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:34:37.606222 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:34:37.608040 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
18:34:37.619835 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
18:34:37.628084 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:34:37.630365 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
18:34:37.632987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:34:37.652567 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:34:37.654554 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:34:37.656477 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:34:37.662832 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:34:37.669847 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:34:37.672171 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
18:34:37.675053 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:34:37.680385 [debug] [Thread-1  ]: finished collecting timing info
18:34:37.682814 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
18:34:37.685960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce5a26e-c799-43cb-811e-375055d81a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe707354c0>]}
18:34:37.689857 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.32s]
18:34:37.692525 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
18:34:37.700893 [debug] [MainThread]: Acquiring new postgres connection "master"
18:34:37.703248 [debug] [MainThread]: Using postgres connection "master"
18:34:37.705809 [debug] [MainThread]: On master: BEGIN
18:34:37.708062 [debug] [MainThread]: Opening a new connection, currently in state closed
18:34:37.718788 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:34:37.722070 [debug] [MainThread]: On master: COMMIT
18:34:37.724149 [debug] [MainThread]: Using postgres connection "master"
18:34:37.726127 [debug] [MainThread]: On master: COMMIT
18:34:37.729079 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:34:37.731969 [debug] [MainThread]: On master: Close
18:34:37.735510 [info ] [MainThread]: 
18:34:37.738924 [info ] [MainThread]: Finished running 3 view models, 1 table model in 1.26s.
18:34:37.747239 [debug] [MainThread]: Connection 'master' was properly closed.
18:34:37.756795 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
18:34:37.821427 [info ] [MainThread]: 
18:34:37.830897 [info ] [MainThread]: [32mCompleted successfully[0m
18:34:37.844394 [info ] [MainThread]: 
18:34:37.855734 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:34:37.859667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe70e90430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe70701070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe70760ca0>]}


============================== 2024-07-21 18:41:21.767105 | 919488d6-5e22-4185-89d1-55b9cf1b4f27 ==============================
18:41:21.767105 [info ] [MainThread]: Running with dbt=1.0.0
18:41:21.769515 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
18:41:21.777882 [debug] [MainThread]: Tracking: tracking
18:41:21.785172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3258f56b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3258f56d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3258f56c10>]}
18:41:21.961704 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:41:21.965440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '919488d6-5e22-4185-89d1-55b9cf1b4f27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325871e190>]}
18:41:21.968747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
18:41:21.970798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '919488d6-5e22-4185-89d1-55b9cf1b4f27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325871e250>]}
18:41:22.069430 [debug] [MainThread]: Executing "git --help"
18:41:22.078277 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:41:22.082414 [debug] [MainThread]: STDERR: "b''"
18:41:22.095953 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:41:22.099866 [debug] [MainThread]: Using postgres connection "debug"
18:41:22.102451 [debug] [MainThread]: On debug: select 1 as id
18:41:22.104057 [debug] [MainThread]: Opening a new connection, currently in state init
18:41:22.114280 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:41:22.122784 [debug] [MainThread]: On debug: Close
18:41:22.126496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32583c8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32583c8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32583c8250>]}
18:41:22.556428 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 18:42:35.874859 | c38d7a10-3795-4b07-9568-95e12a6a727c ==============================
18:42:35.874859 [info ] [MainThread]: Running with dbt=1.0.0
18:42:35.876535 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:42:35.878495 [debug] [MainThread]: Tracking: tracking
18:42:35.884322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1a4fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1a4f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1a4f640>]}
18:42:36.053143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:42:36.054347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:42:36.064664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b1113f40>]}
18:42:36.082870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b146f6d0>]}
18:42:36.084486 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:42:36.088552 [info ] [MainThread]: 
18:42:36.090901 [debug] [MainThread]: Acquiring new postgres connection "master"
18:42:36.095132 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:42:36.116312 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:42:36.118789 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:42:36.119804 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:42:36.125640 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:42:36.128731 [debug] [ThreadPool]: On list_dbt_database: Close
18:42:36.130374 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:42:36.133690 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:42:36.135129 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:42:36.136715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:42:36.142776 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:42:36.145102 [debug] [ThreadPool]: On list_dbt_database: Close
18:42:36.147002 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_staging"
18:42:36.148496 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_staging"
18:42:36.149670 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='staging', identifier=None)"
18:42:36.159485 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:42:36.160610 [debug] [ThreadPool]: On create_dbt_database_staging: BEGIN
18:42:36.161566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:42:36.166048 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:42:36.167851 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:42:36.168957 [debug] [ThreadPool]: On create_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_staging"} */
create schema if not exists "staging"
18:42:36.170596 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:42:36.172751 [debug] [ThreadPool]: On create_dbt_database_staging: COMMIT
18:42:36.173986 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_staging"
18:42:36.175130 [debug] [ThreadPool]: On create_dbt_database_staging: COMMIT
18:42:36.177544 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:42:36.178731 [debug] [ThreadPool]: On create_dbt_database_staging: Close
18:42:36.180506 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_marts"
18:42:36.181930 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_database_marts"
18:42:36.183045 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt_database', schema='marts', identifier=None)"
18:42:36.186224 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
18:42:36.187374 [debug] [ThreadPool]: On create_dbt_database_marts: BEGIN
18:42:36.188624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:42:36.193286 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:42:36.194552 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
18:42:36.195685 [debug] [ThreadPool]: On create_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "create_dbt_database_marts"} */
create schema if not exists "marts"
18:42:36.197244 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:42:36.199236 [debug] [ThreadPool]: On create_dbt_database_marts: COMMIT
18:42:36.200326 [debug] [ThreadPool]: Using postgres connection "create_dbt_database_marts"
18:42:36.201278 [debug] [ThreadPool]: On create_dbt_database_marts: COMMIT
18:42:36.203677 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:42:36.204880 [debug] [ThreadPool]: On create_dbt_database_marts: Close
18:42:36.207575 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
18:42:36.217230 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:42:36.219027 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
18:42:36.220424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:42:36.225346 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:42:36.226739 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:42:36.227951 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
18:42:36.231717 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:42:36.234336 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
18:42:36.235948 [debug] [ThreadPool]: On list_dbt_database_staging: Close
18:42:36.237816 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:42:36.240854 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:42:36.242251 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:42:36.243514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:42:36.248316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:42:36.249656 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:42:36.250917 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:42:36.254338 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:42:36.256787 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:42:36.258317 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:42:36.265520 [debug] [MainThread]: Using postgres connection "master"
18:42:36.266948 [debug] [MainThread]: On master: BEGIN
18:42:36.268252 [debug] [MainThread]: Opening a new connection, currently in state init
18:42:36.273274 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:42:36.274730 [debug] [MainThread]: Using postgres connection "master"
18:42:36.276027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:42:36.282074 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
18:42:36.284782 [debug] [MainThread]: On master: ROLLBACK
18:42:36.286451 [debug] [MainThread]: Using postgres connection "master"
18:42:36.287807 [debug] [MainThread]: On master: BEGIN
18:42:36.289605 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:42:36.291023 [debug] [MainThread]: On master: COMMIT
18:42:36.292248 [debug] [MainThread]: Using postgres connection "master"
18:42:36.293473 [debug] [MainThread]: On master: COMMIT
18:42:36.294924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:42:36.296244 [debug] [MainThread]: On master: Close
18:42:36.297738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:42:36.299120 [info ] [MainThread]: 
18:42:36.326231 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:42:36.327790 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
18:42:36.329719 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:42:36.331315 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:42:36.332664 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:42:36.337012 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:42:36.349222 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.351510 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:42:36.392950 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:42:36.402658 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:42:36.404043 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:42:36.405345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:42:36.410354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:42:36.411817 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:42:36.413062 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:42:36.415858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:42:36.426313 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:42:36.427492 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
18:42:36.429002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:42:36.439740 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:42:36.440927 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:42:36.442066 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:42:36.444874 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:42:36.480641 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:42:36.482051 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
18:42:36.483727 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:42:36.486283 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.487666 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:42:36.489421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d738e0>]}
18:42:36.490849 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.16s]
18:42:36.492367 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:42:36.494288 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:42:36.495832 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
18:42:36.498063 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:42:36.500087 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:42:36.501705 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:42:36.505787 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:42:36.516717 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.518959 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:42:36.524294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:42:36.536097 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:42:36.538502 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:42:36.540565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:42:36.546211 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:42:36.547666 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:42:36.548803 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:42:36.552349 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:42:36.556714 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:42:36.557935 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
18:42:36.559635 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:42:36.562136 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:42:36.563432 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:42:36.564763 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:42:36.567562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:42:36.571025 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:42:36.572219 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
18:42:36.573693 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:42:36.576056 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.577188 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:42:36.578721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d6c2e0>]}
18:42:36.580171 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
18:42:36.581727 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:42:36.584976 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:42:36.586905 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
18:42:36.588606 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:42:36.590142 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:42:36.591554 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:42:36.596390 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:42:36.607446 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.608776 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:42:36.613368 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:42:36.625203 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:42:36.626711 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:42:36.627784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:42:36.631927 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:42:36.633085 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:42:36.634849 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
18:42:36.638772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:42:36.642592 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:42:36.643675 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:42:36.645034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:42:36.647631 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:42:36.648664 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:42:36.649695 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:42:36.653113 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:42:36.656254 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:42:36.657333 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
18:42:36.658577 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:42:36.661077 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.662198 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:42:36.663599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d72310>]}
18:42:36.665062 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
18:42:36.666396 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:42:36.669635 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
18:42:36.671083 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
18:42:36.673040 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
18:42:36.674612 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
18:42:36.676037 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
18:42:36.681453 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
18:42:36.692359 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.694788 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
18:42:36.738545 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
18:42:36.746407 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:42:36.747528 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
18:42:36.748479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:42:36.753314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:42:36.754425 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:42:36.755437 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
18:42:36.761333 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.0 seconds
18:42:36.765446 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:42:36.766492 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
18:42:36.768097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:42:36.776095 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:42:36.777207 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:42:36.778273 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:42:36.780386 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:42:36.784921 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:42:36.786033 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
18:42:36.787284 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:42:36.789578 [debug] [Thread-1  ]: finished collecting timing info
18:42:36.790623 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
18:42:36.791991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38d7a10-3795-4b07-9568-95e12a6a727c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d08a60>]}
18:42:36.793439 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
18:42:36.794794 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
18:42:36.799494 [debug] [MainThread]: Acquiring new postgres connection "master"
18:42:36.806407 [debug] [MainThread]: Using postgres connection "master"
18:42:36.809129 [debug] [MainThread]: On master: BEGIN
18:42:36.811634 [debug] [MainThread]: Opening a new connection, currently in state closed
18:42:36.819703 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:42:36.821046 [debug] [MainThread]: On master: COMMIT
18:42:36.822101 [debug] [MainThread]: Using postgres connection "master"
18:42:36.823132 [debug] [MainThread]: On master: COMMIT
18:42:36.824255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:42:36.825341 [debug] [MainThread]: On master: Close
18:42:36.826661 [info ] [MainThread]: 
18:42:36.828107 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.74s.
18:42:36.829977 [debug] [MainThread]: Connection 'master' was properly closed.
18:42:36.831627 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
18:42:36.849183 [info ] [MainThread]: 
18:42:36.852154 [info ] [MainThread]: [32mCompleted successfully[0m
18:42:36.856523 [info ] [MainThread]: 
18:42:36.859953 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:42:36.862461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d66820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d66910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0d66fd0>]}


============================== 2024-07-21 18:49:46.806972 | f8bc5aed-ee19-4618-8c5c-5279bfe18eec ==============================
18:49:46.806972 [info ] [MainThread]: Running with dbt=1.0.0
18:49:46.808403 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:49:46.810955 [debug] [MainThread]: Tracking: tracking
18:49:46.820257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eabd3f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab185d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab185fa0>]}
18:49:47.013908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:49:47.016046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:49:47.026705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab098fa0>]}
18:49:47.048384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaf267b20>]}
18:49:47.050349 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
18:49:47.054846 [info ] [MainThread]: 
18:49:47.057306 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:47.061130 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:49:47.081354 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:49:47.083590 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:49:47.085577 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:47.091701 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:49:47.094552 [debug] [ThreadPool]: On list_dbt_database: Close
18:49:47.096223 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
18:49:47.100823 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
18:49:47.102512 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
18:49:47.105871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:47.112091 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
18:49:47.116314 [debug] [ThreadPool]: On list_dbt_database: Close
18:49:47.121279 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
18:49:47.134325 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:49:47.135209 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
18:49:47.136082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:47.140319 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:49:47.141440 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
18:49:47.142332 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
18:49:47.145568 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
18:49:47.149152 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
18:49:47.150375 [debug] [ThreadPool]: On list_dbt_database_marts: Close
18:49:47.151909 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
18:49:47.155069 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:49:47.156116 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
18:49:47.157095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:47.161398 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:49:47.162532 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
18:49:47.163672 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
18:49:47.167958 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:49:47.170491 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
18:49:47.171765 [debug] [ThreadPool]: On list_dbt_database_staging: Close
18:49:47.179395 [debug] [MainThread]: Using postgres connection "master"
18:49:47.180870 [debug] [MainThread]: On master: BEGIN
18:49:47.182085 [debug] [MainThread]: Opening a new connection, currently in state init
18:49:47.186867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:47.188248 [debug] [MainThread]: Using postgres connection "master"
18:49:47.189338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:49:47.201714 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:49:47.204601 [debug] [MainThread]: On master: ROLLBACK
18:49:47.206014 [debug] [MainThread]: Using postgres connection "master"
18:49:47.207133 [debug] [MainThread]: On master: BEGIN
18:49:47.208625 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:47.209815 [debug] [MainThread]: On master: COMMIT
18:49:47.210973 [debug] [MainThread]: Using postgres connection "master"
18:49:47.212011 [debug] [MainThread]: On master: COMMIT
18:49:47.213432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:47.215077 [debug] [MainThread]: On master: Close
18:49:47.216902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:49:47.218373 [info ] [MainThread]: 
18:49:47.229240 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
18:49:47.230710 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
18:49:47.233169 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
18:49:47.235014 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
18:49:47.236367 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
18:49:47.239425 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
18:49:47.248976 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.250582 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
18:49:47.333506 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
18:49:47.345992 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.348363 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
18:49:47.351374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:47.358506 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:47.359964 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.361273 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from  raw.customers
  );
18:49:47.364873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:47.378486 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.379745 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
18:49:47.382023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.386123 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.387269 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
18:49:47.388683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.401443 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:49:47.402632 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.403824 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
18:49:47.406279 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:47.416424 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
18:49:47.417557 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
18:49:47.426497 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
18:49:47.429002 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.430174 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
18:49:47.432685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaad42ac0>]}
18:49:47.434545 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.20s]
18:49:47.435708 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
18:49:47.437654 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
18:49:47.439069 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
18:49:47.440865 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
18:49:47.442518 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
18:49:47.443733 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
18:49:47.446451 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
18:49:47.455754 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.493184 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
18:49:47.496923 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
18:49:47.507978 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.509269 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
18:49:47.510286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:47.515786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:47.517434 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.518393 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
    raw.orders
  );
18:49:47.520795 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:47.525034 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.526138 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders" rename to "stg_orders__dbt_backup"
18:49:47.527593 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.532110 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.533342 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
18:49:47.534665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.537232 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:49:47.538317 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.539293 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
18:49:47.541868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:47.544707 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
18:49:47.545760 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
18:49:47.549329 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:47.552089 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.553299 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
18:49:47.554732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab06f940>]}
18:49:47.556226 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.11s]
18:49:47.557531 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
18:49:47.560353 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
18:49:47.561802 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
18:49:47.563729 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
18:49:47.565487 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
18:49:47.567559 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
18:49:47.574144 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
18:49:47.584249 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.586401 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
18:49:47.591451 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
18:49:47.602208 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:49:47.604988 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
18:49:47.606403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:47.610803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:49:47.611958 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:49:47.613013 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
18:49:47.617505 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
18:49:47.622878 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:49:47.624024 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
18:49:47.625404 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.627703 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:49:47.628773 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:49:47.629822 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
18:49:47.634086 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:47.637112 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
18:49:47.638212 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
18:49:47.639508 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
18:49:47.641856 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.642991 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
18:49:47.644415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab05e670>]}
18:49:47.645893 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
18:49:47.647443 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
18:49:47.651081 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
18:49:47.653529 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
18:49:47.657259 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
18:49:47.658674 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
18:49:47.659814 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
18:49:47.665188 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
18:49:47.677124 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.678565 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
18:49:47.725163 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
18:49:47.737127 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.738368 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
18:49:47.739357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:47.743980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:49:47.745193 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.746207 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
18:49:47.753516 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
18:49:47.757513 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.758605 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
18:49:47.760154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.765152 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.766420 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
18:49:47.767755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:49:47.776483 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:49:47.777630 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.778677 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
18:49:47.781412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:49:47.785945 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
18:49:47.787106 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
18:49:47.790344 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:49:47.792877 [debug] [Thread-1  ]: finished collecting timing info
18:49:47.794037 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
18:49:47.795808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8bc5aed-ee19-4618-8c5c-5279bfe18eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab061d00>]}
18:49:47.797895 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.14s]
18:49:47.799677 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
18:49:47.803030 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:47.804332 [debug] [MainThread]: Using postgres connection "master"
18:49:47.805319 [debug] [MainThread]: On master: BEGIN
18:49:47.806343 [debug] [MainThread]: Opening a new connection, currently in state closed
18:49:47.811213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:47.814110 [debug] [MainThread]: On master: COMMIT
18:49:47.816393 [debug] [MainThread]: Using postgres connection "master"
18:49:47.821357 [debug] [MainThread]: On master: COMMIT
18:49:47.825078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:47.828639 [debug] [MainThread]: On master: Close
18:49:47.855728 [info ] [MainThread]: 
18:49:47.861872 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.80s.
18:49:47.865679 [debug] [MainThread]: Connection 'master' was properly closed.
18:49:47.868993 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
18:49:47.893706 [info ] [MainThread]: 
18:49:47.895597 [info ] [MainThread]: [32mCompleted successfully[0m
18:49:47.898287 [info ] [MainThread]: 
18:49:47.907240 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:49:47.910765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab077460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eab077430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ead219a60>]}


============================== 2024-07-21 19:11:07.700186 | 044690d6-9370-464c-b040-1e527e2fbb91 ==============================
19:11:07.700186 [info ] [MainThread]: Running with dbt=1.0.0
19:11:07.701429 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
19:11:07.703648 [debug] [MainThread]: Tracking: tracking
19:11:07.710757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1019f0fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101d3f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1019f0f850>]}
19:11:07.859118 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:11:07.860796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '044690d6-9370-464c-b040-1e527e2fbb91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1019f6ff10>]}
19:11:07.862688 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:11:07.864356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '044690d6-9370-464c-b040-1e527e2fbb91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1019937040>]}
19:11:07.894602 [debug] [MainThread]: Executing "git --help"
19:11:07.927572 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:11:07.929313 [debug] [MainThread]: STDERR: "b''"
19:11:07.936581 [debug] [MainThread]: Acquiring new postgres connection "debug"
19:11:07.938386 [debug] [MainThread]: Using postgres connection "debug"
19:11:07.939577 [debug] [MainThread]: On debug: select 1 as id
19:11:07.942803 [debug] [MainThread]: Opening a new connection, currently in state init
19:11:07.951846 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:11:07.954654 [debug] [MainThread]: On debug: Close
19:11:07.957110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101993d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101993d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f101993d4f0>]}
19:11:08.424595 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 19:11:14.301069 | 23a82d8a-e264-456c-a57b-0df55f1b313d ==============================
19:11:14.301069 [info ] [MainThread]: Running with dbt=1.0.0
19:11:14.302479 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:11:14.304466 [debug] [MainThread]: Tracking: tracking
19:11:14.312828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093bb8b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093bb8b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093bb8b1c0>]}
19:11:14.480139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093c7beee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093badfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093badfe20>]}


============================== 2024-07-21 19:16:19.933074 | 8f3b3e2d-c94b-48ef-867b-e6156aa22709 ==============================
19:16:19.933074 [info ] [MainThread]: Running with dbt=1.0.0
19:16:19.934714 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:16:19.936826 [debug] [MainThread]: Tracking: tracking
19:16:19.943112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba9be580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba14ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba14ac70>]}
19:16:20.151977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
19:16:20.153624 [debug] [MainThread]: Partial parsing: added file: commerce://models/staging/src_commerce.yml
19:16:20.154949 [debug] [MainThread]: Partial parsing: updated file: commerce://models/staging/stg_orders.sql
19:16:20.156243 [debug] [MainThread]: Partial parsing: updated file: commerce://models/staging/stg_customers.sql
19:16:20.179130 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
19:16:20.197037 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
19:16:20.244589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66b9cc8f70>]}
19:16:20.263217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba140700>]}
19:16:20.264955 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:16:20.269652 [info ] [MainThread]: 
19:16:20.272210 [debug] [MainThread]: Acquiring new postgres connection "master"
19:16:20.283067 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:16:20.304049 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:16:20.305513 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:16:20.307159 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:16:20.314985 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:16:20.317745 [debug] [ThreadPool]: On list_dbt_database: Close
19:16:20.319791 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:16:20.323861 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:16:20.325531 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:16:20.326601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:16:20.332394 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:16:20.335071 [debug] [ThreadPool]: On list_dbt_database: Close
19:16:20.338053 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:16:20.348842 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:16:20.350066 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:16:20.351226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:16:20.356033 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:16:20.357164 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:16:20.358244 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:16:20.361515 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:16:20.364015 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:16:20.365460 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:16:20.367289 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:16:20.370301 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:16:20.400095 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:16:20.401104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:16:20.405624 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:16:20.406837 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:16:20.407903 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:16:20.411296 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:16:20.413731 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:16:20.415040 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:16:20.422019 [debug] [MainThread]: Using postgres connection "master"
19:16:20.423228 [debug] [MainThread]: On master: BEGIN
19:16:20.424397 [debug] [MainThread]: Opening a new connection, currently in state init
19:16:20.428741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:16:20.430015 [debug] [MainThread]: Using postgres connection "master"
19:16:20.431072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:16:20.437535 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:16:20.440143 [debug] [MainThread]: On master: ROLLBACK
19:16:20.441714 [debug] [MainThread]: Using postgres connection "master"
19:16:20.442795 [debug] [MainThread]: On master: BEGIN
19:16:20.444276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:16:20.445602 [debug] [MainThread]: On master: COMMIT
19:16:20.446819 [debug] [MainThread]: Using postgres connection "master"
19:16:20.447860 [debug] [MainThread]: On master: COMMIT
19:16:20.449102 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:16:20.450287 [debug] [MainThread]: On master: Close
19:16:20.451625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:16:20.453120 [info ] [MainThread]: 
19:16:20.460875 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:16:20.462263 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:16:20.464063 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:16:20.465785 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:16:20.467122 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:16:20.473942 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:16:20.483593 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.485075 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:16:20.561364 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:16:20.570430 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:16:20.572489 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:16:20.573999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:16:20.580311 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:16:20.582520 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:16:20.583714 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:16:20.586057 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:16:20.595262 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:16:20.596355 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:16:20.597712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:16:20.608652 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:16:20.609920 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:16:20.610914 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:16:20.613507 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:16:20.620794 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:16:20.621858 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:16:20.623096 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:16:20.625320 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.626353 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:16:20.627750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66b9cf8700>]}
19:16:20.629384 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.16s]
19:16:20.631227 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:16:20.632998 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:16:20.634424 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:16:20.636151 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:16:20.637714 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:16:20.638705 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:16:20.642882 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:16:20.653510 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.655199 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:16:20.661225 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:16:20.669936 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:16:20.671265 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:16:20.673159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:16:20.680184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:16:20.681557 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:16:20.682908 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:16:20.685869 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:16:20.690474 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:16:20.692256 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:16:20.693661 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:16:20.695949 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:16:20.696975 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:16:20.697956 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:16:20.700146 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:16:20.703106 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:16:20.704138 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:16:20.705596 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:16:20.708171 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.709345 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:16:20.710754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba1bf490>]}
19:16:20.712278 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.07s]
19:16:20.713519 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:16:20.715987 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:16:20.717376 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:16:20.719128 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:16:20.721246 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:16:20.722895 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:16:20.730888 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:16:20.739048 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.741490 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:16:20.745487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:16:20.753516 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:16:20.754891 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:16:20.756798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:16:20.762596 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:16:20.763697 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:16:20.764646 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:16:20.767049 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:16:20.770825 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:16:20.772336 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:16:20.775794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:16:20.778095 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:16:20.779097 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:16:20.780164 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:16:20.782634 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:16:20.785771 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:16:20.786810 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:16:20.788056 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:16:20.791830 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.792819 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:16:20.794226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66b9d64190>]}
19:16:20.795750 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
19:16:20.796998 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:16:20.799502 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:16:20.800944 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:16:20.802809 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:16:20.804492 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:16:20.806334 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:16:20.812262 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:16:20.820414 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.821755 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:16:20.864608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:16:20.872867 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.874283 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:16:20.875549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:16:20.880101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:16:20.881232 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.882227 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:16:20.890953 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
19:16:20.902029 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.903367 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:16:20.905293 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:16:20.910752 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.912027 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:16:20.913507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:16:20.922256 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:16:20.923309 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.924588 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:16:20.926782 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:16:20.929644 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:16:20.930697 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:16:20.933802 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:16:20.936075 [debug] [Thread-1  ]: finished collecting timing info
19:16:20.937119 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:16:20.938538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3b3e2d-c94b-48ef-867b-e6156aa22709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66b9d09e50>]}
19:16:20.940145 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.14s]
19:16:20.941602 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:16:20.945145 [debug] [MainThread]: Acquiring new postgres connection "master"
19:16:20.946374 [debug] [MainThread]: Using postgres connection "master"
19:16:20.947490 [debug] [MainThread]: On master: BEGIN
19:16:20.948449 [debug] [MainThread]: Opening a new connection, currently in state closed
19:16:20.953015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:16:20.954057 [debug] [MainThread]: On master: COMMIT
19:16:20.954975 [debug] [MainThread]: Using postgres connection "master"
19:16:20.956378 [debug] [MainThread]: On master: COMMIT
19:16:20.957782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:16:20.959094 [debug] [MainThread]: On master: Close
19:16:20.961423 [info ] [MainThread]: 
19:16:20.962841 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.69s.
19:16:20.964777 [debug] [MainThread]: Connection 'master' was properly closed.
19:16:20.966095 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:16:20.984309 [info ] [MainThread]: 
19:16:20.985902 [info ] [MainThread]: [32mCompleted successfully[0m
19:16:20.988521 [info ] [MainThread]: 
19:16:20.996225 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:16:20.998558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba1bf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba1bf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ba1bd340>]}


============================== 2024-07-21 19:21:04.830486 | 0106c8b1-ee75-47e2-a8d2-ab620bd42460 ==============================
19:21:04.830486 [info ] [MainThread]: Running with dbt=1.0.0
19:21:04.831682 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
19:21:04.833588 [debug] [MainThread]: Tracking: tracking
19:21:04.838466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd7848d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddacfd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd78a8df0>]}
19:21:04.978732 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:21:04.980448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0106c8b1-ee75-47e2-a8d2-ab620bd42460', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd7878250>]}
19:21:04.982413 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
19:21:04.983760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0106c8b1-ee75-47e2-a8d2-ab620bd42460', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd7878a60>]}
19:21:05.012562 [debug] [MainThread]: Executing "git --help"
19:21:05.020654 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:21:05.022271 [debug] [MainThread]: STDERR: "b''"
19:21:05.030595 [debug] [MainThread]: Acquiring new postgres connection "debug"
19:21:05.033492 [debug] [MainThread]: Using postgres connection "debug"
19:21:05.035575 [debug] [MainThread]: On debug: select 1 as id
19:21:05.036797 [debug] [MainThread]: Opening a new connection, currently in state init
19:21:05.044766 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
19:21:05.049502 [debug] [MainThread]: On debug: Close
19:21:05.051255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd784ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd78482e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddd78481c0>]}
19:21:05.491491 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-07-21 19:21:12.469672 | f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f ==============================
19:21:12.469672 [info ] [MainThread]: Running with dbt=1.0.0
19:21:12.471397 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:21:12.473956 [debug] [MainThread]: Tracking: tracking
19:21:12.481200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d996fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d996310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d996dc0>]}
19:21:12.700361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:21:12.701455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:21:12.712336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d89c0d0>]}
19:21:12.731475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d8ef190>]}
19:21:12.733113 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:21:12.737749 [info ] [MainThread]: 
19:21:12.741152 [debug] [MainThread]: Acquiring new postgres connection "master"
19:21:12.745197 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:21:12.763369 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:21:12.764519 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:21:12.765713 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:21:12.772072 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:21:12.775085 [debug] [ThreadPool]: On list_dbt_database: Close
19:21:12.777856 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:21:12.782684 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:21:12.783809 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:21:12.784866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:21:12.789912 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:21:12.793000 [debug] [ThreadPool]: On list_dbt_database: Close
19:21:12.797425 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:21:12.806382 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:21:12.807615 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:21:12.808808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:21:12.814391 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:21:12.815448 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:21:12.816499 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:21:12.819744 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:21:12.822245 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:21:12.823486 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:21:12.825525 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:21:12.828695 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:21:12.829783 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:21:12.830832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:21:12.835473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:21:12.836683 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:21:12.837921 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:21:12.841098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:21:12.843666 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:21:12.845133 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:21:12.853099 [debug] [MainThread]: Using postgres connection "master"
19:21:12.854319 [debug] [MainThread]: On master: BEGIN
19:21:12.855548 [debug] [MainThread]: Opening a new connection, currently in state init
19:21:12.860616 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:21:12.861818 [debug] [MainThread]: Using postgres connection "master"
19:21:12.862796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:21:12.869818 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:21:12.872233 [debug] [MainThread]: On master: ROLLBACK
19:21:12.873637 [debug] [MainThread]: Using postgres connection "master"
19:21:12.874676 [debug] [MainThread]: On master: BEGIN
19:21:12.876357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:21:12.877569 [debug] [MainThread]: On master: COMMIT
19:21:12.878658 [debug] [MainThread]: Using postgres connection "master"
19:21:12.879651 [debug] [MainThread]: On master: COMMIT
19:21:12.880834 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:21:12.881857 [debug] [MainThread]: On master: Close
19:21:12.883339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:21:12.885133 [info ] [MainThread]: 
19:21:12.891253 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:21:12.892932 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:21:12.894792 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:21:12.896433 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:21:12.897685 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:21:12.902600 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:21:12.913659 [debug] [Thread-1  ]: finished collecting timing info
19:21:12.915607 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:21:12.956505 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:21:12.966899 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:21:12.968301 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:21:12.969513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:12.974152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:21:12.975573 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:21:12.977034 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:21:12.979620 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:21:12.988626 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:21:12.989815 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:21:12.991367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:21:13.002184 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:21:13.003436 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:21:13.004571 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:21:13.007605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:21:13.015550 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:21:13.016813 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:21:13.018466 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:21:13.020995 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.022330 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:21:13.024083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d5fa9a0>]}
19:21:13.026266 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
19:21:13.027754 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:21:13.029315 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:21:13.030869 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:21:13.032623 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:21:13.034345 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:21:13.035613 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:21:13.041433 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:21:13.054448 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.056077 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:21:13.095566 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:21:13.104344 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:21:13.105779 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:21:13.106873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:13.112323 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:21:13.113638 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:21:13.114755 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:21:13.117257 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:21:13.121304 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:21:13.122634 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:21:13.124458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:21:13.127592 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:21:13.129157 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:21:13.130690 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:21:13.134032 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:21:13.137331 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:21:13.138678 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:21:13.140337 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:21:13.142991 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.144329 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:21:13.146269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d9cdeb0>]}
19:21:13.147825 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.11s]
19:21:13.149585 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:21:13.152380 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:21:13.153838 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:21:13.155883 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:21:13.157834 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:21:13.159222 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:21:13.166306 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:21:13.177410 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.179582 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:21:13.183701 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:21:13.194124 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:21:13.196711 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:21:13.198909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:13.203829 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:21:13.205115 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:21:13.206435 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:21:13.210161 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:21:13.215016 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:21:13.216229 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:21:13.217853 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:21:13.220424 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:21:13.221632 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:21:13.222656 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:21:13.225233 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:21:13.228885 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:21:13.230058 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:21:13.231465 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:21:13.234004 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.235289 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:21:13.236927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d862340>]}
19:21:13.238604 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
19:21:13.240105 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:21:13.242890 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:21:13.244947 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:21:13.246957 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:21:13.248409 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:21:13.249509 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:21:13.253583 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:21:13.265001 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.266351 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:21:13.305663 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:21:13.316442 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.317726 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:21:13.319028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:21:13.323701 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:21:13.324839 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.326361 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:21:13.333022 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
19:21:13.336932 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.337988 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:21:13.339378 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:21:13.343288 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.344296 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:21:13.345759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:21:13.353825 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:21:13.354971 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.355890 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:21:13.358443 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:21:13.361826 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:21:13.362957 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:21:13.366204 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:21:13.368513 [debug] [Thread-1  ]: finished collecting timing info
19:21:13.369584 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:21:13.371115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7b58dd7-7dd0-456c-a8f5-c507d64fcf7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d85ef70>]}
19:21:13.372679 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
19:21:13.374156 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:21:13.377961 [debug] [MainThread]: Acquiring new postgres connection "master"
19:21:13.379144 [debug] [MainThread]: Using postgres connection "master"
19:21:13.380392 [debug] [MainThread]: On master: BEGIN
19:21:13.381519 [debug] [MainThread]: Opening a new connection, currently in state closed
19:21:13.387066 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:21:13.388188 [debug] [MainThread]: On master: COMMIT
19:21:13.389328 [debug] [MainThread]: Using postgres connection "master"
19:21:13.390465 [debug] [MainThread]: On master: COMMIT
19:21:13.392271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:21:13.393660 [debug] [MainThread]: On master: Close
19:21:13.395706 [info ] [MainThread]: 
19:21:13.398307 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.66s.
19:21:13.400043 [debug] [MainThread]: Connection 'master' was properly closed.
19:21:13.401968 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:21:13.422934 [info ] [MainThread]: 
19:21:13.424451 [info ] [MainThread]: [32mCompleted successfully[0m
19:21:13.431512 [info ] [MainThread]: 
19:21:13.434707 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:21:13.437496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d5c3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d5c32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367fa0e940>]}


============================== 2024-07-21 19:38:42.756208 | da2f91d1-9438-4592-b9e3-a6e3f23c2c63 ==============================
19:38:42.756208 [info ] [MainThread]: Running with dbt=1.0.0
19:38:42.758031 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
19:38:42.760195 [debug] [MainThread]: Tracking: tracking
19:38:42.768935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a02a58730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a02a58340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a02a58970>]}
19:38:43.007906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:38:43.009694 [debug] [MainThread]: Partial parsing: added file: commerce://tests/customers_nb_orders_check.sql
19:38:43.065445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2f91d1-9438-4592-b9e3-a6e3f23c2c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a023e30d0>]}
19:38:43.086117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2f91d1-9438-4592-b9e3-a6e3f23c2c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0279de80>]}
19:38:43.087865 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:38:43.092319 [info ] [MainThread]: 
19:38:43.094918 [debug] [MainThread]: Acquiring new postgres connection "master"
19:38:43.100750 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:38:43.119573 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:38:43.120839 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:38:43.122050 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:38:43.128010 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:38:43.130164 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:38:43.132189 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:38:43.136245 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:38:43.139134 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:38:43.140507 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:38:43.142213 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:38:43.145466 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:38:43.147484 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:38:43.149200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:38:43.154671 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:38:43.155872 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:38:43.156937 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:38:43.160103 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:38:43.163575 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:38:43.165387 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:38:43.173151 [debug] [MainThread]: Using postgres connection "master"
19:38:43.174471 [debug] [MainThread]: On master: BEGIN
19:38:43.175545 [debug] [MainThread]: Opening a new connection, currently in state init
19:38:43.181029 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:38:43.182172 [debug] [MainThread]: Using postgres connection "master"
19:38:43.183255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:38:43.189968 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:38:43.192661 [debug] [MainThread]: On master: ROLLBACK
19:38:43.194136 [debug] [MainThread]: Using postgres connection "master"
19:38:43.195518 [debug] [MainThread]: On master: BEGIN
19:38:43.197274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:38:43.198429 [debug] [MainThread]: On master: COMMIT
19:38:43.199414 [debug] [MainThread]: Using postgres connection "master"
19:38:43.200290 [debug] [MainThread]: On master: COMMIT
19:38:43.201584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:38:43.202730 [debug] [MainThread]: On master: Close
19:38:43.204276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:38:43.205633 [info ] [MainThread]: 
19:38:43.214112 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
19:38:43.215202 [info ] [Thread-1  ]: 1 of 1 START test customers_nb_orders_check..................................... [RUN]
19:38:43.216900 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
19:38:43.218349 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
19:38:43.219599 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
19:38:43.223987 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
19:38:43.237810 [debug] [Thread-1  ]: finished collecting timing info
19:38:43.239417 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
19:38:43.303836 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
19:38:43.316832 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:38:43.318233 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
19:38:43.319463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:38:43.325113 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:38:43.326510 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:38:43.327721 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
19:38:43.330197 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
19:38:43.333759 [debug] [Thread-1  ]: finished collecting timing info
19:38:43.335215 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
19:38:43.336525 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
19:38:43.338022 [info ] [Thread-1  ]: 1 of 1 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.12s]
19:38:43.339700 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
19:38:43.343396 [debug] [MainThread]: Acquiring new postgres connection "master"
19:38:43.344787 [debug] [MainThread]: Using postgres connection "master"
19:38:43.346313 [debug] [MainThread]: On master: BEGIN
19:38:43.347426 [debug] [MainThread]: Opening a new connection, currently in state closed
19:38:43.351984 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:38:43.353261 [debug] [MainThread]: On master: COMMIT
19:38:43.354348 [debug] [MainThread]: Using postgres connection "master"
19:38:43.355994 [debug] [MainThread]: On master: COMMIT
19:38:43.357525 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:38:43.358638 [debug] [MainThread]: On master: Close
19:38:43.360131 [info ] [MainThread]: 
19:38:43.361668 [info ] [MainThread]: Finished running 1 test in 0.27s.
19:38:43.364486 [debug] [MainThread]: Connection 'master' was properly closed.
19:38:43.367312 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
19:38:43.388656 [info ] [MainThread]: 
19:38:43.390221 [info ] [MainThread]: [32mCompleted successfully[0m
19:38:43.393404 [info ] [MainThread]: 
19:38:43.396627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:38:43.402890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a023bf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a023bf1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a023b2100>]}


============================== 2024-07-21 19:40:27.431562 | 27835503-b11c-465f-bf02-bdd394ccadd7 ==============================
19:40:27.431562 [info ] [MainThread]: Running with dbt=1.0.0
19:40:27.433002 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:40:27.437164 [debug] [MainThread]: Tracking: tracking
19:40:27.443387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fa9cfca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fa9cf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fa9cfa00>]}
19:40:27.663640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:40:27.664987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:40:27.675335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9d9eaf0>]}
19:40:27.692583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fa11b220>]}
19:40:27.694201 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:40:27.698447 [info ] [MainThread]: 
19:40:27.700738 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:27.704652 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:40:27.723305 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:40:27.724363 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:40:27.725414 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:40:27.731296 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:40:27.734278 [debug] [ThreadPool]: On list_dbt_database: Close
19:40:27.736700 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:40:27.741069 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:40:27.742255 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:40:27.743214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:40:27.748058 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
19:40:27.750382 [debug] [ThreadPool]: On list_dbt_database: Close
19:40:27.754804 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:40:27.764004 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:40:27.765077 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:40:27.765972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:40:27.771170 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:40:27.772279 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:40:27.773285 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:40:27.777840 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:40:27.781407 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:40:27.782933 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:40:27.785267 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:40:27.789682 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:40:27.798001 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:40:27.799207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:40:27.808345 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:40:27.810261 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:40:27.812125 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:40:27.815662 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:40:27.819267 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:40:27.822242 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:40:27.834313 [debug] [MainThread]: Using postgres connection "master"
19:40:27.848635 [debug] [MainThread]: On master: BEGIN
19:40:27.850203 [debug] [MainThread]: Opening a new connection, currently in state init
19:40:27.866413 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:40:27.869558 [debug] [MainThread]: Using postgres connection "master"
19:40:27.871228 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:40:27.879334 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:40:27.884288 [debug] [MainThread]: On master: ROLLBACK
19:40:27.888616 [debug] [MainThread]: Using postgres connection "master"
19:40:27.892249 [debug] [MainThread]: On master: BEGIN
19:40:27.894856 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:27.896389 [debug] [MainThread]: On master: COMMIT
19:40:27.897873 [debug] [MainThread]: Using postgres connection "master"
19:40:27.899844 [debug] [MainThread]: On master: COMMIT
19:40:27.902306 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:27.904096 [debug] [MainThread]: On master: Close
19:40:27.906710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:40:27.909622 [info ] [MainThread]: 
19:40:27.926069 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:40:27.927790 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:40:27.930173 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:40:27.931559 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:40:27.932638 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:40:27.938391 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:40:27.952995 [debug] [Thread-1  ]: finished collecting timing info
19:40:27.954551 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:40:27.998034 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:40:28.007335 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:40:28.008423 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:40:28.009335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:28.013483 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:40:28.014635 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:40:28.015675 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:40:28.018226 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:40:28.028116 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:40:28.029180 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:40:28.030589 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:28.041924 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:40:28.043074 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:40:28.044023 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:40:28.046332 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:40:28.054905 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:40:28.055961 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:40:28.057171 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:40:28.059399 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.060519 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:40:28.061953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9c8c880>]}
19:40:28.063265 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
19:40:28.064439 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:40:28.065980 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:40:28.067995 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:40:28.069750 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:40:28.072110 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:40:28.073223 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:40:28.112476 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:40:28.123592 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.124802 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:40:28.128752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:40:28.139470 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:40:28.141002 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:40:28.142130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:28.146811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:40:28.148152 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:40:28.149444 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:40:28.152293 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:40:28.156213 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:40:28.157626 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:40:28.159184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:28.161783 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:40:28.163057 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:40:28.164180 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:40:28.166812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:40:28.169977 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:40:28.171078 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:40:28.172441 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:40:28.174870 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.176060 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:40:28.177611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fb416d30>]}
19:40:28.179238 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.11s]
19:40:28.180802 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:40:28.183249 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:40:28.184875 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:40:28.187035 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:40:28.189170 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:40:28.190348 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:40:28.195269 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:40:28.207171 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.208551 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:40:28.212584 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:40:28.225357 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:40:28.226940 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:40:28.227946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:28.232631 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:40:28.234133 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:40:28.235826 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:40:28.239648 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:40:28.243736 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:40:28.244944 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:40:28.246456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:28.249376 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:40:28.250548 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:40:28.252489 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:40:28.256097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:40:28.258955 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:40:28.260148 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:40:28.261684 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:40:28.264383 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.265625 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:40:28.267331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97fa9cfa60>]}
19:40:28.269395 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
19:40:28.270839 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:40:28.273515 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:40:28.274883 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:40:28.276708 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:40:28.278346 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:40:28.279562 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:40:28.284371 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:40:28.296132 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.297669 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:40:28.338712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:40:28.348528 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.349696 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:40:28.351000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:28.356326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:40:28.357667 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.358845 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:40:28.365731 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
19:40:28.369858 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.371122 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:40:28.372667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:28.376356 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.377522 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:40:28.378949 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:28.387914 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:40:28.389232 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.390333 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:40:28.393090 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:40:28.397353 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:40:28.398572 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:40:28.402180 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:28.404719 [debug] [Thread-1  ]: finished collecting timing info
19:40:28.406185 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:40:28.407877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27835503-b11c-465f-bf02-bdd394ccadd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9dbf700>]}
19:40:28.409498 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.13s]
19:40:28.411062 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:40:28.414082 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:28.415223 [debug] [MainThread]: Using postgres connection "master"
19:40:28.416364 [debug] [MainThread]: On master: BEGIN
19:40:28.417648 [debug] [MainThread]: Opening a new connection, currently in state closed
19:40:28.422666 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:40:28.423969 [debug] [MainThread]: On master: COMMIT
19:40:28.425073 [debug] [MainThread]: Using postgres connection "master"
19:40:28.426257 [debug] [MainThread]: On master: COMMIT
19:40:28.427758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:28.429013 [debug] [MainThread]: On master: Close
19:40:28.430579 [info ] [MainThread]: 
19:40:28.432157 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.73s.
19:40:28.434102 [debug] [MainThread]: Connection 'master' was properly closed.
19:40:28.436758 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:40:28.457690 [info ] [MainThread]: 
19:40:28.459294 [info ] [MainThread]: [32mCompleted successfully[0m
19:40:28.462245 [info ] [MainThread]: 
19:40:28.465675 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:40:28.469862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9d46ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9d46970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f9d3c5b0>]}


============================== 2024-07-21 19:40:35.341037 | a58e918b-b2f8-4c26-8e8f-7d348d83c901 ==============================
19:40:35.341037 [info ] [MainThread]: Running with dbt=1.0.0
19:40:35.342608 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
19:40:35.344830 [debug] [MainThread]: Tracking: tracking
19:40:35.351748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed745ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed745340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed745610>]}
19:40:35.545538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:40:35.547015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:40:35.562149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a58e918b-b2f8-4c26-8e8f-7d348d83c901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed35da30>]}
19:40:35.583048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a58e918b-b2f8-4c26-8e8f-7d348d83c901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed3cf1f0>]}
19:40:35.585005 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:40:35.589832 [info ] [MainThread]: 
19:40:35.592098 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:35.595239 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:40:35.612928 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:40:35.614193 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:40:35.615397 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:40:35.621761 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:40:35.623905 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:40:35.625033 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:40:35.628355 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
19:40:35.631283 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:40:35.632750 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:40:35.634914 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:40:35.639579 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:40:35.641453 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:40:35.642473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:40:35.646878 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:40:35.647995 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:40:35.648951 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:40:35.653236 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:40:35.656176 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:40:35.657431 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:40:35.664338 [debug] [MainThread]: Using postgres connection "master"
19:40:35.665583 [debug] [MainThread]: On master: BEGIN
19:40:35.666568 [debug] [MainThread]: Opening a new connection, currently in state init
19:40:35.671398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:35.672484 [debug] [MainThread]: Using postgres connection "master"
19:40:35.673424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:40:35.686453 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
19:40:35.689152 [debug] [MainThread]: On master: ROLLBACK
19:40:35.690348 [debug] [MainThread]: Using postgres connection "master"
19:40:35.691432 [debug] [MainThread]: On master: BEGIN
19:40:35.692799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:35.693970 [debug] [MainThread]: On master: COMMIT
19:40:35.694955 [debug] [MainThread]: Using postgres connection "master"
19:40:35.695960 [debug] [MainThread]: On master: COMMIT
19:40:35.697116 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:35.698138 [debug] [MainThread]: On master: Close
19:40:35.699425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:40:35.701823 [info ] [MainThread]: 
19:40:35.708019 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
19:40:35.709288 [info ] [Thread-1  ]: 1 of 1 START test customers_nb_orders_check..................................... [RUN]
19:40:35.711366 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
19:40:35.712951 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
19:40:35.714087 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
19:40:35.718017 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
19:40:35.728197 [debug] [Thread-1  ]: finished collecting timing info
19:40:35.729528 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
19:40:35.763427 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
19:40:35.772955 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:40:35.774286 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
19:40:35.775463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:35.779708 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:40:35.780905 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:40:35.781856 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
19:40:35.783569 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
19:40:35.788168 [debug] [Thread-1  ]: finished collecting timing info
19:40:35.789272 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
19:40:35.790378 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
19:40:35.791923 [info ] [Thread-1  ]: 1 of 1 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.08s]
19:40:35.793289 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
19:40:35.797654 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:35.798910 [debug] [MainThread]: Using postgres connection "master"
19:40:35.799886 [debug] [MainThread]: On master: BEGIN
19:40:35.800838 [debug] [MainThread]: Opening a new connection, currently in state closed
19:40:35.805619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:35.806725 [debug] [MainThread]: On master: COMMIT
19:40:35.807701 [debug] [MainThread]: Using postgres connection "master"
19:40:35.808633 [debug] [MainThread]: On master: COMMIT
19:40:35.809722 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:35.810822 [debug] [MainThread]: On master: Close
19:40:35.812304 [info ] [MainThread]: 
19:40:35.813827 [info ] [MainThread]: Finished running 1 test in 0.22s.
19:40:35.815695 [debug] [MainThread]: Connection 'master' was properly closed.
19:40:35.817504 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
19:40:35.838926 [info ] [MainThread]: 
19:40:35.841571 [info ] [MainThread]: [32mCompleted successfully[0m
19:40:35.845389 [info ] [MainThread]: 
19:40:35.848262 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:40:35.851494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2e2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed2f5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bed307520>]}


============================== 2024-07-21 19:42:25.738132 | fa48486a-56ea-45b5-9134-d66bd72d238f ==============================
19:42:25.738132 [info ] [MainThread]: Running with dbt=1.0.0
19:42:25.739931 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
19:42:25.741842 [debug] [MainThread]: Tracking: tracking
19:42:25.748809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed35cfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed35cf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed35cf8e0>]}
19:42:25.941232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:42:25.942682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:42:25.953822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa48486a-56ea-45b5-9134-d66bd72d238f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed29a0fd0>]}
19:42:25.974775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa48486a-56ea-45b5-9134-d66bd72d238f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed2d1e2b0>]}
19:42:25.976461 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:42:25.981202 [info ] [MainThread]: 
19:42:25.983631 [debug] [MainThread]: Acquiring new postgres connection "master"
19:42:25.987106 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:42:26.005709 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:42:26.007252 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:42:26.008512 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:42:26.015109 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:42:26.017125 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:42:26.018856 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:42:26.022531 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:42:26.025560 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:42:26.027246 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:42:26.029748 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:42:26.034212 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:42:26.035648 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:42:26.036934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:42:26.042052 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:42:26.043484 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:42:26.044804 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:42:26.048884 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
19:42:26.051671 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:42:26.053411 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:42:26.060890 [debug] [MainThread]: Using postgres connection "master"
19:42:26.062393 [debug] [MainThread]: On master: BEGIN
19:42:26.063780 [debug] [MainThread]: Opening a new connection, currently in state init
19:42:26.068977 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:42:26.070431 [debug] [MainThread]: Using postgres connection "master"
19:42:26.071665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:42:26.084141 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
19:42:26.087357 [debug] [MainThread]: On master: ROLLBACK
19:42:26.088997 [debug] [MainThread]: Using postgres connection "master"
19:42:26.090345 [debug] [MainThread]: On master: BEGIN
19:42:26.092099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:42:26.093473 [debug] [MainThread]: On master: COMMIT
19:42:26.094553 [debug] [MainThread]: Using postgres connection "master"
19:42:26.096311 [debug] [MainThread]: On master: COMMIT
19:42:26.097820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:42:26.099167 [debug] [MainThread]: On master: Close
19:42:26.100813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:42:26.102209 [info ] [MainThread]: 
19:42:26.109267 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
19:42:26.110674 [info ] [Thread-1  ]: 1 of 1 START test customers_nb_orders_check..................................... [RUN]
19:42:26.112935 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
19:42:26.114985 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
19:42:26.116446 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
19:42:26.121146 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
19:42:26.131993 [debug] [Thread-1  ]: finished collecting timing info
19:42:26.133785 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
19:42:26.164877 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
19:42:26.173549 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:42:26.174802 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
19:42:26.175969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:42:26.181760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:42:26.183263 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:42:26.184505 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
19:42:26.186553 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
19:42:26.190455 [debug] [Thread-1  ]: finished collecting timing info
19:42:26.191854 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
19:42:26.193510 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
19:42:26.195397 [info ] [Thread-1  ]: 1 of 1 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.08s]
19:42:26.197179 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
19:42:26.200858 [debug] [MainThread]: Acquiring new postgres connection "master"
19:42:26.202201 [debug] [MainThread]: Using postgres connection "master"
19:42:26.203468 [debug] [MainThread]: On master: BEGIN
19:42:26.204654 [debug] [MainThread]: Opening a new connection, currently in state closed
19:42:26.210065 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:42:26.211463 [debug] [MainThread]: On master: COMMIT
19:42:26.212860 [debug] [MainThread]: Using postgres connection "master"
19:42:26.214435 [debug] [MainThread]: On master: COMMIT
19:42:26.216392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:42:26.218096 [debug] [MainThread]: On master: Close
19:42:26.219876 [info ] [MainThread]: 
19:42:26.221206 [info ] [MainThread]: Finished running 1 test in 0.24s.
19:42:26.223183 [debug] [MainThread]: Connection 'master' was properly closed.
19:42:26.224976 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
19:42:26.252255 [info ] [MainThread]: 
19:42:26.255043 [info ] [MainThread]: [32mCompleted successfully[0m
19:42:26.259796 [info ] [MainThread]: 
19:42:26.269502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:42:26.271833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed2923a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed29364f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed2948760>]}


============================== 2024-07-21 19:44:23.759252 | 4659e7ff-2963-4d4d-862d-1bf4e334fd45 ==============================
19:44:23.759252 [info ] [MainThread]: Running with dbt=1.0.0
19:44:23.761441 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
19:44:23.764497 [debug] [MainThread]: Tracking: tracking
19:44:23.775531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca997f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca911fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca911ffa0>]}
19:44:23.999541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:44:24.001256 [debug] [MainThread]: Partial parsing: updated file: commerce://tests/customers_nb_orders_check.sql
19:44:24.057052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4659e7ff-2963-4d4d-862d-1bf4e334fd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca8ce00d0>]}
19:44:24.076659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4659e7ff-2963-4d4d-862d-1bf4e334fd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca9114f70>]}
19:44:24.078308 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:44:24.082601 [info ] [MainThread]: 
19:44:24.085158 [debug] [MainThread]: Acquiring new postgres connection "master"
19:44:24.090071 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:44:24.109612 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:44:24.111107 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:44:24.112378 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:44:24.117975 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:44:24.120544 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:44:24.121995 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:44:24.126587 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:44:24.129227 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:44:24.130540 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:44:24.132339 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:44:24.137056 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:44:24.138625 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:44:24.140891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:44:24.145616 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:44:24.146769 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:44:24.147791 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:44:24.150979 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:44:24.154468 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:44:24.155846 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:44:24.163560 [debug] [MainThread]: Using postgres connection "master"
19:44:24.164713 [debug] [MainThread]: On master: BEGIN
19:44:24.165697 [debug] [MainThread]: Opening a new connection, currently in state init
19:44:24.170155 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:44:24.171238 [debug] [MainThread]: Using postgres connection "master"
19:44:24.172122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:44:24.178704 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:44:24.180997 [debug] [MainThread]: On master: ROLLBACK
19:44:24.182278 [debug] [MainThread]: Using postgres connection "master"
19:44:24.183257 [debug] [MainThread]: On master: BEGIN
19:44:24.184544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:44:24.185846 [debug] [MainThread]: On master: COMMIT
19:44:24.187321 [debug] [MainThread]: Using postgres connection "master"
19:44:24.188699 [debug] [MainThread]: On master: COMMIT
19:44:24.190009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:24.191348 [debug] [MainThread]: On master: Close
19:44:24.192531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:44:24.194120 [info ] [MainThread]: 
19:44:24.200160 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
19:44:24.201259 [info ] [Thread-1  ]: 1 of 1 START test customers_nb_orders_check..................................... [RUN]
19:44:24.203323 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
19:44:24.204720 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
19:44:24.205904 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
19:44:24.210785 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
19:44:24.216792 [debug] [Thread-1  ]: finished collecting timing info
19:44:24.218156 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
19:44:24.280662 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
19:44:24.288532 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:44:24.290122 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
19:44:24.291370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:44:24.296615 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:44:24.298095 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:44:24.299145 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 1
      
    ) dbt_internal_test
19:44:24.300997 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
19:44:24.304912 [debug] [Thread-1  ]: finished collecting timing info
19:44:24.305995 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
19:44:24.307180 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
19:44:24.308622 [info ] [Thread-1  ]: 1 of 1 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.11s]
19:44:24.310412 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
19:44:24.313748 [debug] [MainThread]: Acquiring new postgres connection "master"
19:44:24.314942 [debug] [MainThread]: Using postgres connection "master"
19:44:24.316060 [debug] [MainThread]: On master: BEGIN
19:44:24.317159 [debug] [MainThread]: Opening a new connection, currently in state closed
19:44:24.321989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:44:24.323112 [debug] [MainThread]: On master: COMMIT
19:44:24.324355 [debug] [MainThread]: Using postgres connection "master"
19:44:24.325810 [debug] [MainThread]: On master: COMMIT
19:44:24.327122 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:44:24.328386 [debug] [MainThread]: On master: Close
19:44:24.329985 [info ] [MainThread]: 
19:44:24.331638 [info ] [MainThread]: Finished running 1 test in 0.25s.
19:44:24.333834 [debug] [MainThread]: Connection 'master' was properly closed.
19:44:24.335690 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
19:44:24.358631 [info ] [MainThread]: 
19:44:24.360159 [info ] [MainThread]: [32mCompleted successfully[0m
19:44:24.364260 [info ] [MainThread]: 
19:44:24.367020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:44:24.371682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca8cbf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca8cbf1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ca8d9ed60>]}


============================== 2024-07-21 19:45:09.402063 | 731c8785-c4b6-401f-acca-43cf368b52a1 ==============================
19:45:09.402063 [info ] [MainThread]: Running with dbt=1.0.0
19:45:09.403701 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
19:45:09.406603 [debug] [MainThread]: Tracking: tracking
19:45:09.412782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c663cfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c663cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c663cf610>]}
19:45:09.607208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:45:09.608789 [debug] [MainThread]: Partial parsing: updated file: commerce://tests/customers_nb_orders_check.sql
19:45:09.665526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '731c8785-c4b6-401f-acca-43cf368b52a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c657600d0>]}
19:45:09.683889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '731c8785-c4b6-401f-acca-43cf368b52a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c657e7f10>]}
19:45:09.685548 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:45:09.691613 [info ] [MainThread]: 
19:45:09.693983 [debug] [MainThread]: Acquiring new postgres connection "master"
19:45:09.697586 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:45:09.715836 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:45:09.716952 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:45:09.718842 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:45:09.725673 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:45:09.727492 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:45:09.729446 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:45:09.732695 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:45:09.735581 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:45:09.737004 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:45:09.738633 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:45:09.743100 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:45:09.744716 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:45:09.745753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:45:09.750650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:45:09.751820 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:45:09.752819 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:45:09.755964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:45:09.759060 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:45:09.760570 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:45:09.768550 [debug] [MainThread]: Using postgres connection "master"
19:45:09.769871 [debug] [MainThread]: On master: BEGIN
19:45:09.770881 [debug] [MainThread]: Opening a new connection, currently in state init
19:45:09.775552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:45:09.776661 [debug] [MainThread]: Using postgres connection "master"
19:45:09.777811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:45:09.784871 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:45:09.787212 [debug] [MainThread]: On master: ROLLBACK
19:45:09.788626 [debug] [MainThread]: Using postgres connection "master"
19:45:09.789947 [debug] [MainThread]: On master: BEGIN
19:45:09.791777 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:45:09.793075 [debug] [MainThread]: On master: COMMIT
19:45:09.794063 [debug] [MainThread]: Using postgres connection "master"
19:45:09.795024 [debug] [MainThread]: On master: COMMIT
19:45:09.796209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:45:09.797502 [debug] [MainThread]: On master: Close
19:45:09.798876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:45:09.800247 [info ] [MainThread]: 
19:45:09.806519 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
19:45:09.807930 [info ] [Thread-1  ]: 1 of 1 START test customers_nb_orders_check..................................... [RUN]
19:45:09.809802 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
19:45:09.811377 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
19:45:09.812557 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
19:45:09.817862 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
19:45:09.828077 [debug] [Thread-1  ]: finished collecting timing info
19:45:09.830494 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
19:45:09.890350 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
19:45:09.898428 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:45:09.899713 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
19:45:09.900910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:45:09.906517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:45:09.908231 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
19:45:09.909332 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders > 2
      
    ) dbt_internal_test
19:45:09.911123 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
19:45:09.914545 [debug] [Thread-1  ]: finished collecting timing info
19:45:09.915688 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
19:45:09.916959 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
19:45:09.918490 [error] [Thread-1  ]: 1 of 1 FAIL 6 customers_nb_orders_check......................................... [[31mFAIL 6[0m in 0.11s]
19:45:09.920072 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
19:45:09.923260 [debug] [MainThread]: Acquiring new postgres connection "master"
19:45:09.924472 [debug] [MainThread]: Using postgres connection "master"
19:45:09.925478 [debug] [MainThread]: On master: BEGIN
19:45:09.926645 [debug] [MainThread]: Opening a new connection, currently in state closed
19:45:09.931787 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:45:09.933209 [debug] [MainThread]: On master: COMMIT
19:45:09.934328 [debug] [MainThread]: Using postgres connection "master"
19:45:09.935567 [debug] [MainThread]: On master: COMMIT
19:45:09.937242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:45:09.938684 [debug] [MainThread]: On master: Close
19:45:09.940534 [info ] [MainThread]: 
19:45:09.942342 [info ] [MainThread]: Finished running 1 test in 0.25s.
19:45:09.946414 [debug] [MainThread]: Connection 'master' was properly closed.
19:45:09.949062 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
19:45:09.971356 [info ] [MainThread]: 
19:45:09.973113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:45:09.975649 [info ] [MainThread]: 
19:45:09.980916 [error] [MainThread]: [31mFailure in test customers_nb_orders_check (tests/customers_nb_orders_check.sql)[0m
19:45:09.984700 [error] [MainThread]:   Got 6 results, configured to fail if != 0
19:45:09.986938 [info ] [MainThread]: 
19:45:09.989027 [info ] [MainThread]:   compiled SQL at target/compiled/commerce/tests/customers_nb_orders_check.sql
19:45:09.991834 [info ] [MainThread]: 
19:45:09.993874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:45:09.996743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c65731820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6573f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c663f5550>]}


============================== 2024-07-21 19:52:53.162344 | 6f06c2b1-5e32-49be-8778-fe5f71d61308 ==============================
19:52:53.162344 [info ] [MainThread]: Running with dbt=1.0.0
19:52:53.167465 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:52:53.169395 [debug] [MainThread]: Tracking: tracking
19:52:53.176014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9bfcff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9bfcf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9bfcfbe0>]}
19:52:53.386257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:52:53.387829 [debug] [MainThread]: Partial parsing: added file: commerce://models/staging/stg_commerce.yml
19:52:53.480470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9b716ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9b36ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b9b36ba60>]}


============================== 2024-07-21 19:53:50.192670 | 5f3316e8-aff3-4b8e-be06-65b3f40e73de ==============================
19:53:50.192670 [info ] [MainThread]: Running with dbt=1.0.0
19:53:50.195722 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:53:50.199115 [debug] [MainThread]: Tracking: tracking
19:53:50.204429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ef0ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ef0feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ef0fbe0>]}
19:53:50.428685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:53:50.430480 [debug] [MainThread]: Partial parsing: added file: commerce://models/staging/stg_commerce.yml
19:53:50.599453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8e2670d0>]}
19:53:50.655995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8ef35f70>]}
19:53:50.657806 [info ] [MainThread]: Found 4 models, 3 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:53:50.666932 [info ] [MainThread]: 
19:53:50.669221 [debug] [MainThread]: Acquiring new postgres connection "master"
19:53:50.672556 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:53:50.705802 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:53:50.708036 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:53:50.709385 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:53:50.719128 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:53:50.721887 [debug] [ThreadPool]: On list_dbt_database: Close
19:53:50.723442 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:53:50.726390 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:53:50.728432 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:53:50.729833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:50.735598 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:53:50.738134 [debug] [ThreadPool]: On list_dbt_database: Close
19:53:50.740818 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:53:50.750767 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:53:50.751888 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:53:50.752826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:50.757165 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:53:50.758294 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:53:50.759225 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:53:50.762500 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:53:50.764803 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:53:50.765979 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:53:50.767577 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:53:50.771280 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:53:50.772403 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:53:50.773671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:50.778516 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:53:50.779681 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:53:50.780640 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:53:50.783618 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:53:50.785994 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:53:50.787171 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:53:50.795471 [debug] [MainThread]: Using postgres connection "master"
19:53:50.796488 [debug] [MainThread]: On master: BEGIN
19:53:50.797373 [debug] [MainThread]: Opening a new connection, currently in state init
19:53:50.801522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:53:50.802589 [debug] [MainThread]: Using postgres connection "master"
19:53:50.803846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:53:50.810528 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:53:50.812850 [debug] [MainThread]: On master: ROLLBACK
19:53:50.814101 [debug] [MainThread]: Using postgres connection "master"
19:53:50.815074 [debug] [MainThread]: On master: BEGIN
19:53:50.816327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:53:50.817435 [debug] [MainThread]: On master: COMMIT
19:53:50.818399 [debug] [MainThread]: Using postgres connection "master"
19:53:50.819649 [debug] [MainThread]: On master: COMMIT
19:53:50.820720 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:50.821727 [debug] [MainThread]: On master: Close
19:53:50.823104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:53:50.824616 [info ] [MainThread]: 
19:53:50.865202 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:53:50.866599 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:53:50.868287 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:53:50.870183 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:53:50.871745 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:53:50.876125 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:53:50.887974 [debug] [Thread-1  ]: finished collecting timing info
19:53:50.889106 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:53:50.931141 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:53:50.939003 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:53:50.940262 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:53:50.941280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:50.947553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:53:50.948879 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:53:50.950076 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:53:50.953329 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:53:50.962678 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:53:50.963788 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:53:50.965185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:53:50.976149 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:53:50.977575 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:53:50.979201 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:53:50.982482 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:53:50.990080 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:53:50.991455 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:53:50.992946 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:53:50.995667 [debug] [Thread-1  ]: finished collecting timing info
19:53:50.996981 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:53:50.998689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8dff2430>]}
19:53:51.000175 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
19:53:51.001801 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:53:51.003478 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:53:51.005088 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:53:51.006794 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:53:51.008865 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:53:51.010231 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:53:51.016506 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:53:51.025486 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.026719 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:53:51.032930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:53:51.042166 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:53:51.043724 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:53:51.045654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:51.051951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:53:51.053209 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:53:51.054418 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:53:51.056830 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:53:51.061832 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:53:51.063565 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:53:51.065389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:53:51.067992 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:53:51.069357 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:53:51.070457 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:53:51.073090 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:53:51.076173 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:53:51.078099 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:53:51.079894 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:53:51.082423 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.083678 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:53:51.085309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8dfe12e0>]}
19:53:51.086824 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
19:53:51.088358 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:53:51.091000 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:53:51.092367 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:53:51.094934 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:53:51.096383 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:53:51.097762 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:53:51.106521 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:53:51.122149 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.123703 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:53:51.134300 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:53:51.145687 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:53:51.147396 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:53:51.148942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:51.155431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:53:51.157007 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:53:51.158259 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:53:51.162472 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:53:51.167385 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:53:51.168724 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:53:51.170477 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:53:51.173258 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:53:51.174774 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:53:51.176085 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:53:51.180125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:53:51.184263 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:53:51.185726 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:53:51.187326 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:53:51.190449 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.191779 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:53:51.193652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8dfbdd60>]}
19:53:51.195814 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.10s]
19:53:51.197516 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:53:51.201138 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:53:51.202820 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:53:51.205024 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:53:51.207133 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:53:51.208460 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:53:51.216593 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:53:51.230445 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.232621 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:53:51.288107 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:53:51.298215 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.299706 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:53:51.300847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:51.306354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:53:51.307851 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.309105 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:53:51.316127 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
19:53:51.321418 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.322759 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:53:51.324461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:53:51.335587 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.337181 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:53:51.339132 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:53:51.371229 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:53:51.372749 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.374160 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:53:51.377936 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:53:51.383632 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:53:51.385107 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:53:51.389185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:53:51.392260 [debug] [Thread-1  ]: finished collecting timing info
19:53:51.394020 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:53:51.396227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3316e8-aff3-4b8e-be06-65b3f40e73de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8f557c70>]}
19:53:51.399428 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.19s]
19:53:51.401375 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:53:51.405336 [debug] [MainThread]: Acquiring new postgres connection "master"
19:53:51.405514 [debug] [MainThread]: Using postgres connection "master"
19:53:51.406751 [debug] [MainThread]: On master: BEGIN
19:53:51.408058 [debug] [MainThread]: Opening a new connection, currently in state closed
19:53:51.415415 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:51.416513 [debug] [MainThread]: On master: COMMIT
19:53:51.417540 [debug] [MainThread]: Using postgres connection "master"
19:53:51.418478 [debug] [MainThread]: On master: COMMIT
19:53:51.419584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:51.420777 [debug] [MainThread]: On master: Close
19:53:51.422250 [info ] [MainThread]: 
19:53:51.423609 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.75s.
19:53:51.425928 [debug] [MainThread]: Connection 'master' was properly closed.
19:53:51.428656 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:53:51.448123 [info ] [MainThread]: 
19:53:51.449703 [info ] [MainThread]: [32mCompleted successfully[0m
19:53:51.452115 [info ] [MainThread]: 
19:53:51.456239 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:53:51.460171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8dfb5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8dfb5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8f950520>]}


============================== 2024-07-21 19:55:57.991018 | b90371ab-c43e-493f-8d42-681ca8b036d6 ==============================
19:55:57.991018 [info ] [MainThread]: Running with dbt=1.0.0
19:55:57.993313 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:55:57.997940 [debug] [MainThread]: Tracking: tracking
19:55:58.006213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83d08ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83d08feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83d08fbe0>]}
19:55:58.237523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:55:58.239199 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
19:55:58.329189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c75d820>]}
19:55:58.350329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c757fd0>]}
19:55:58.351877 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:55:58.356866 [info ] [MainThread]: 
19:55:58.360379 [debug] [MainThread]: Acquiring new postgres connection "master"
19:55:58.364393 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:55:58.386055 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:55:58.387186 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:55:58.388182 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:55:58.395543 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:55:58.399688 [debug] [ThreadPool]: On list_dbt_database: Close
19:55:58.402781 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:55:58.406384 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:55:58.407726 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:55:58.408966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:58.415801 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:55:58.418633 [debug] [ThreadPool]: On list_dbt_database: Close
19:55:58.421848 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:55:58.433154 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:55:58.434537 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:55:58.435574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:58.440260 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:55:58.441409 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:55:58.442398 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:55:58.446118 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:55:58.448865 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:55:58.450174 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:55:58.451824 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:55:58.484953 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:55:58.485950 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:55:58.487078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:58.491748 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:55:58.492913 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:55:58.494009 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:55:58.497455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:55:58.499886 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:55:58.501255 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:55:58.508971 [debug] [MainThread]: Using postgres connection "master"
19:55:58.510229 [debug] [MainThread]: On master: BEGIN
19:55:58.511596 [debug] [MainThread]: Opening a new connection, currently in state init
19:55:58.517152 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:58.518517 [debug] [MainThread]: Using postgres connection "master"
19:55:58.519550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:55:58.526474 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:55:58.529198 [debug] [MainThread]: On master: ROLLBACK
19:55:58.531081 [debug] [MainThread]: Using postgres connection "master"
19:55:58.532312 [debug] [MainThread]: On master: BEGIN
19:55:58.533895 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:55:58.535227 [debug] [MainThread]: On master: COMMIT
19:55:58.536509 [debug] [MainThread]: Using postgres connection "master"
19:55:58.537803 [debug] [MainThread]: On master: COMMIT
19:55:58.539321 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:58.540701 [debug] [MainThread]: On master: Close
19:55:58.543827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:55:58.546973 [info ] [MainThread]: 
19:55:58.554537 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:55:58.557798 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:55:58.560356 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:55:58.563749 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:55:58.569849 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:55:58.579168 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:55:58.605464 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.606825 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:55:58.709113 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:55:58.715980 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:55:58.717137 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:55:58.718127 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:58.723691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:55:58.724920 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:55:58.725957 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:55:58.728363 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:55:58.741168 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:55:58.742344 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:55:58.743836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:58.755008 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:55:58.756054 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:55:58.756982 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:55:58.759117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:55:58.766902 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:55:58.767967 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:55:58.769199 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:55:58.771466 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.772653 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:55:58.774209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83d0942e0>]}
19:55:58.776008 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.21s]
19:55:58.777325 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:55:58.779036 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:55:58.781893 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:55:58.784385 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:55:58.786035 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:55:58.787036 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:55:58.791215 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:55:58.802150 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.803425 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:55:58.807081 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:55:58.818889 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:55:58.820014 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:55:58.821052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:58.825302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:55:58.826443 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:55:58.827474 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:55:58.830340 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:55:58.835720 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:55:58.836841 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:55:58.838251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:58.840547 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:55:58.841550 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:55:58.842608 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:55:58.844956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:55:58.848731 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:55:58.849771 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:55:58.851026 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:55:58.853422 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.854507 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:55:58.855913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83cb20a60>]}
19:55:58.857463 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.07s]
19:55:58.858704 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:55:58.861146 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:55:58.862683 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:55:58.864621 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:55:58.866614 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:55:58.867731 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:55:58.874834 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:55:58.886353 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.887870 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:55:58.892016 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:55:58.903216 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:55:58.904560 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:55:58.905389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:58.909486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:55:58.910538 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:55:58.911457 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:55:58.916284 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:55:58.920187 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:55:58.921233 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:55:58.922607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:58.924974 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:55:58.926001 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:55:58.926919 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:55:58.929038 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:55:58.933007 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:55:58.934110 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:55:58.935360 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:55:58.937674 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.938707 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:55:58.940118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c362e20>]}
19:55:58.941527 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
19:55:58.942839 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:55:58.945506 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:55:58.947403 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:55:58.949438 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:55:58.951393 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:55:58.952712 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:55:58.957063 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:55:58.966004 [debug] [Thread-1  ]: finished collecting timing info
19:55:58.968162 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:55:59.010271 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:55:59.019264 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.020329 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:55:59.021368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:59.025621 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:55:59.026853 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.027781 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:55:59.034335 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
19:55:59.038015 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.039047 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:55:59.040392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:59.045246 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.046630 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:55:59.047967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:59.056297 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:55:59.057357 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.058297 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:55:59.060321 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:55:59.063506 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:55:59.064554 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:55:59.067485 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:55:59.069755 [debug] [Thread-1  ]: finished collecting timing info
19:55:59.070829 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:55:59.072370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b90371ab-c43e-493f-8d42-681ca8b036d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c708310>]}
19:55:59.073888 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
19:55:59.075304 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:55:59.078579 [debug] [MainThread]: Acquiring new postgres connection "master"
19:55:59.080398 [debug] [MainThread]: Using postgres connection "master"
19:55:59.081644 [debug] [MainThread]: On master: BEGIN
19:55:59.082702 [debug] [MainThread]: Opening a new connection, currently in state closed
19:55:59.087226 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:55:59.088724 [debug] [MainThread]: On master: COMMIT
19:55:59.089934 [debug] [MainThread]: Using postgres connection "master"
19:55:59.091037 [debug] [MainThread]: On master: COMMIT
19:55:59.092311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:59.093348 [debug] [MainThread]: On master: Close
19:55:59.094922 [info ] [MainThread]: 
19:55:59.097239 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.74s.
19:55:59.099475 [debug] [MainThread]: Connection 'master' was properly closed.
19:55:59.103776 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:55:59.121037 [info ] [MainThread]: 
19:55:59.122700 [info ] [MainThread]: [32mCompleted successfully[0m
19:55:59.125685 [info ] [MainThread]: 
19:55:59.127855 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:55:59.131260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83caba910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c3525b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c3943a0>]}


============================== 2024-07-21 19:56:20.972731 | 39f3a9a1-424c-4694-b934-d06c88d9b65b ==============================
19:56:20.972731 [info ] [MainThread]: Running with dbt=1.0.0
19:56:20.974136 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
19:56:20.976462 [debug] [MainThread]: Tracking: tracking
19:56:20.984620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226dc5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226dc5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226dc5d60>]}
19:56:21.213031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:56:21.215107 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
19:56:21.243475 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
19:56:21.429736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226c710d0>]}
19:56:21.466497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226dc0730>]}
19:56:21.468362 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
19:56:21.473723 [info ] [MainThread]: 
19:56:21.476504 [debug] [MainThread]: Acquiring new postgres connection "master"
19:56:21.482109 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:56:21.545308 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:56:21.546523 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:56:21.547637 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:56:21.553198 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
19:56:21.555720 [debug] [ThreadPool]: On list_dbt_database: Close
19:56:21.557353 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
19:56:21.561274 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
19:56:21.562307 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
19:56:21.563234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:56:21.567942 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
19:56:21.570286 [debug] [ThreadPool]: On list_dbt_database: Close
19:56:21.573383 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
19:56:21.583136 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:56:21.584312 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
19:56:21.585336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:56:21.589457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:56:21.590562 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
19:56:21.591723 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
19:56:21.595105 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
19:56:21.597469 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
19:56:21.598790 [debug] [ThreadPool]: On list_dbt_database_marts: Close
19:56:21.600305 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
19:56:21.603318 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:56:21.604494 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
19:56:21.605516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:56:21.609978 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:56:21.611143 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
19:56:21.612115 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
19:56:21.615728 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
19:56:21.618038 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
19:56:21.619227 [debug] [ThreadPool]: On list_dbt_database_staging: Close
19:56:21.626961 [debug] [MainThread]: Using postgres connection "master"
19:56:21.628042 [debug] [MainThread]: On master: BEGIN
19:56:21.629106 [debug] [MainThread]: Opening a new connection, currently in state init
19:56:21.633306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:56:21.634383 [debug] [MainThread]: Using postgres connection "master"
19:56:21.635377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:56:21.642354 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:56:21.644856 [debug] [MainThread]: On master: ROLLBACK
19:56:21.646074 [debug] [MainThread]: Using postgres connection "master"
19:56:21.647122 [debug] [MainThread]: On master: BEGIN
19:56:21.648460 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:56:21.649532 [debug] [MainThread]: On master: COMMIT
19:56:21.650458 [debug] [MainThread]: Using postgres connection "master"
19:56:21.651461 [debug] [MainThread]: On master: COMMIT
19:56:21.652559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:56:21.653563 [debug] [MainThread]: On master: Close
19:56:21.654896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:56:21.656374 [info ] [MainThread]: 
19:56:21.663863 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
19:56:21.665204 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
19:56:21.666817 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
19:56:21.668511 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
19:56:21.669603 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
19:56:21.674582 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
19:56:21.684830 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.686117 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
19:56:21.729892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
19:56:21.738126 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:56:21.739284 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
19:56:21.740419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:21.745605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:56:21.746998 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:56:21.748116 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
19:56:21.750497 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:56:21.759734 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:56:21.761172 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
19:56:21.762915 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:56:21.773525 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:56:21.774863 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:56:21.776381 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
19:56:21.780273 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:56:21.787746 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
19:56:21.789179 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
19:56:21.790770 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:56:21.793631 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.794850 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
19:56:21.796651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f322713e460>]}
19:56:21.798257 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
19:56:21.799962 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
19:56:21.801706 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
19:56:21.803195 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
19:56:21.804999 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
19:56:21.806724 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
19:56:21.808034 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
19:56:21.812635 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
19:56:21.822990 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.824247 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
19:56:21.831532 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
19:56:21.840967 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:56:21.842409 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
19:56:21.844320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:21.850347 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:56:21.851714 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:56:21.853052 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
19:56:21.855585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:56:21.860454 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:56:21.862530 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
19:56:21.864300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:56:21.866951 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:56:21.868210 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:56:21.869448 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
19:56:21.872633 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:56:21.876739 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
19:56:21.878172 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
19:56:21.880111 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:56:21.882907 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.884343 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
19:56:21.886145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32271405e0>]}
19:56:21.887632 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
19:56:21.889102 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
19:56:21.891961 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
19:56:21.893581 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
19:56:21.895527 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
19:56:21.897309 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
19:56:21.898822 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
19:56:21.903901 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
19:56:21.917238 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.918685 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
19:56:21.922486 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
19:56:21.934817 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:56:21.936050 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
19:56:21.937229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:21.942281 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:56:21.944033 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:56:21.945926 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
19:56:21.949321 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
19:56:21.953136 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:56:21.954335 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
19:56:21.955924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:56:21.959087 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:56:21.960950 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:56:21.962301 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
19:56:21.964766 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:56:21.967656 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
19:56:21.968726 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
19:56:21.970134 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
19:56:21.972872 [debug] [Thread-1  ]: finished collecting timing info
19:56:21.974072 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
19:56:21.976285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32269875e0>]}
19:56:21.978034 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
19:56:21.979476 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
19:56:21.982217 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
19:56:21.983605 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
19:56:21.985372 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
19:56:21.987373 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
19:56:21.988551 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
19:56:21.993063 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
19:56:22.003902 [debug] [Thread-1  ]: finished collecting timing info
19:56:22.005028 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
19:56:22.045328 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
19:56:22.053101 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.054369 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
19:56:22.055480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:22.060628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:56:22.061757 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.062932 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
19:56:22.068571 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.0 seconds
19:56:22.072471 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.073532 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
19:56:22.075053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:56:22.079236 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.080379 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
19:56:22.081935 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:56:22.090167 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:56:22.091462 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.092897 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
19:56:22.095418 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:56:22.098491 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
19:56:22.099580 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
19:56:22.102795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:56:22.105224 [debug] [Thread-1  ]: finished collecting timing info
19:56:22.106425 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
19:56:22.108015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f3a9a1-424c-4694-b934-d06c88d9b65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3226cc0df0>]}
19:56:22.109695 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
19:56:22.111297 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
19:56:22.114866 [debug] [MainThread]: Acquiring new postgres connection "master"
19:56:22.116186 [debug] [MainThread]: Using postgres connection "master"
19:56:22.117382 [debug] [MainThread]: On master: BEGIN
19:56:22.118467 [debug] [MainThread]: Opening a new connection, currently in state closed
19:56:22.123132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:56:22.124338 [debug] [MainThread]: On master: COMMIT
19:56:22.126932 [debug] [MainThread]: Using postgres connection "master"
19:56:22.128238 [debug] [MainThread]: On master: COMMIT
19:56:22.129744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:56:22.130932 [debug] [MainThread]: On master: Close
19:56:22.132438 [info ] [MainThread]: 
19:56:22.134172 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.66s.
19:56:22.135929 [debug] [MainThread]: Connection 'master' was properly closed.
19:56:22.137564 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
19:56:22.161486 [info ] [MainThread]: 
19:56:22.166636 [info ] [MainThread]: [32mCompleted successfully[0m
19:56:22.168906 [info ] [MainThread]: 
19:56:22.171175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
19:56:22.173683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32269b9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32269b9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32269b9a90>]}


============================== 2024-07-21 20:20:30.809615 | 477826b1-2cf9-40bc-80eb-d6de092ef727 ==============================
20:20:30.809615 [info ] [MainThread]: Running with dbt=1.0.0
20:20:30.811294 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:20:30.813699 [debug] [MainThread]: Tracking: tracking
20:20:30.822115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758d53f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c985b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c985b20>]}
20:20:31.084669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:20:31.086317 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:20:31.108328 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:20:31.197874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c5f10d0>]}
20:20:31.217866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c91df10>]}
20:20:31.219921 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:20:31.224730 [info ] [MainThread]: 
20:20:31.226990 [debug] [MainThread]: Acquiring new postgres connection "master"
20:20:31.230466 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:20:31.284569 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:20:31.285758 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:20:31.286823 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:20:31.293143 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:20:31.295917 [debug] [ThreadPool]: On list_dbt_database: Close
20:20:31.297759 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:20:31.301325 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:20:31.302552 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:20:31.303706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:20:31.308841 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:20:31.311382 [debug] [ThreadPool]: On list_dbt_database: Close
20:20:31.314899 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:20:31.324508 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:20:31.325688 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:20:31.326853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:20:31.331402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:20:31.332601 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:20:31.334190 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:20:31.337495 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:20:31.339991 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:20:31.341394 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:20:31.343181 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:20:31.346299 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:20:31.347411 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:20:31.348495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:20:31.353763 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:20:31.355132 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:20:31.356345 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:20:31.359877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:20:31.362540 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:20:31.363947 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:20:31.371921 [debug] [MainThread]: Using postgres connection "master"
20:20:31.373148 [debug] [MainThread]: On master: BEGIN
20:20:31.374339 [debug] [MainThread]: Opening a new connection, currently in state init
20:20:31.379132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:20:31.380490 [debug] [MainThread]: Using postgres connection "master"
20:20:31.381740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:20:31.389400 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:20:31.392113 [debug] [MainThread]: On master: ROLLBACK
20:20:31.393456 [debug] [MainThread]: Using postgres connection "master"
20:20:31.394674 [debug] [MainThread]: On master: BEGIN
20:20:31.396333 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:20:31.397580 [debug] [MainThread]: On master: COMMIT
20:20:31.398797 [debug] [MainThread]: Using postgres connection "master"
20:20:31.399990 [debug] [MainThread]: On master: COMMIT
20:20:31.401583 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:20:31.402837 [debug] [MainThread]: On master: Close
20:20:31.404571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:20:31.406333 [info ] [MainThread]: 
20:20:31.417673 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:20:31.419427 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:20:31.421356 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:20:31.423104 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:20:31.424282 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:20:31.428691 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:20:31.441147 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.442347 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:20:31.487126 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:20:31.495585 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:20:31.497061 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:20:31.498116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:31.503970 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:31.505336 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:20:31.506395 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:20:31.509048 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:20:31.518831 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:20:31.520184 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:20:31.521687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:20:31.532158 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:20:31.533472 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:20:31.534719 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:20:31.537493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:20:31.544888 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:20:31.546092 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:20:31.547608 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:20:31.550374 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.551914 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:20:31.553614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c9f5c10>]}
20:20:31.555058 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
20:20:31.556553 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:20:31.558444 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:20:31.559884 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:20:31.561853 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:20:31.563949 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:20:31.565391 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:20:31.571869 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:20:31.581547 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.583003 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:20:31.589959 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:20:31.600942 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:20:31.602223 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:20:31.605220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:31.611278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:31.612389 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:20:31.613433 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:20:31.615705 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:20:31.621480 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:20:31.622603 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:20:31.624123 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:20:31.626429 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:20:31.627442 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:20:31.628380 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:20:31.630755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:20:31.634271 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:20:31.635347 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:20:31.636784 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:20:31.639038 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.640142 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:20:31.641647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c554d90>]}
20:20:31.643170 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
20:20:31.644585 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:20:31.647103 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:20:31.648339 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:20:31.650330 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:20:31.651999 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:20:31.653560 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:20:31.657880 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:20:31.665826 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.668157 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:20:31.673558 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:20:31.681016 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:20:31.682531 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:20:31.684141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:31.690489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:31.691657 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:20:31.692673 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:20:31.695244 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:20:31.699002 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:20:31.700369 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:20:31.702694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:20:31.706371 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:20:31.707454 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:20:31.708397 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:20:31.710468 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:20:31.713546 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:20:31.714599 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:20:31.715858 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:20:31.718755 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.719863 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:20:31.721300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c540160>]}
20:20:31.722681 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.07s]
20:20:31.723900 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:20:31.726531 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:20:31.728088 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:20:31.730586 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:20:31.732298 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:20:31.733890 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:20:31.739892 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:20:31.748188 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.749511 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:20:31.802675 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:20:31.810477 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.811946 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:20:31.813204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:31.817882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:20:31.819206 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.820257 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:20:31.828030 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:20:31.832219 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.833503 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:20:31.834984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:20:31.839578 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.841034 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:20:31.842560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:20:31.851568 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:20:31.852834 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.854011 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:20:31.857362 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:20:31.868248 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:20:31.870470 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:20:31.875769 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:20:31.879161 [debug] [Thread-1  ]: finished collecting timing info
20:20:31.880752 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:20:31.882870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '477826b1-2cf9-40bc-80eb-d6de092ef727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c8525b0>]}
20:20:31.884804 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.15s]
20:20:31.886551 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:20:31.890395 [debug] [MainThread]: Acquiring new postgres connection "master"
20:20:31.891781 [debug] [MainThread]: Using postgres connection "master"
20:20:31.892940 [debug] [MainThread]: On master: BEGIN
20:20:31.894024 [debug] [MainThread]: Opening a new connection, currently in state closed
20:20:31.899014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:20:31.900450 [debug] [MainThread]: On master: COMMIT
20:20:31.901773 [debug] [MainThread]: Using postgres connection "master"
20:20:31.903518 [debug] [MainThread]: On master: COMMIT
20:20:31.905877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:20:31.907188 [debug] [MainThread]: On master: Close
20:20:31.908724 [info ] [MainThread]: 
20:20:31.910076 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.68s.
20:20:31.911827 [debug] [MainThread]: Connection 'master' was properly closed.
20:20:31.913546 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:20:31.939091 [info ] [MainThread]: 
20:20:31.941140 [info ] [MainThread]: [32mCompleted successfully[0m
20:20:31.943263 [info ] [MainThread]: 
20:20:31.945766 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:20:31.948524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c572400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c572160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c5722e0>]}


============================== 2024-07-21 20:20:45.573294 | 16a95fb0-5c2e-4fd9-8661-11390f4f82f5 ==============================
20:20:45.573294 [info ] [MainThread]: Running with dbt=1.0.0
20:20:45.574870 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:20:45.576937 [debug] [MainThread]: Tracking: tracking
20:20:45.584687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcb7ff0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcaf4fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcaf4ffa0>]}
20:20:45.779092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:20:45.780614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:20:45.791556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16a95fb0-5c2e-4fd9-8661-11390f4f82f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab74ee0>]}
20:20:45.812013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16a95fb0-5c2e-4fd9-8661-11390f4f82f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcabc1190>]}
20:20:45.816317 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:20:45.823861 [info ] [MainThread]: 
20:20:45.827451 [debug] [MainThread]: Acquiring new postgres connection "master"
20:20:45.845095 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:20:45.872862 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:20:45.874062 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:20:45.875133 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:20:45.884425 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:20:45.886185 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:20:45.888862 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:20:45.892748 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:20:45.896068 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:20:45.897490 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:20:45.900729 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:20:45.905659 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:20:45.907096 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:20:45.911212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:20:45.918435 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:20:45.919803 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:20:45.920951 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:20:45.924755 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:20:45.927272 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:20:45.928458 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:20:45.936637 [debug] [MainThread]: Using postgres connection "master"
20:20:45.937738 [debug] [MainThread]: On master: BEGIN
20:20:45.938667 [debug] [MainThread]: Opening a new connection, currently in state init
20:20:45.942831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:20:45.943958 [debug] [MainThread]: Using postgres connection "master"
20:20:45.944908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:20:45.957558 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:20:45.960292 [debug] [MainThread]: On master: ROLLBACK
20:20:45.961568 [debug] [MainThread]: Using postgres connection "master"
20:20:45.962598 [debug] [MainThread]: On master: BEGIN
20:20:45.964325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:20:45.965822 [debug] [MainThread]: On master: COMMIT
20:20:45.966792 [debug] [MainThread]: Using postgres connection "master"
20:20:45.967707 [debug] [MainThread]: On master: COMMIT
20:20:45.968772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:20:45.969746 [debug] [MainThread]: On master: Close
20:20:45.971027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:20:45.972293 [info ] [MainThread]: 
20:20:45.979144 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d
20:20:45.980368 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped [RUN]
20:20:45.982382 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"
20:20:45.983931 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d
20:20:45.985079 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d
20:20:46.009476 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"
20:20:46.026685 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.028283 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d
20:20:46.060773 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"
20:20:46.075449 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"
20:20:46.076787 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d: BEGIN
20:20:46.078162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.083078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:20:46.084320 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"
20:20:46.085466 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'pla','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:20:46.089147 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.092793 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.093978 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d: ROLLBACK
20:20:46.095095 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d: Close
20:20:46.096555 [error] [Thread-1  ]: 1 of 6 FAIL 1 accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped [[31mFAIL 1[0m in 0.11s]
20:20:46.098146 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped.2acc6f635d
20:20:46.101212 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:20:46.102518 [info ] [Thread-1  ]: 2 of 6 START test customers_nb_orders_check..................................... [RUN]
20:20:46.104588 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:20:46.106829 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:20:46.108090 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:20:46.112342 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:20:46.121729 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.123346 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:20:46.126629 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:20:46.136678 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:20:46.138380 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:20:46.139376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.144004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:20:46.145135 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:20:46.146187 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders > 2
      
    ) dbt_internal_test
20:20:46.148193 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.152353 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.154197 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:20:46.155392 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:20:46.156770 [error] [Thread-1  ]: 2 of 6 FAIL 6 customers_nb_orders_check......................................... [[31mFAIL 6[0m in 0.05s]
20:20:46.158205 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:20:46.160099 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:20:46.161255 [info ] [Thread-1  ]: 3 of 6 START test not_null_stg_customers_id..................................... [RUN]
20:20:46.162926 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:20:46.165774 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:20:46.167922 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:20:46.180107 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:20:46.192494 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.193796 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:20:46.234416 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:20:46.243717 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:20:46.245243 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:20:46.246797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.252676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:46.254167 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:20:46.255472 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:20:46.257631 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.260387 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.261636 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:20:46.263019 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:20:46.264719 [info ] [Thread-1  ]: 3 of 6 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.10s]
20:20:46.266533 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:20:46.268446 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:20:46.269867 [info ] [Thread-1  ]: 4 of 6 START test not_null_stg_orders_order_id.................................. [RUN]
20:20:46.271722 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:20:46.273723 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:20:46.275002 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:20:46.281420 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:20:46.293832 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.295115 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:20:46.299334 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:20:46.310970 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:20:46.312126 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:20:46.313382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.320019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:46.321235 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:20:46.322460 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:20:46.324750 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.327429 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.328498 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:20:46.329617 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:20:46.331348 [info ] [Thread-1  ]: 4 of 6 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:20:46.333278 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:20:46.335148 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:20:46.336442 [info ] [Thread-1  ]: 5 of 6 START test unique_stg_customers_id....................................... [RUN]
20:20:46.338162 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:20:46.339793 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:20:46.341046 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:20:46.354483 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:20:46.363791 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.366288 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:20:46.372262 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:20:46.382946 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:20:46.384468 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:20:46.386470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.392820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:46.394177 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:20:46.395403 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:20:46.397717 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.402845 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.404018 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:20:46.405158 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:20:46.406589 [info ] [Thread-1  ]: 5 of 6 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.07s]
20:20:46.408629 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:20:46.410420 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:20:46.411656 [info ] [Thread-1  ]: 6 of 6 START test unique_stg_orders_order_id.................................... [RUN]
20:20:46.413430 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:20:46.415487 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:20:46.417105 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:20:46.422876 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:20:46.432012 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.435116 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:20:46.439740 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:20:46.450560 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:20:46.452450 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:20:46.454495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:20:46.459783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:20:46.461009 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:20:46.462287 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:20:46.465621 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:20:46.469893 [debug] [Thread-1  ]: finished collecting timing info
20:20:46.470992 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:20:46.472104 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:20:46.473612 [info ] [Thread-1  ]: 6 of 6 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:20:46.475007 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:20:46.478619 [debug] [MainThread]: Acquiring new postgres connection "master"
20:20:46.480404 [debug] [MainThread]: Using postgres connection "master"
20:20:46.482856 [debug] [MainThread]: On master: BEGIN
20:20:46.484634 [debug] [MainThread]: Opening a new connection, currently in state closed
20:20:46.489911 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:20:46.490833 [debug] [MainThread]: On master: COMMIT
20:20:46.491776 [debug] [MainThread]: Using postgres connection "master"
20:20:46.492688 [debug] [MainThread]: On master: COMMIT
20:20:46.494203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:20:46.495336 [debug] [MainThread]: On master: Close
20:20:46.496644 [info ] [MainThread]: 
20:20:46.498857 [info ] [MainThread]: Finished running 6 tests in 0.67s.
20:20:46.501227 [debug] [MainThread]: Connection 'master' was properly closed.
20:20:46.503763 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:20:46.524858 [info ] [MainThread]: 
20:20:46.526543 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
20:20:46.528805 [info ] [MainThread]: 
20:20:46.531167 [error] [MainThread]: [31mFailure in test accepted_values_stg_orders_status__pla__completed__returned__return_pending__shipped (models/staging/stg_commerce.yml)[0m
20:20:46.534252 [error] [MainThread]:   Got 1 result, configured to fail if != 0
20:20:46.536116 [info ] [MainThread]: 
20:20:46.542126 [info ] [MainThread]:   compiled SQL at target/compiled/commerce/models/staging/stg_commerce.yml/accepted_values_stg_orders_c69448b237b733942d7e821b1b94b4cb.sql
20:20:46.543991 [info ] [MainThread]: 
20:20:46.546269 [error] [MainThread]: [31mFailure in test customers_nb_orders_check (tests/customers_nb_orders_check.sql)[0m
20:20:46.548689 [error] [MainThread]:   Got 6 results, configured to fail if != 0
20:20:46.551215 [info ] [MainThread]: 
20:20:46.553267 [info ] [MainThread]:   compiled SQL at target/compiled/commerce/tests/customers_nb_orders_check.sql
20:20:46.557258 [info ] [MainThread]: 
20:20:46.559361 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
20:20:46.561766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab1e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab1ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fcab03070>]}


============================== 2024-07-21 20:23:22.197080 | 699be433-515a-4946-a408-df3f00b0534a ==============================
20:23:22.197080 [info ] [MainThread]: Running with dbt=1.0.0
20:23:22.198572 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:23:22.200682 [debug] [MainThread]: Tracking: tracking
20:23:22.207010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d4fbfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d474ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d474afa0>]}
20:23:22.417111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
20:23:22.418769 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:23:22.420060 [debug] [MainThread]: Partial parsing: updated file: commerce://tests/customers_nb_orders_check.sql
20:23:22.441787 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:23:22.581187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d55e7be0>]}
20:23:22.602372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d43eefa0>]}
20:23:22.604014 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:23:22.608949 [info ] [MainThread]: 
20:23:22.611270 [debug] [MainThread]: Acquiring new postgres connection "master"
20:23:22.615092 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:23:22.633813 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:23:22.636978 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:23:22.638758 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:23:22.648447 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:23:22.655732 [debug] [ThreadPool]: On list_dbt_database: Close
20:23:22.661899 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:23:22.667171 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:23:22.668499 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:23:22.670147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:23:22.676871 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:23:22.680398 [debug] [ThreadPool]: On list_dbt_database: Close
20:23:22.683788 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:23:22.696003 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:23:22.697465 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:23:22.698849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:23:22.704033 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:23:22.705385 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:23:22.706679 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:23:22.710909 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:23:22.714059 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:23:22.715572 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:23:22.717560 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:23:22.721065 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:23:22.722558 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:23:22.723917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:23:22.730330 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:23:22.731599 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:23:22.732867 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:23:22.736432 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:23:22.739896 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:23:22.741437 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:23:22.749939 [debug] [MainThread]: Using postgres connection "master"
20:23:22.751385 [debug] [MainThread]: On master: BEGIN
20:23:22.752734 [debug] [MainThread]: Opening a new connection, currently in state init
20:23:22.758300 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:23:22.759699 [debug] [MainThread]: Using postgres connection "master"
20:23:22.761123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:23:22.771070 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:23:22.773887 [debug] [MainThread]: On master: ROLLBACK
20:23:22.775394 [debug] [MainThread]: Using postgres connection "master"
20:23:22.776707 [debug] [MainThread]: On master: BEGIN
20:23:22.778893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:23:22.780162 [debug] [MainThread]: On master: COMMIT
20:23:22.781435 [debug] [MainThread]: Using postgres connection "master"
20:23:22.782622 [debug] [MainThread]: On master: COMMIT
20:23:22.784066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:23:22.785360 [debug] [MainThread]: On master: Close
20:23:22.787039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:23:22.788768 [info ] [MainThread]: 
20:23:22.796701 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:23:22.798291 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:23:22.800851 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:23:22.802603 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:23:22.803996 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:23:22.808484 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:23:22.820870 [debug] [Thread-1  ]: finished collecting timing info
20:23:22.822479 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:23:22.911458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:23:22.919139 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:23:22.920471 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:23:22.921463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:22.925594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:23:22.926743 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:23:22.928127 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:23:22.930537 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:23:22.940410 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:23:22.941457 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:23:22.942794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:23:22.953469 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:23:22.954560 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:23:22.955498 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:23:22.969938 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:23:22.977444 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:23:22.978611 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:23:22.979903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:23:22.982189 [debug] [Thread-1  ]: finished collecting timing info
20:23:22.983208 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:23:22.984556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d435eee0>]}
20:23:22.986841 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.18s]
20:23:22.988093 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:23:22.989869 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:23:22.991355 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:23:22.993218 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:23:22.995287 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:23:22.996443 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:23:23.000533 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:23:23.009425 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.010640 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:23:23.015849 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:23:23.024100 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:23:23.025214 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:23:23.026206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:23.032726 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:23.034225 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:23:23.035259 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:23:23.037734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:23:23.041430 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:23:23.042468 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:23:23.043994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:23:23.047756 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:23:23.048878 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:23:23.049861 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:23:23.058710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:23:23.073805 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:23:23.078597 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:23:23.084150 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:23:23.093414 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.096616 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:23:23.100011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d4358160>]}
20:23:23.102676 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.11s]
20:23:23.105167 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:23:23.109263 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:23:23.112474 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:23:23.115466 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:23:23.117390 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:23:23.119925 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:23:23.125282 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:23:23.136508 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.138172 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:23:23.141843 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:23:23.152900 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:23:23.154179 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:23:23.155308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:23.159684 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:23:23.161452 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:23:23.163084 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:23:23.166934 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:23:23.170795 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:23:23.171822 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:23:23.173208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:23:23.175591 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:23:23.176597 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:23:23.178820 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:23:23.181906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:23:23.184786 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:23:23.185808 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:23:23.187103 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:23:23.189579 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.190618 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:23:23.192021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d4249d90>]}
20:23:23.193522 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
20:23:23.195322 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:23:23.198133 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:23:23.199711 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:23:23.201624 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:23:23.203347 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:23:23.204450 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:23:23.209232 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:23:23.219191 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.220419 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:23:23.256939 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:23:23.265469 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.266703 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:23:23.267696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:23.271923 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:23:23.273016 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.273965 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:23:23.280274 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:23:23.285289 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.286374 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:23:23.287665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:23:23.291356 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.292497 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:23:23.293975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:23:23.302174 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:23:23.303424 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.304563 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:23:23.307138 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:23:23.310562 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:23:23.312093 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:23:23.315901 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:23:23.318509 [debug] [Thread-1  ]: finished collecting timing info
20:23:23.319813 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:23:23.321451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699be433-515a-4946-a408-df3f00b0534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d424bb20>]}
20:23:23.322982 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
20:23:23.324351 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:23:23.328050 [debug] [MainThread]: Acquiring new postgres connection "master"
20:23:23.329298 [debug] [MainThread]: Using postgres connection "master"
20:23:23.330316 [debug] [MainThread]: On master: BEGIN
20:23:23.331295 [debug] [MainThread]: Opening a new connection, currently in state closed
20:23:23.336045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:23:23.337334 [debug] [MainThread]: On master: COMMIT
20:23:23.338349 [debug] [MainThread]: Using postgres connection "master"
20:23:23.339515 [debug] [MainThread]: On master: COMMIT
20:23:23.341153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:23:23.342246 [debug] [MainThread]: On master: Close
20:23:23.343784 [info ] [MainThread]: 
20:23:23.345367 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.73s.
20:23:23.347886 [debug] [MainThread]: Connection 'master' was properly closed.
20:23:23.351004 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:23:23.373149 [info ] [MainThread]: 
20:23:23.374699 [info ] [MainThread]: [32mCompleted successfully[0m
20:23:23.376582 [info ] [MainThread]: 
20:23:23.379459 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:23:23.381867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d4287c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d4287bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76d3fde940>]}


============================== 2024-07-21 20:23:35.164937 | 9faaf489-cf92-4218-8765-521376a230df ==============================
20:23:35.164937 [info ] [MainThread]: Running with dbt=1.0.0
20:23:35.166624 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:23:35.169523 [debug] [MainThread]: Tracking: tracking
20:23:35.177663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf5fbe040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf574aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf574ac70>]}
20:23:35.386228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:23:35.387374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:23:35.398463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9faaf489-cf92-4218-8765-521376a230df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf53710d0>]}
20:23:35.418390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9faaf489-cf92-4218-8765-521376a230df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf53c1160>]}
20:23:35.420056 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:23:35.425492 [info ] [MainThread]: 
20:23:35.428074 [debug] [MainThread]: Acquiring new postgres connection "master"
20:23:35.432558 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:23:35.451534 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:23:35.452900 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:23:35.454182 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:23:35.460225 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:23:35.461611 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:23:35.463187 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:23:35.467414 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.470295 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:23:35.471697 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:23:35.473332 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:23:35.477429 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:23:35.479215 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:23:35.480383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:23:35.485127 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:23:35.486387 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:23:35.487462 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:23:35.490900 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:23:35.493766 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:23:35.495245 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:23:35.503445 [debug] [MainThread]: Using postgres connection "master"
20:23:35.504565 [debug] [MainThread]: On master: BEGIN
20:23:35.505429 [debug] [MainThread]: Opening a new connection, currently in state init
20:23:35.510776 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:23:35.511869 [debug] [MainThread]: Using postgres connection "master"
20:23:35.512927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:23:35.524799 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:23:35.528030 [debug] [MainThread]: On master: ROLLBACK
20:23:35.529617 [debug] [MainThread]: Using postgres connection "master"
20:23:35.530804 [debug] [MainThread]: On master: BEGIN
20:23:35.532244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:23:35.533394 [debug] [MainThread]: On master: COMMIT
20:23:35.534445 [debug] [MainThread]: Using postgres connection "master"
20:23:35.535530 [debug] [MainThread]: On master: COMMIT
20:23:35.536809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:23:35.537934 [debug] [MainThread]: On master: Close
20:23:35.539300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:23:35.540765 [info ] [MainThread]: 
20:23:35.547938 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:23:35.549165 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:23:35.550865 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:23:35.552385 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:23:35.553621 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:23:35.580937 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:23:35.591213 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.593962 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:23:35.635327 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:23:35.645983 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:23:35.647171 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:23:35.648605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:35.654194 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:35.655490 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:23:35.656691 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:23:35.660045 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.663997 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.665182 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:23:35.666381 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:23:35.667829 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.12s]
20:23:35.669549 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:23:35.671321 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:23:35.672548 [info ] [Thread-1  ]: 2 of 6 START test customers_nb_orders_check..................................... [RUN]
20:23:35.674311 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:23:35.676698 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:23:35.677828 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:23:35.681864 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:23:35.690378 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.693109 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:23:35.698987 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:23:35.707556 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:23:35.710200 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:23:35.711534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:35.718066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:35.719396 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:23:35.720511 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders > 1
      
    ) dbt_internal_test
20:23:35.722231 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.724793 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.726974 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:23:35.728668 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:23:35.730588 [error] [Thread-1  ]: 2 of 6 FAIL 29 customers_nb_orders_check........................................ [[31mFAIL 29[0m in 0.06s]
20:23:35.732156 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:23:35.734383 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:23:35.735622 [info ] [Thread-1  ]: 3 of 6 START test not_null_stg_customers_id..................................... [RUN]
20:23:35.737471 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:23:35.739220 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:23:35.740358 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:23:35.753529 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:23:35.764128 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.765722 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:23:35.803636 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:23:35.813991 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:23:35.815335 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:23:35.816464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:35.820743 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:23:35.821877 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:23:35.822828 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:23:35.824722 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.828021 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.829216 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:23:35.830379 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:23:35.831732 [info ] [Thread-1  ]: 3 of 6 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.09s]
20:23:35.833215 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:23:35.834843 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:23:35.835969 [info ] [Thread-1  ]: 4 of 6 START test not_null_stg_orders_order_id.................................. [RUN]
20:23:35.837716 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:23:35.839852 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:23:35.841002 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:23:35.849541 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:23:35.858011 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.860238 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:23:35.865225 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:23:35.874043 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:23:35.875502 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:23:35.877459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:35.883232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:35.884371 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:23:35.885333 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:23:35.887376 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.890027 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.891153 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:23:35.893326 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:23:35.895814 [info ] [Thread-1  ]: 4 of 6 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:23:35.897260 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:23:35.899010 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:23:35.900217 [info ] [Thread-1  ]: 5 of 6 START test unique_stg_customers_id....................................... [RUN]
20:23:35.901879 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:23:35.903399 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:23:35.904450 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:23:35.917665 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:23:35.926806 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.928489 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:23:35.932972 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:23:35.941603 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:23:35.943402 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:23:35.945433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:35.950841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:35.952003 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:23:35.952954 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:23:35.955051 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:35.957724 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.959151 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:23:35.961078 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:23:35.963612 [info ] [Thread-1  ]: 5 of 6 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.06s]
20:23:35.965080 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:23:35.967115 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:23:35.968405 [info ] [Thread-1  ]: 6 of 6 START test unique_stg_orders_order_id.................................... [RUN]
20:23:35.970116 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:23:35.971870 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:23:35.973032 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:23:35.981377 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:23:35.991081 [debug] [Thread-1  ]: finished collecting timing info
20:23:35.992393 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:23:35.997189 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:23:36.006203 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:23:36.007284 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:23:36.008196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:23:36.015153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:23:36.016173 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:23:36.017057 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:23:36.019270 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:23:36.021939 [debug] [Thread-1  ]: finished collecting timing info
20:23:36.022927 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:23:36.023968 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:23:36.025411 [info ] [Thread-1  ]: 6 of 6 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:23:36.027810 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:23:36.032333 [debug] [MainThread]: Acquiring new postgres connection "master"
20:23:36.033351 [debug] [MainThread]: Using postgres connection "master"
20:23:36.034430 [debug] [MainThread]: On master: BEGIN
20:23:36.035401 [debug] [MainThread]: Opening a new connection, currently in state closed
20:23:36.039818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:23:36.040873 [debug] [MainThread]: On master: COMMIT
20:23:36.041948 [debug] [MainThread]: Using postgres connection "master"
20:23:36.043349 [debug] [MainThread]: On master: COMMIT
20:23:36.044551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:23:36.045705 [debug] [MainThread]: On master: Close
20:23:36.046986 [info ] [MainThread]: 
20:23:36.048395 [info ] [MainThread]: Finished running 6 tests in 0.62s.
20:23:36.050233 [debug] [MainThread]: Connection 'master' was properly closed.
20:23:36.052076 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:23:36.069654 [info ] [MainThread]: 
20:23:36.071229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:23:36.073453 [info ] [MainThread]: 
20:23:36.077457 [error] [MainThread]: [31mFailure in test customers_nb_orders_check (tests/customers_nb_orders_check.sql)[0m
20:23:36.079334 [error] [MainThread]:   Got 29 results, configured to fail if != 0
20:23:36.081044 [info ] [MainThread]: 
20:23:36.084583 [info ] [MainThread]:   compiled SQL at target/compiled/commerce/tests/customers_nb_orders_check.sql
20:23:36.087020 [info ] [MainThread]: 
20:23:36.088750 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
20:23:36.094332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf5320100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf5320a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaf5303340>]}


============================== 2024-07-21 20:24:12.442842 | 6616b306-42ed-4ce4-a30b-e6982822352c ==============================
20:24:12.442842 [info ] [MainThread]: Running with dbt=1.0.0
20:24:12.444455 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:24:12.446812 [debug] [MainThread]: Tracking: tracking
20:24:12.454378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b7afe100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b74f2d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b74f2b20>]}
20:24:12.718764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:24:12.720891 [debug] [MainThread]: Partial parsing: updated file: commerce://tests/customers_nb_orders_check.sql
20:24:12.849586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6616b306-42ed-4ce4-a30b-e6982822352c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b71660d0>]}
20:24:12.873861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6616b306-42ed-4ce4-a30b-e6982822352c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b7481f10>]}
20:24:12.876368 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:24:12.884195 [info ] [MainThread]: 
20:24:12.886743 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:12.890647 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:24:12.913465 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:12.914747 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:24:12.916140 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:24:12.924226 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:24:12.925418 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:12.926615 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:24:12.929835 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:24:12.933582 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:24:12.935539 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:24:12.937278 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:24:12.940321 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:12.941371 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:24:12.942292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:24:12.946451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:24:12.947622 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:12.948915 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:24:12.952840 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:24:12.955200 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:24:12.956438 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:24:12.963983 [debug] [MainThread]: Using postgres connection "master"
20:24:12.965223 [debug] [MainThread]: On master: BEGIN
20:24:12.966731 [debug] [MainThread]: Opening a new connection, currently in state init
20:24:12.971055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:12.972166 [debug] [MainThread]: Using postgres connection "master"
20:24:12.973130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:24:12.979926 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:24:12.982650 [debug] [MainThread]: On master: ROLLBACK
20:24:12.983875 [debug] [MainThread]: Using postgres connection "master"
20:24:12.984876 [debug] [MainThread]: On master: BEGIN
20:24:12.986158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:12.987295 [debug] [MainThread]: On master: COMMIT
20:24:12.988253 [debug] [MainThread]: Using postgres connection "master"
20:24:12.989195 [debug] [MainThread]: On master: COMMIT
20:24:12.990294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:12.991301 [debug] [MainThread]: On master: Close
20:24:12.992633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:24:12.994014 [info ] [MainThread]: 
20:24:13.001622 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:13.002780 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:24:13.004466 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:13.006029 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:13.007137 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:13.066556 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:13.074570 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.075833 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:13.105375 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:13.114366 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:13.116058 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:24:13.117566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.122502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:13.123963 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:13.125307 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:24:13.127126 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.stg_orders" does not exist
LINE 17:     from "dbt_database"."staging"."stg_orders"
                  ^

20:24:13.128313 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:24:13.129703 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.130824 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:24:13.132620 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped (models/staging/stg_commerce.yml)
  relation "staging.stg_orders" does not exist
  LINE 17:     from "dbt_database"."staging"."stg_orders"
                    ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/accepted_values_stg_orders_d0172379077f91c5b2787eef701d7a3e.sql
20:24:13.134066 [error] [Thread-1  ]: 1 of 6 ERROR accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[31mERROR[0m in 0.13s]
20:24:13.135576 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:13.137496 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:24:13.139313 [info ] [Thread-1  ]: 2 of 6 START test customers_nb_orders_check..................................... [RUN]
20:24:13.141887 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:24:13.143843 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:24:13.144974 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:24:13.149119 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:24:13.159069 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.160502 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:24:13.164083 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:24:13.174073 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:24:13.175245 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:24:13.176481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.180760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:13.182055 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:24:13.183834 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:24:13.186393 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:13.190655 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.191718 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:24:13.192833 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:24:13.194199 [info ] [Thread-1  ]: 2 of 6 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.05s]
20:24:13.195689 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:24:13.197508 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:13.199423 [info ] [Thread-1  ]: 3 of 6 START test not_null_stg_customers_id..................................... [RUN]
20:24:13.203064 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:13.205279 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:13.206560 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:13.218299 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:13.228397 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.229614 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:13.234682 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:13.244207 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:13.245502 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:24:13.246352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.252140 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:13.253608 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:13.255528 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:24:13.257090 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.stg_customers" does not exist
LINE 12: from "dbt_database"."staging"."stg_customers"
              ^

20:24:13.258169 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:24:13.259350 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.260375 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:24:13.261695 [debug] [Thread-1  ]: Database Error in test not_null_stg_customers_id (models/staging/stg_commerce.yml)
  relation "staging.stg_customers" does not exist
  LINE 12: from "dbt_database"."staging"."stg_customers"
                ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/not_null_stg_customers_id.sql
20:24:13.263141 [error] [Thread-1  ]: 3 of 6 ERROR not_null_stg_customers_id.......................................... [[31mERROR[0m in 0.06s]
20:24:13.264493 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:13.267174 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:13.269276 [info ] [Thread-1  ]: 4 of 6 START test not_null_stg_orders_order_id.................................. [RUN]
20:24:13.271555 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:13.273101 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:13.274164 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:13.280217 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:13.291769 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.292971 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:13.296601 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:13.308144 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:13.309429 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:24:13.310361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.314527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:13.316570 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:13.318082 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:24:13.320133 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.stg_orders" does not exist
LINE 12: from "dbt_database"."staging"."stg_orders"
              ^

20:24:13.321226 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:24:13.322418 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.323426 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:24:13.324675 [debug] [Thread-1  ]: Database Error in test not_null_stg_orders_order_id (models/staging/stg_commerce.yml)
  relation "staging.stg_orders" does not exist
  LINE 12: from "dbt_database"."staging"."stg_orders"
                ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/not_null_stg_orders_order_id.sql
20:24:13.326183 [error] [Thread-1  ]: 4 of 6 ERROR not_null_stg_orders_order_id....................................... [[31mERROR[0m in 0.05s]
20:24:13.327545 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:13.329214 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:13.330605 [info ] [Thread-1  ]: 5 of 6 START test unique_stg_customers_id....................................... [RUN]
20:24:13.333049 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:13.334524 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:13.335642 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:24:13.345978 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:13.355835 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.357403 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:13.360671 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:13.370439 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:13.372096 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:24:13.373072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.377152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:13.378280 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:13.379216 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:24:13.380588 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.stg_customers" does not exist
LINE 15: from "dbt_database"."staging"."stg_customers"
              ^

20:24:13.381844 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:24:13.384168 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.386591 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:24:13.388456 [debug] [Thread-1  ]: Database Error in test unique_stg_customers_id (models/staging/stg_commerce.yml)
  relation "staging.stg_customers" does not exist
  LINE 15: from "dbt_database"."staging"."stg_customers"
                ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/unique_stg_customers_id.sql
20:24:13.390060 [error] [Thread-1  ]: 5 of 6 ERROR unique_stg_customers_id............................................ [[31mERROR[0m in 0.06s]
20:24:13.391632 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:13.393304 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:13.394905 [info ] [Thread-1  ]: 6 of 6 START test unique_stg_orders_order_id.................................... [RUN]
20:24:13.397004 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:13.399580 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:13.401157 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:13.409019 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:13.420342 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.422385 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:13.427201 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:13.438775 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:13.440143 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:24:13.441120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:13.445332 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:13.446538 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:13.447467 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:24:13.449718 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging.stg_orders" does not exist
LINE 15: from "dbt_database"."staging"."stg_orders"
              ^

20:24:13.451161 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:24:13.453459 [debug] [Thread-1  ]: finished collecting timing info
20:24:13.454537 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:24:13.455810 [debug] [Thread-1  ]: Database Error in test unique_stg_orders_order_id (models/staging/stg_commerce.yml)
  relation "staging.stg_orders" does not exist
  LINE 15: from "dbt_database"."staging"."stg_orders"
                ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/unique_stg_orders_order_id.sql
20:24:13.457219 [error] [Thread-1  ]: 6 of 6 ERROR unique_stg_orders_order_id......................................... [[31mERROR[0m in 0.06s]
20:24:13.458532 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:13.462080 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:13.463317 [debug] [MainThread]: Using postgres connection "master"
20:24:13.464527 [debug] [MainThread]: On master: BEGIN
20:24:13.466414 [debug] [MainThread]: Opening a new connection, currently in state closed
20:24:13.471093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:13.472181 [debug] [MainThread]: On master: COMMIT
20:24:13.473125 [debug] [MainThread]: Using postgres connection "master"
20:24:13.474053 [debug] [MainThread]: On master: COMMIT
20:24:13.475125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:13.476185 [debug] [MainThread]: On master: Close
20:24:13.477543 [info ] [MainThread]: 
20:24:13.479486 [info ] [MainThread]: Finished running 6 tests in 0.59s.
20:24:13.481525 [debug] [MainThread]: Connection 'master' was properly closed.
20:24:13.483430 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:24:13.505013 [info ] [MainThread]: 
20:24:13.506676 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
20:24:13.508970 [info ] [MainThread]: 
20:24:13.512383 [error] [MainThread]: [33mDatabase Error in test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped (models/staging/stg_commerce.yml)[0m
20:24:13.518187 [error] [MainThread]:   relation "staging.stg_orders" does not exist
20:24:13.522627 [error] [MainThread]:   LINE 17:     from "dbt_database"."staging"."stg_orders"
20:24:13.524879 [error] [MainThread]:                     ^
20:24:13.526673 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/accepted_values_stg_orders_d0172379077f91c5b2787eef701d7a3e.sql
20:24:13.528553 [info ] [MainThread]: 
20:24:13.531012 [error] [MainThread]: [33mDatabase Error in test not_null_stg_customers_id (models/staging/stg_commerce.yml)[0m
20:24:13.533894 [error] [MainThread]:   relation "staging.stg_customers" does not exist
20:24:13.536045 [error] [MainThread]:   LINE 12: from "dbt_database"."staging"."stg_customers"
20:24:13.538309 [error] [MainThread]:                 ^
20:24:13.542360 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/not_null_stg_customers_id.sql
20:24:13.544126 [info ] [MainThread]: 
20:24:13.546229 [error] [MainThread]: [33mDatabase Error in test not_null_stg_orders_order_id (models/staging/stg_commerce.yml)[0m
20:24:13.547870 [error] [MainThread]:   relation "staging.stg_orders" does not exist
20:24:13.550488 [error] [MainThread]:   LINE 12: from "dbt_database"."staging"."stg_orders"
20:24:13.552688 [error] [MainThread]:                 ^
20:24:13.556436 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/not_null_stg_orders_order_id.sql
20:24:13.558975 [info ] [MainThread]: 
20:24:13.560889 [error] [MainThread]: [33mDatabase Error in test unique_stg_customers_id (models/staging/stg_commerce.yml)[0m
20:24:13.562894 [error] [MainThread]:   relation "staging.stg_customers" does not exist
20:24:13.564737 [error] [MainThread]:   LINE 15: from "dbt_database"."staging"."stg_customers"
20:24:13.567854 [error] [MainThread]:                 ^
20:24:13.569872 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/unique_stg_customers_id.sql
20:24:13.574419 [info ] [MainThread]: 
20:24:13.576198 [error] [MainThread]: [33mDatabase Error in test unique_stg_orders_order_id (models/staging/stg_commerce.yml)[0m
20:24:13.577966 [error] [MainThread]:   relation "staging.stg_orders" does not exist
20:24:13.579871 [error] [MainThread]:   LINE 15: from "dbt_database"."staging"."stg_orders"
20:24:13.581579 [error] [MainThread]:                 ^
20:24:13.584617 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/unique_stg_orders_order_id.sql
20:24:13.587260 [info ] [MainThread]: 
20:24:13.591334 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=0 TOTAL=6
20:24:13.594922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b71f39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b71f3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45b6da6ac0>]}


============================== 2024-07-21 20:24:26.965876 | 2a460275-4207-4751-8cd7-2a9d7e250c38 ==============================
20:24:26.965876 [info ] [MainThread]: Running with dbt=1.0.0
20:24:26.968210 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:24:26.970463 [debug] [MainThread]: Tracking: tracking
20:24:26.976608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af057f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef9c0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef9c0580>]}
20:24:27.197960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:24:27.199296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:24:27.210763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef8f10d0>]}
20:24:27.232877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef940160>]}
20:24:27.235161 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:24:27.241354 [info ] [MainThread]: 
20:24:27.243931 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:27.248121 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:24:27.269413 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:24:27.271151 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:24:27.272894 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:24:27.280231 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:24:27.284876 [debug] [ThreadPool]: On list_dbt_database: Close
20:24:27.287329 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:24:27.291040 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:24:27.292343 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:24:27.293518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:24:27.301023 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:24:27.303869 [debug] [ThreadPool]: On list_dbt_database: Close
20:24:27.307054 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:24:27.318673 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:27.319785 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:24:27.321040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:24:27.325761 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:24:27.326973 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:27.328234 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:24:27.331764 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:24:27.334346 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:24:27.335837 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:24:27.337765 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:24:27.340940 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:27.342018 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:24:27.343138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:24:27.348013 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:24:27.349577 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:27.350828 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:24:27.354241 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:24:27.356760 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:24:27.358371 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:24:27.366408 [debug] [MainThread]: Using postgres connection "master"
20:24:27.367735 [debug] [MainThread]: On master: BEGIN
20:24:27.368885 [debug] [MainThread]: Opening a new connection, currently in state init
20:24:27.373363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:27.374932 [debug] [MainThread]: Using postgres connection "master"
20:24:27.376340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:24:27.383899 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:24:27.386592 [debug] [MainThread]: On master: ROLLBACK
20:24:27.387939 [debug] [MainThread]: Using postgres connection "master"
20:24:27.389258 [debug] [MainThread]: On master: BEGIN
20:24:27.390716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:27.391965 [debug] [MainThread]: On master: COMMIT
20:24:27.392955 [debug] [MainThread]: Using postgres connection "master"
20:24:27.393898 [debug] [MainThread]: On master: COMMIT
20:24:27.395335 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:27.396716 [debug] [MainThread]: On master: Close
20:24:27.398099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:24:27.399558 [info ] [MainThread]: 
20:24:27.405925 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:24:27.407337 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:24:27.409186 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:24:27.411026 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:24:27.412134 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:24:27.418662 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:24:27.427153 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.428356 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:24:27.476692 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:24:27.488853 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:24:27.490691 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:24:27.491849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:27.497372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:27.498489 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:24:27.499429 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:24:27.501882 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:24:27.513470 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:24:27.515201 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:24:27.517028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:24:27.531959 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:24:27.533327 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:24:27.534572 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:24:27.537536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:24:27.547543 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:24:27.548604 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:24:27.549804 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:24:27.552016 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.552997 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:24:27.554346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef5cf820>]}
20:24:27.555832 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.15s]
20:24:27.557380 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:24:27.559587 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:24:27.561092 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:24:27.563014 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:24:27.564792 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:24:27.566245 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:24:27.603821 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:24:27.611560 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.613049 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:24:27.618721 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:24:27.627263 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:24:27.628503 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:24:27.629962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:27.635264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:27.636480 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:24:27.637382 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:24:27.639736 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:24:27.643295 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:24:27.644453 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:24:27.645848 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:24:27.648408 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:24:27.649506 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:24:27.650417 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:24:27.652785 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:24:27.655696 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:24:27.656771 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:24:27.658109 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:24:27.660494 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.661538 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:24:27.662990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2af0baef70>]}
20:24:27.664999 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.10s]
20:24:27.666493 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:24:27.669208 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:24:27.670533 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:24:27.672217 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:24:27.673903 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:24:27.675075 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:24:27.680323 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:24:27.690566 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.691635 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:24:27.695139 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:24:27.705447 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:24:27.706601 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:24:27.707442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:27.711526 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:27.713116 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:24:27.714715 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:24:27.718465 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:24:27.722244 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:24:27.723187 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:24:27.724419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:24:27.726854 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:24:27.727972 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:24:27.728856 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:24:27.732381 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:24:27.735436 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:24:27.736416 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:24:27.737613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:24:27.739957 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.740942 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:24:27.742269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef8614c0>]}
20:24:27.743831 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.07s]
20:24:27.745362 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:24:27.749089 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:24:27.750542 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:24:27.752361 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:24:27.754018 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:24:27.754994 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:24:27.759679 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:24:27.767757 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.769663 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:24:27.808091 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:24:27.815849 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.816996 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:24:27.817955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:27.822258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:27.823259 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.824133 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:24:27.830070 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:24:27.834021 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.834993 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:24:27.836277 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:24:27.840260 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.841354 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:24:27.842624 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:24:27.851106 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:24:27.852186 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.853305 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:24:27.855655 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:24:27.860119 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:24:27.861336 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:24:27.864654 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:24:27.867068 [debug] [Thread-1  ]: finished collecting timing info
20:24:27.868167 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:24:27.869760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a460275-4207-4751-8cd7-2a9d7e250c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef599af0>]}
20:24:27.871174 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
20:24:27.872456 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:24:27.875649 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:27.876876 [debug] [MainThread]: Using postgres connection "master"
20:24:27.878048 [debug] [MainThread]: On master: BEGIN
20:24:27.879173 [debug] [MainThread]: Opening a new connection, currently in state closed
20:24:27.884112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:27.886101 [debug] [MainThread]: On master: COMMIT
20:24:27.887064 [debug] [MainThread]: Using postgres connection "master"
20:24:27.889017 [debug] [MainThread]: On master: COMMIT
20:24:27.890214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:27.891521 [debug] [MainThread]: On master: Close
20:24:27.893044 [info ] [MainThread]: 
20:24:27.894451 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.65s.
20:24:27.896504 [debug] [MainThread]: Connection 'master' was properly closed.
20:24:27.898705 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:24:27.918687 [info ] [MainThread]: 
20:24:27.920097 [info ] [MainThread]: [32mCompleted successfully[0m
20:24:27.921906 [info ] [MainThread]: 
20:24:27.924541 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:24:27.926997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef899490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef899760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aef5cb6a0>]}


============================== 2024-07-21 20:24:34.159415 | 51a67dc5-7591-4899-ad48-41019af8162d ==============================
20:24:34.159415 [info ] [MainThread]: Running with dbt=1.0.0
20:24:34.161246 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:24:34.165717 [debug] [MainThread]: Tracking: tracking
20:24:34.172168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cc94fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cc94fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cc94fd60>]}
20:24:34.397495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:24:34.398765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:24:34.409929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a67dc5-7591-4899-ad48-41019af8162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbcef0a0>]}
20:24:34.432701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a67dc5-7591-4899-ad48-41019af8162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbd470a0>]}
20:24:34.434403 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:24:34.440686 [info ] [MainThread]: 
20:24:34.443201 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:34.448155 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:24:34.470449 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:34.471808 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:24:34.472802 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:24:34.478415 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:24:34.480343 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:24:34.481921 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:24:34.486542 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:24:34.489370 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:24:34.490916 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:24:34.492644 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:24:34.497033 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:34.499395 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:24:34.500387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:24:34.504773 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:24:34.506111 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:24:34.507210 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:24:34.510319 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:24:34.513700 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:24:34.515127 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:24:34.523845 [debug] [MainThread]: Using postgres connection "master"
20:24:34.525048 [debug] [MainThread]: On master: BEGIN
20:24:34.526080 [debug] [MainThread]: Opening a new connection, currently in state init
20:24:34.531013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:34.532245 [debug] [MainThread]: Using postgres connection "master"
20:24:34.533213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:24:34.546594 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:24:34.549682 [debug] [MainThread]: On master: ROLLBACK
20:24:34.551365 [debug] [MainThread]: Using postgres connection "master"
20:24:34.552547 [debug] [MainThread]: On master: BEGIN
20:24:34.554248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:34.555527 [debug] [MainThread]: On master: COMMIT
20:24:34.556686 [debug] [MainThread]: Using postgres connection "master"
20:24:34.557899 [debug] [MainThread]: On master: COMMIT
20:24:34.559178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:34.560390 [debug] [MainThread]: On master: Close
20:24:34.562161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:24:34.564576 [info ] [MainThread]: 
20:24:34.571899 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:34.573088 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:24:34.574850 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:34.576471 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:34.577769 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:34.609782 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:34.623563 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.624985 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:34.657006 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:34.669320 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:34.670546 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:24:34.671762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:34.676860 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:34.678099 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:24:34.679842 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:24:34.682615 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:34.686346 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.687578 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:24:34.688869 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:24:34.690537 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.12s]
20:24:34.692142 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:24:34.694047 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:24:34.695552 [info ] [Thread-1  ]: 2 of 6 START test customers_nb_orders_check..................................... [RUN]
20:24:34.697553 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:24:34.699927 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:24:34.701324 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:24:34.706011 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:24:34.718245 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.719570 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:24:34.723003 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:24:34.734593 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:24:34.736172 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:24:34.737223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:34.742273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:34.743427 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:24:34.744513 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:24:34.747505 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:34.751215 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.752487 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:24:34.753734 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:24:34.755494 [info ] [Thread-1  ]: 2 of 6 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.06s]
20:24:34.757140 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:24:34.759619 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:34.760913 [info ] [Thread-1  ]: 3 of 6 START test not_null_stg_customers_id..................................... [RUN]
20:24:34.764223 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:34.766138 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:34.767485 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:34.780864 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:34.792137 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.793487 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:34.832625 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:34.841906 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:34.843369 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:24:34.844564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:34.849390 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:34.850713 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:24:34.851776 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:24:34.853752 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:34.856622 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.857876 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:24:34.859253 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:24:34.861019 [info ] [Thread-1  ]: 3 of 6 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.10s]
20:24:34.863450 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:24:34.866238 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:34.867563 [info ] [Thread-1  ]: 4 of 6 START test not_null_stg_orders_order_id.................................. [RUN]
20:24:34.869707 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:34.871186 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:34.872688 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:34.880764 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:34.893125 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.894678 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:34.900327 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:34.911616 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:34.913773 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:24:34.915395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:34.921443 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:34.922583 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:24:34.923888 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:24:34.926236 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:34.929657 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.931054 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:24:34.932317 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:24:34.933728 [info ] [Thread-1  ]: 4 of 6 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:24:34.935413 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:24:34.937249 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:34.938821 [info ] [Thread-1  ]: 5 of 6 START test unique_stg_customers_id....................................... [RUN]
20:24:34.940861 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:34.942826 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:34.943940 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:24:34.957817 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:34.969997 [debug] [Thread-1  ]: finished collecting timing info
20:24:34.971428 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:34.974859 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:34.987485 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:34.988677 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:24:34.989910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:34.994321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:24:34.995968 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:24:34.997947 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:24:35.000830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:35.003597 [debug] [Thread-1  ]: finished collecting timing info
20:24:35.004908 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:24:35.006180 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:24:35.007564 [info ] [Thread-1  ]: 5 of 6 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.07s]
20:24:35.009268 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:24:35.011310 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:35.013932 [info ] [Thread-1  ]: 6 of 6 START test unique_stg_orders_order_id.................................... [RUN]
20:24:35.015839 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:35.017561 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:35.018825 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:35.024936 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:35.038494 [debug] [Thread-1  ]: finished collecting timing info
20:24:35.040036 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:35.043142 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:35.056324 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:35.057492 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:24:35.058330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:24:35.063509 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:24:35.064940 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:24:35.066479 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:24:35.069897 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:24:35.072853 [debug] [Thread-1  ]: finished collecting timing info
20:24:35.073962 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:24:35.075359 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:24:35.076945 [info ] [Thread-1  ]: 6 of 6 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:24:35.078719 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:24:35.083962 [debug] [MainThread]: Acquiring new postgres connection "master"
20:24:35.085391 [debug] [MainThread]: Using postgres connection "master"
20:24:35.086575 [debug] [MainThread]: On master: BEGIN
20:24:35.087528 [debug] [MainThread]: Opening a new connection, currently in state closed
20:24:35.092133 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:24:35.094057 [debug] [MainThread]: On master: COMMIT
20:24:35.095449 [debug] [MainThread]: Using postgres connection "master"
20:24:35.097325 [debug] [MainThread]: On master: COMMIT
20:24:35.098982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:24:35.101313 [debug] [MainThread]: On master: Close
20:24:35.103213 [info ] [MainThread]: 
20:24:35.105810 [info ] [MainThread]: Finished running 6 tests in 0.66s.
20:24:35.108023 [debug] [MainThread]: Connection 'master' was properly closed.
20:24:35.109969 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:24:35.132280 [info ] [MainThread]: 
20:24:35.135452 [info ] [MainThread]: [32mCompleted successfully[0m
20:24:35.137913 [info ] [MainThread]: 
20:24:35.141716 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
20:24:35.144415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbca00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbca09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cbc8cfa0>]}


============================== 2024-07-21 20:26:58.576405 | d8976c67-2f11-4269-abe3-3bad6a0f2118 ==============================
20:26:58.576405 [info ] [MainThread]: Running with dbt=1.0.0
20:26:58.580147 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:26:58.582849 [debug] [MainThread]: Tracking: tracking
20:26:58.589087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1f45b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1f45340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1f45730>]}
20:26:58.803260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:26:58.805032 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:26:58.826348 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:26:58.932582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1a9a0d0>]}
20:26:58.955105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1ac5640>]}
20:26:58.957093 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:26:58.964351 [info ] [MainThread]: 
20:26:58.966592 [debug] [MainThread]: Acquiring new postgres connection "master"
20:26:58.970014 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:26:59.019841 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:26:59.021341 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:26:59.022672 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:26:59.029401 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:26:59.032226 [debug] [ThreadPool]: On list_dbt_database: Close
20:26:59.034070 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:26:59.037202 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:26:59.038599 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:26:59.039902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:26:59.045659 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:26:59.048353 [debug] [ThreadPool]: On list_dbt_database: Close
20:26:59.051533 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:26:59.061611 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:26:59.062904 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:26:59.064138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:26:59.068942 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:26:59.070295 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:26:59.071536 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:26:59.075020 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:26:59.077896 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:26:59.079367 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:26:59.081253 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:26:59.084455 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:26:59.085829 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:26:59.087076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:26:59.091901 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:26:59.093269 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:26:59.094680 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:26:59.098630 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:26:59.101238 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:26:59.102790 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:26:59.111278 [debug] [MainThread]: Using postgres connection "master"
20:26:59.112608 [debug] [MainThread]: On master: BEGIN
20:26:59.113724 [debug] [MainThread]: Opening a new connection, currently in state init
20:26:59.118665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:26:59.120070 [debug] [MainThread]: Using postgres connection "master"
20:26:59.121253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:26:59.128496 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:26:59.131312 [debug] [MainThread]: On master: ROLLBACK
20:26:59.132880 [debug] [MainThread]: Using postgres connection "master"
20:26:59.134195 [debug] [MainThread]: On master: BEGIN
20:26:59.135863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:26:59.137188 [debug] [MainThread]: On master: COMMIT
20:26:59.138448 [debug] [MainThread]: Using postgres connection "master"
20:26:59.139779 [debug] [MainThread]: On master: COMMIT
20:26:59.141259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:26:59.142523 [debug] [MainThread]: On master: Close
20:26:59.144073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:26:59.146013 [info ] [MainThread]: 
20:26:59.152663 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:26:59.154146 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:26:59.156024 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:26:59.157783 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:26:59.159228 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:26:59.165039 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:26:59.175257 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.177700 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:26:59.219245 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:26:59.230178 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:26:59.231298 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:26:59.232598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:59.237225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:26:59.238596 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:26:59.239790 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:26:59.242242 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:26:59.251992 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:26:59.253404 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:26:59.255033 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:26:59.266016 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:26:59.267355 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:26:59.268584 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:26:59.272543 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:26:59.280336 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:26:59.281579 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:26:59.282959 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:26:59.285709 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.287041 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:26:59.288823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1a85fa0>]}
20:26:59.290493 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
20:26:59.292107 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:26:59.293845 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:26:59.295960 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:26:59.297833 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:26:59.299750 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:26:59.300951 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:26:59.306928 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:26:59.318901 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.320147 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:26:59.324002 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:26:59.337217 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:26:59.338406 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:26:59.339480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:59.344399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:26:59.346190 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:26:59.347773 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:26:59.351373 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:26:59.355321 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:26:59.356669 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:26:59.358334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:26:59.362018 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:26:59.363602 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:26:59.365341 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:26:59.368786 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:26:59.372219 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:26:59.373526 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:26:59.375164 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:26:59.378296 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.379716 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:26:59.381412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1fa0190>]}
20:26:59.382850 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
20:26:59.384385 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:26:59.387041 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:26:59.388597 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:26:59.390448 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:26:59.391969 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:26:59.393557 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:26:59.400758 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:26:59.412614 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.415068 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:26:59.419841 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:26:59.433700 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:26:59.435035 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:26:59.436291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:59.441192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:26:59.442630 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:26:59.443967 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:26:59.448243 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:26:59.452288 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:26:59.453643 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:26:59.455475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:26:59.458213 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:26:59.459555 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:26:59.461091 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:26:59.464921 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:26:59.468401 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:26:59.469758 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:26:59.472028 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:26:59.475182 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.476556 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:26:59.478896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1abdd90>]}
20:26:59.480861 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.09s]
20:26:59.482556 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:26:59.485720 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:26:59.487547 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:26:59.490165 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:26:59.493145 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:26:59.495636 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:26:59.505455 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:26:59.519553 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.521029 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:26:59.577564 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:26:59.585320 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.586515 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:26:59.587571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:26:59.591845 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:26:59.592918 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.593951 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:26:59.601317 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:26:59.605377 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.606428 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:26:59.607770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:26:59.612041 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.613096 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:26:59.614341 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:26:59.622430 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:26:59.623491 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.624466 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:26:59.626734 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:26:59.629943 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:26:59.631019 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:26:59.634105 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:26:59.636445 [debug] [Thread-1  ]: finished collecting timing info
20:26:59.637544 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:26:59.639012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8976c67-2f11-4269-abe3-3bad6a0f2118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1a66f40>]}
20:26:59.640483 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.15s]
20:26:59.641730 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:26:59.645586 [debug] [MainThread]: Acquiring new postgres connection "master"
20:26:59.647133 [debug] [MainThread]: Using postgres connection "master"
20:26:59.648275 [debug] [MainThread]: On master: BEGIN
20:26:59.649378 [debug] [MainThread]: Opening a new connection, currently in state closed
20:26:59.653885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:26:59.655017 [debug] [MainThread]: On master: COMMIT
20:26:59.655954 [debug] [MainThread]: Using postgres connection "master"
20:26:59.656954 [debug] [MainThread]: On master: COMMIT
20:26:59.658154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:26:59.659575 [debug] [MainThread]: On master: Close
20:26:59.661740 [info ] [MainThread]: 
20:26:59.664345 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.70s.
20:26:59.667322 [debug] [MainThread]: Connection 'master' was properly closed.
20:26:59.668963 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:26:59.692553 [info ] [MainThread]: 
20:26:59.694461 [info ] [MainThread]: [32mCompleted successfully[0m
20:26:59.696859 [info ] [MainThread]: 
20:26:59.701954 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:26:59.704270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1a9c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da1a9cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6da17cb040>]}


============================== 2024-07-21 20:27:10.849649 | e09c4fd2-8fea-41a5-bdf6-595c6db7c0d7 ==============================
20:27:10.849649 [info ] [MainThread]: Running with dbt=1.0.0
20:27:10.851127 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:27:10.853628 [debug] [MainThread]: Tracking: tracking
20:27:10.859734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79644f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79644f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79644fca0>]}
20:27:11.173318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:27:11.174476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:27:11.185592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e09c4fd2-8fea-41a5-bdf6-595c6db7c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb795b310d0>]}
20:27:11.205329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e09c4fd2-8fea-41a5-bdf6-595c6db7c0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb795b81310>]}
20:27:11.207177 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:27:11.213680 [info ] [MainThread]: 
20:27:11.215910 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:11.219917 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:27:11.237556 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:11.238670 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:27:11.239625 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:27:11.245303 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:27:11.247043 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:11.248904 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:27:11.252079 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:27:11.254981 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:27:11.256180 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:27:11.257846 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:27:11.261793 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:11.263386 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:27:11.265258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:11.269478 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:27:11.270518 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:11.271499 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:27:11.274595 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.278260 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:27:11.280089 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:27:11.287506 [debug] [MainThread]: Using postgres connection "master"
20:27:11.288592 [debug] [MainThread]: On master: BEGIN
20:27:11.289546 [debug] [MainThread]: Opening a new connection, currently in state init
20:27:11.295015 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:11.299647 [debug] [MainThread]: Using postgres connection "master"
20:27:11.301345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:27:11.316224 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:27:11.318874 [debug] [MainThread]: On master: ROLLBACK
20:27:11.320112 [debug] [MainThread]: Using postgres connection "master"
20:27:11.321138 [debug] [MainThread]: On master: BEGIN
20:27:11.322737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:11.323823 [debug] [MainThread]: On master: COMMIT
20:27:11.324809 [debug] [MainThread]: Using postgres connection "master"
20:27:11.325718 [debug] [MainThread]: On master: COMMIT
20:27:11.327055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:11.328190 [debug] [MainThread]: On master: Close
20:27:11.329460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:27:11.330783 [info ] [MainThread]: 
20:27:11.337520 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:11.338698 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:27:11.340416 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:11.341965 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:11.343362 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:11.370678 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:11.383559 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.385110 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:11.416394 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:11.426809 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:11.428063 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:27:11.429159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.433365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:11.434506 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:11.435446 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:27:11.437983 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.441556 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.442852 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:27:11.444466 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:27:11.446413 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.11s]
20:27:11.447990 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:11.449743 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:27:11.450883 [info ] [Thread-1  ]: 2 of 7 START test customers_nb_orders_check..................................... [RUN]
20:27:11.452555 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:27:11.454292 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:27:11.455475 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:27:11.460083 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:27:11.469126 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.470683 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:27:11.474837 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:27:11.485894 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:27:11.487584 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:27:11.488697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.493786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:11.495336 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:27:11.496856 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:27:11.499813 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.502640 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.503924 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:27:11.505209 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:27:11.506855 [info ] [Thread-1  ]: 2 of 7 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.05s]
20:27:11.508591 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:27:11.511236 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:11.513318 [info ] [Thread-1  ]: 3 of 7 START test not_null_stg_customers_id..................................... [RUN]
20:27:11.515496 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:11.516990 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:11.518309 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:11.564833 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:11.574344 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.575789 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:11.579554 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:11.589730 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:11.590911 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:27:11.592038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.597180 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:11.598399 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:11.599476 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:27:11.601538 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.604262 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.605495 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:27:11.606769 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:27:11.608395 [info ] [Thread-1  ]: 3 of 7 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.09s]
20:27:11.610836 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:11.612567 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:11.613904 [info ] [Thread-1  ]: 4 of 7 START test not_null_stg_orders_order_id.................................. [RUN]
20:27:11.615700 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:11.617685 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:11.618829 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:11.624928 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:11.637386 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.638739 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:11.642299 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:11.655027 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:11.656291 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:27:11.657424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.663219 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:11.665414 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:11.666516 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:27:11.668536 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.671251 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.672423 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:27:11.673750 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:27:11.675295 [info ] [Thread-1  ]: 4 of 7 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:27:11.678346 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:11.681555 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:27:11.682952 [info ] [Thread-1  ]: 5 of 7 START test relationships_stg_orders_customer_id__id__ref_stg_customers_.. [RUN]
20:27:11.684783 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:27:11.686431 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:27:11.687582 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:27:11.701737 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:27:11.714104 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.716476 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:27:11.720769 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:27:11.733282 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:27:11.734716 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: BEGIN
20:27:11.735896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.741203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:11.742598 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:27:11.744553 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_database"."staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select id as to_field
    from "dbt_database"."staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
20:27:11.747379 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.750125 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.751268 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: ROLLBACK
20:27:11.752530 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: Close
20:27:11.754062 [info ] [Thread-1  ]: 5 of 7 PASS relationships_stg_orders_customer_id__id__ref_stg_customers_........ [[32mPASS[0m in 0.07s]
20:27:11.756079 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:27:11.757923 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:11.759160 [info ] [Thread-1  ]: 6 of 7 START test unique_stg_customers_id....................................... [RUN]
20:27:11.761591 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:11.763438 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:11.764479 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:27:11.774520 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:11.786011 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.787866 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:11.791512 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:11.802603 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:11.803743 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:27:11.804876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.809411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:11.811161 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:11.812701 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:27:11.815307 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.818052 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.819132 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:27:11.820253 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:27:11.821736 [info ] [Thread-1  ]: 6 of 7 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.06s]
20:27:11.823257 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:11.824945 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:11.826293 [info ] [Thread-1  ]: 7 of 7 START test unique_stg_orders_order_id.................................... [RUN]
20:27:11.828492 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:11.830281 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:11.831546 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:11.837540 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:11.848980 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.850187 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:11.853110 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:11.863177 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:11.866389 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:27:11.867364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:11.871764 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:11.872870 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:11.873801 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:27:11.876070 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:11.880962 [debug] [Thread-1  ]: finished collecting timing info
20:27:11.882358 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:27:11.883511 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:27:11.884901 [info ] [Thread-1  ]: 7 of 7 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:27:11.886362 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:11.889611 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:11.890927 [debug] [MainThread]: Using postgres connection "master"
20:27:11.891982 [debug] [MainThread]: On master: BEGIN
20:27:11.894035 [debug] [MainThread]: Opening a new connection, currently in state closed
20:27:11.900328 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:11.901567 [debug] [MainThread]: On master: COMMIT
20:27:11.902540 [debug] [MainThread]: Using postgres connection "master"
20:27:11.903481 [debug] [MainThread]: On master: COMMIT
20:27:11.904586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:11.905632 [debug] [MainThread]: On master: Close
20:27:11.906949 [info ] [MainThread]: 
20:27:11.908458 [info ] [MainThread]: Finished running 7 tests in 0.69s.
20:27:11.911445 [debug] [MainThread]: Connection 'master' was properly closed.
20:27:11.914780 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:27:11.935412 [info ] [MainThread]: 
20:27:11.937810 [info ] [MainThread]: [32mCompleted successfully[0m
20:27:11.941926 [info ] [MainThread]: 
20:27:11.949977 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:27:11.952342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7957ded30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7957dea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7957de100>]}


============================== 2024-07-21 20:27:34.968855 | 8e442471-1068-4fec-b673-1cff02d63040 ==============================
20:27:34.968855 [info ] [MainThread]: Running with dbt=1.0.0
20:27:34.970591 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:27:34.973799 [debug] [MainThread]: Tracking: tracking
20:27:34.980727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa83ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa7b4fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa7b4fc70>]}
20:27:35.186913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:27:35.189240 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:27:35.210891 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:27:35.319075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa76990d0>]}
20:27:35.339705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa76c4340>]}
20:27:35.341450 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:27:35.346441 [info ] [MainThread]: 
20:27:35.349518 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:35.352864 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:27:35.406877 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:27:35.409777 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:27:35.411233 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:27:35.418642 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:27:35.423123 [debug] [ThreadPool]: On list_dbt_database: Close
20:27:35.425474 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:27:35.431535 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:27:35.433614 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:27:35.436754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:35.444911 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:27:35.448380 [debug] [ThreadPool]: On list_dbt_database: Close
20:27:35.451353 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:27:35.465156 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:35.466438 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:27:35.467586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:35.475246 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:27:35.476670 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:35.477883 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:27:35.481360 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:27:35.485826 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:27:35.487381 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:27:35.490413 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:27:35.495761 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:35.496910 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:27:35.497965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:35.502260 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:27:35.503345 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:35.504569 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:27:35.508033 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:27:35.510286 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:27:35.511471 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:27:35.518551 [debug] [MainThread]: Using postgres connection "master"
20:27:35.519600 [debug] [MainThread]: On master: BEGIN
20:27:35.520802 [debug] [MainThread]: Opening a new connection, currently in state init
20:27:35.525318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:35.526400 [debug] [MainThread]: Using postgres connection "master"
20:27:35.527347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:27:35.534123 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:27:35.536723 [debug] [MainThread]: On master: ROLLBACK
20:27:35.538379 [debug] [MainThread]: Using postgres connection "master"
20:27:35.539855 [debug] [MainThread]: On master: BEGIN
20:27:35.541441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:35.542585 [debug] [MainThread]: On master: COMMIT
20:27:35.543582 [debug] [MainThread]: Using postgres connection "master"
20:27:35.544536 [debug] [MainThread]: On master: COMMIT
20:27:35.545899 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:35.546961 [debug] [MainThread]: On master: Close
20:27:35.548247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:27:35.549563 [info ] [MainThread]: 
20:27:35.557258 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:27:35.558576 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:27:35.560648 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:27:35.562214 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:27:35.563525 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:27:35.567603 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:27:35.578711 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.579980 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:27:35.631052 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:27:35.640883 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:27:35.642110 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:27:35.643238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:35.647429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:35.648584 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:27:35.649553 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:27:35.651951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:27:35.661620 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:27:35.662830 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:27:35.664201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:35.675136 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:27:35.676266 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:27:35.677240 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:27:35.679720 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:35.687288 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:27:35.688398 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:27:35.689690 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:27:35.692137 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.693203 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:27:35.694629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa7685c70>]}
20:27:35.696171 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
20:27:35.697346 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:27:35.699342 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:27:35.700735 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:27:35.702599 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:27:35.704879 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:27:35.706391 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:27:35.712133 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:27:35.720466 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.722435 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:27:35.727369 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:27:35.735251 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:27:35.736637 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:27:35.738130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:35.744202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:35.745391 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:27:35.746360 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:27:35.748703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:27:35.752516 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:27:35.753499 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:27:35.756083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:35.759460 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:27:35.760449 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:27:35.761384 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:27:35.763554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:35.766497 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:27:35.767466 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:27:35.768712 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:27:35.771440 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.772636 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:27:35.773952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa7bae1f0>]}
20:27:35.775659 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.07s]
20:27:35.776976 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:27:35.780051 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:27:35.781454 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:27:35.783333 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:27:35.785324 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:27:35.786391 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:27:35.792988 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:27:35.801537 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.802874 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:27:35.808759 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:27:35.817329 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:27:35.818453 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:27:35.819447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:35.825411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:35.827356 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:27:35.828341 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:27:35.831114 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:27:35.836168 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:27:35.837460 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:27:35.839969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:35.842953 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:27:35.843992 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:27:35.844946 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:27:35.847259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:35.850484 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:27:35.851571 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:27:35.852838 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:27:35.856116 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.857594 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:27:35.858995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa8a31640>]}
20:27:35.860446 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
20:27:35.861925 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:27:35.864537 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:27:35.865833 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:27:35.867705 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:27:35.869497 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:27:35.870714 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:27:35.877747 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:27:35.885377 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.886783 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:27:35.927861 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:27:35.935418 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.936537 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:27:35.937789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:35.942352 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:35.943460 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.944436 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:27:35.950096 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.0 seconds
20:27:35.954167 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.955888 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:27:35.957322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:35.961002 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.962103 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:27:35.963403 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:27:35.972381 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:27:35.973657 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.974782 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:27:35.977365 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:27:35.980439 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:27:35.981619 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:27:35.985143 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:27:35.987867 [debug] [Thread-1  ]: finished collecting timing info
20:27:35.989165 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:27:35.990724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e442471-1068-4fec-b673-1cff02d63040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa7bb0f70>]}
20:27:35.992255 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
20:27:35.993720 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:27:35.997387 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:35.998597 [debug] [MainThread]: Using postgres connection "master"
20:27:35.999738 [debug] [MainThread]: On master: BEGIN
20:27:36.000829 [debug] [MainThread]: Opening a new connection, currently in state closed
20:27:36.006263 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:36.007543 [debug] [MainThread]: On master: COMMIT
20:27:36.008634 [debug] [MainThread]: Using postgres connection "master"
20:27:36.009641 [debug] [MainThread]: On master: COMMIT
20:27:36.010913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:36.012134 [debug] [MainThread]: On master: Close
20:27:36.013752 [info ] [MainThread]: 
20:27:36.015490 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.66s.
20:27:36.017522 [debug] [MainThread]: Connection 'master' was properly closed.
20:27:36.019318 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:27:36.044545 [info ] [MainThread]: 
20:27:36.046343 [info ] [MainThread]: [32mCompleted successfully[0m
20:27:36.048504 [info ] [MainThread]: 
20:27:36.050478 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:27:36.056439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fab871e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa98fca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fa73dbbb0>]}


============================== 2024-07-21 20:27:43.521038 | 3f390049-8bf6-447a-b054-efa9489194a5 ==============================
20:27:43.521038 [info ] [MainThread]: Running with dbt=1.0.0
20:27:43.523100 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:27:43.525689 [debug] [MainThread]: Tracking: tracking
20:27:43.532096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e163fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0dcfb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0dcffa0>]}
20:27:43.746311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:27:43.747721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:27:43.759286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f390049-8bf6-447a-b054-efa9489194a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e09f00d0>]}
20:27:43.781303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f390049-8bf6-447a-b054-efa9489194a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0d48370>]}
20:27:43.782952 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:27:43.788293 [info ] [MainThread]: 
20:27:43.790655 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:43.794537 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:27:43.813607 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:43.815088 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:27:43.816167 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:27:43.826164 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:27:43.827569 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:27:43.828783 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:27:43.833082 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:27:43.837568 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:27:43.839538 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:27:43.842088 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:27:43.845854 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:43.847352 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:27:43.848940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:27:43.856453 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:27:43.857860 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:27:43.859142 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:27:43.864609 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:27:43.867556 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:27:43.869120 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:27:43.878382 [debug] [MainThread]: Using postgres connection "master"
20:27:43.879626 [debug] [MainThread]: On master: BEGIN
20:27:43.880849 [debug] [MainThread]: Opening a new connection, currently in state init
20:27:43.887499 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:27:43.888833 [debug] [MainThread]: Using postgres connection "master"
20:27:43.890252 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:27:43.909920 [debug] [MainThread]: SQL status: SELECT 4 in 0.02 seconds
20:27:43.914225 [debug] [MainThread]: On master: ROLLBACK
20:27:43.916045 [debug] [MainThread]: Using postgres connection "master"
20:27:43.917331 [debug] [MainThread]: On master: BEGIN
20:27:43.919007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:43.920712 [debug] [MainThread]: On master: COMMIT
20:27:43.921960 [debug] [MainThread]: Using postgres connection "master"
20:27:43.923302 [debug] [MainThread]: On master: COMMIT
20:27:43.924894 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:43.926233 [debug] [MainThread]: On master: Close
20:27:43.927521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:27:43.928999 [info ] [MainThread]: 
20:27:43.936214 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:43.937332 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:27:43.938894 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:43.940398 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:43.941539 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:43.965744 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:43.977335 [debug] [Thread-1  ]: finished collecting timing info
20:27:43.978598 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:44.009355 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:44.018175 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:44.019718 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:27:44.021091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.025334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:44.026370 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:27:44.027304 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:27:44.029743 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.033208 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.034301 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:27:44.035551 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:27:44.037266 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.10s]
20:27:44.038793 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:27:44.040756 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:27:44.041926 [info ] [Thread-1  ]: 2 of 7 START test customers_nb_orders_check..................................... [RUN]
20:27:44.043757 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:27:44.046419 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:27:44.048031 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:27:44.053183 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:27:44.063662 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.065040 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:27:44.069601 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:27:44.079491 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:27:44.080696 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:27:44.081978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.087008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:44.088373 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:27:44.089891 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:27:44.092636 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.095128 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.096179 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:27:44.097217 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:27:44.098512 [info ] [Thread-1  ]: 2 of 7 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.06s]
20:27:44.099925 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:27:44.101857 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:44.104182 [info ] [Thread-1  ]: 3 of 7 START test not_null_stg_customers_id..................................... [RUN]
20:27:44.106647 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:44.108987 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:44.110662 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:44.158747 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:44.166950 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.168404 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:44.173589 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:44.181857 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:44.183344 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:27:44.184420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.189105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:44.190246 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:27:44.191224 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:27:44.193182 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.195848 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.196920 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:27:44.198040 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:27:44.199514 [info ] [Thread-1  ]: 3 of 7 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.09s]
20:27:44.201013 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:27:44.202751 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:44.204873 [info ] [Thread-1  ]: 4 of 7 START test not_null_stg_orders_order_id.................................. [RUN]
20:27:44.206696 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:44.208452 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:44.209559 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:44.216135 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:44.227438 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.229076 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:44.232593 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:44.244162 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:44.245405 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:27:44.246586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.250783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:44.251923 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:27:44.253296 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:27:44.256552 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.259794 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.260884 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:27:44.262115 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:27:44.263519 [info ] [Thread-1  ]: 4 of 7 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:27:44.265136 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:27:44.266945 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
20:27:44.268194 [info ] [Thread-1  ]: 5 of 7 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
20:27:44.270885 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
20:27:44.272753 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
20:27:44.273893 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
20:27:44.287915 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
20:27:44.298686 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.299834 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
20:27:44.304142 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
20:27:44.316618 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
20:27:44.317857 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
20:27:44.318906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.326785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:44.328109 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
20:27:44.329364 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_database"."staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_database"."staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
20:27:44.331117 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "customer_id" does not exist
LINE 18:     select customer_id as to_field
                    ^

20:27:44.332399 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
20:27:44.333664 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.334847 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
20:27:44.336664 [debug] [Thread-1  ]: Database Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_commerce.yml)
  column "customer_id" does not exist
  LINE 18:     select customer_id as to_field
                      ^
  compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
20:27:44.339108 [error] [Thread-1  ]: 5 of 7 ERROR relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [[31mERROR[0m in 0.07s]
20:27:44.340968 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
20:27:44.343024 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:44.344240 [info ] [Thread-1  ]: 6 of 7 START test unique_stg_customers_id....................................... [RUN]
20:27:44.346091 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:44.347843 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:44.349035 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:27:44.361442 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:44.372631 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.374702 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:44.378184 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:44.388255 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:44.389649 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:27:44.391552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.396418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:27:44.397526 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:27:44.398469 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:27:44.400566 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.403842 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.405400 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:27:44.407407 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:27:44.409058 [info ] [Thread-1  ]: 6 of 7 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.06s]
20:27:44.410560 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:27:44.412299 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:44.413484 [info ] [Thread-1  ]: 7 of 7 START test unique_stg_orders_order_id.................................... [RUN]
20:27:44.415166 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:44.417015 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:44.418123 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:44.425088 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:44.433705 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.435115 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:44.440387 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:44.449724 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:44.451289 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:27:44.452230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:27:44.458494 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:27:44.459936 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:27:44.460891 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:27:44.463001 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:27:44.465935 [debug] [Thread-1  ]: finished collecting timing info
20:27:44.467067 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:27:44.468186 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:27:44.470030 [info ] [Thread-1  ]: 7 of 7 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:27:44.473597 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:27:44.476953 [debug] [MainThread]: Acquiring new postgres connection "master"
20:27:44.478192 [debug] [MainThread]: Using postgres connection "master"
20:27:44.479321 [debug] [MainThread]: On master: BEGIN
20:27:44.480308 [debug] [MainThread]: Opening a new connection, currently in state closed
20:27:44.485109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:27:44.486818 [debug] [MainThread]: On master: COMMIT
20:27:44.487985 [debug] [MainThread]: Using postgres connection "master"
20:27:44.489447 [debug] [MainThread]: On master: COMMIT
20:27:44.491491 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:27:44.493031 [debug] [MainThread]: On master: Close
20:27:44.494428 [info ] [MainThread]: 
20:27:44.495851 [info ] [MainThread]: Finished running 7 tests in 0.70s.
20:27:44.497891 [debug] [MainThread]: Connection 'master' was properly closed.
20:27:44.499601 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:27:44.518908 [info ] [MainThread]: 
20:27:44.521566 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:27:44.524531 [info ] [MainThread]: 
20:27:44.528466 [error] [MainThread]: [33mDatabase Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_commerce.yml)[0m
20:27:44.530107 [error] [MainThread]:   column "customer_id" does not exist
20:27:44.531768 [error] [MainThread]:   LINE 18:     select customer_id as to_field
20:27:44.534952 [error] [MainThread]:                       ^
20:27:44.538580 [error] [MainThread]:   compiled SQL at target/run/commerce/models/staging/stg_commerce.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
20:27:44.542588 [info ] [MainThread]: 
20:27:44.544777 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
20:27:44.547138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0986130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0986430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e1091fa0>]}


============================== 2024-07-21 20:29:03.292916 | d7b82ed1-7f04-4957-a665-8c23a5a47608 ==============================
20:29:03.292916 [info ] [MainThread]: Running with dbt=1.0.0
20:29:03.294305 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:29:03.296751 [debug] [MainThread]: Tracking: tracking
20:29:03.303216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd59a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd59a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd59adc0>]}
20:29:03.517157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:29:03.519050 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:29:03.542041 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:29:03.648549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd0cb0d0>]}
20:29:03.673324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd106670>]}
20:29:03.675579 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:29:03.681169 [info ] [MainThread]: 
20:29:03.685556 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:03.689697 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:29:03.747819 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:29:03.750054 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:29:03.751535 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:03.757413 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:29:03.760109 [debug] [ThreadPool]: On list_dbt_database: Close
20:29:03.761889 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:29:03.764982 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:29:03.766633 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:29:03.767745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:03.772770 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:29:03.775312 [debug] [ThreadPool]: On list_dbt_database: Close
20:29:03.778188 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:29:03.787710 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:29:03.788886 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:29:03.790231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:03.794827 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:29:03.796275 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:29:03.797601 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:29:03.801505 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:29:03.804187 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:29:03.805788 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:29:03.807637 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:29:03.811010 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:29:03.812364 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:29:03.813629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:03.818826 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:03.820203 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:29:03.821471 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:29:03.825880 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:29:03.828461 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:29:03.830137 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:29:03.837608 [debug] [MainThread]: Using postgres connection "master"
20:29:03.839090 [debug] [MainThread]: On master: BEGIN
20:29:03.840402 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:03.845324 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:03.846551 [debug] [MainThread]: Using postgres connection "master"
20:29:03.847602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:03.855050 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:29:03.857791 [debug] [MainThread]: On master: ROLLBACK
20:29:03.859127 [debug] [MainThread]: Using postgres connection "master"
20:29:03.860337 [debug] [MainThread]: On master: BEGIN
20:29:03.862080 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:03.863292 [debug] [MainThread]: On master: COMMIT
20:29:03.864368 [debug] [MainThread]: Using postgres connection "master"
20:29:03.865566 [debug] [MainThread]: On master: COMMIT
20:29:03.867077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:03.868200 [debug] [MainThread]: On master: Close
20:29:03.869691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:29:03.871417 [info ] [MainThread]: 
20:29:03.877481 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:29:03.878808 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:29:03.880524 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:29:03.882483 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:29:03.883785 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:29:03.889357 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:29:03.897891 [debug] [Thread-1  ]: finished collecting timing info
20:29:03.899341 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:29:03.944657 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:29:03.956157 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:29:03.957411 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:29:03.958412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:03.963100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:03.964565 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:29:03.966202 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:29:03.968858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:03.978887 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:29:03.980374 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:29:03.982251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:03.993716 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:29:03.995035 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:29:03.996145 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:29:03.998713 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:04.006714 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:29:04.008007 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:29:04.009531 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:04.011997 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.013096 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:29:04.014695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd0c6fa0>]}
20:29:04.017476 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.13s]
20:29:04.019331 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:29:04.021135 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:29:04.022689 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:29:04.024806 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:29:04.026359 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:29:04.027581 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:29:04.033878 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:29:04.043598 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.044717 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:29:04.049101 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:29:04.059858 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:29:04.061199 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:29:04.062618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:04.068296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:04.069901 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:29:04.071811 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:29:04.074260 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:04.078065 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:29:04.079278 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:29:04.080787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:04.085017 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:29:04.086286 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:29:04.087510 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:29:04.090547 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:04.093491 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:29:04.094764 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:29:04.096254 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:04.100084 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.101654 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:29:04.103784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd12f0a0>]}
20:29:04.105645 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
20:29:04.107178 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:29:04.109758 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:29:04.111048 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:29:04.112864 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:29:04.114649 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:29:04.116732 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:29:04.123621 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:29:04.133371 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.135660 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:29:04.139875 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:29:04.149888 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:29:04.151318 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:29:04.152619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:04.158876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:04.160226 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:29:04.161311 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:29:04.163991 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:04.169283 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:29:04.170521 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:29:04.172420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:04.174924 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:29:04.176151 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:29:04.177189 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:29:04.179747 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:04.183383 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:29:04.184482 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:29:04.185775 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:04.188334 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.189466 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:29:04.190940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd515100>]}
20:29:04.192465 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
20:29:04.193821 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:29:04.196120 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:29:04.197535 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:29:04.199789 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:29:04.201766 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:29:04.203129 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:29:04.207649 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:29:04.218653 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.220195 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:29:04.261343 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:29:04.271516 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.272928 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:29:04.273925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:04.278327 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:04.279492 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.280499 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:29:04.286927 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:29:04.290856 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.291911 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:29:04.293234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:04.297039 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.298436 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:29:04.300363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:04.309037 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:29:04.310344 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.311629 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:29:04.314130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:04.317727 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:29:04.318966 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:29:04.322516 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:04.325089 [debug] [Thread-1  ]: finished collecting timing info
20:29:04.326418 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:29:04.327986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b82ed1-7f04-4957-a665-8c23a5a47608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd163190>]}
20:29:04.329368 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.13s]
20:29:04.330837 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:29:04.334310 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:04.335491 [debug] [MainThread]: Using postgres connection "master"
20:29:04.336577 [debug] [MainThread]: On master: BEGIN
20:29:04.337695 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:04.343638 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:04.351666 [debug] [MainThread]: On master: COMMIT
20:29:04.355074 [debug] [MainThread]: Using postgres connection "master"
20:29:04.356593 [debug] [MainThread]: On master: COMMIT
20:29:04.358197 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:04.359642 [debug] [MainThread]: On master: Close
20:29:04.361325 [info ] [MainThread]: 
20:29:04.362851 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.68s.
20:29:04.364709 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:04.367699 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:29:04.391164 [info ] [MainThread]: 
20:29:04.393156 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:04.395948 [info ] [MainThread]: 
20:29:04.400604 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:29:04.404125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd121be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd1219a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bd04dcd0>]}


============================== 2024-07-21 20:29:11.576576 | a9cd550b-c0a4-40a4-b575-6f1229083752 ==============================
20:29:11.576576 [info ] [MainThread]: Running with dbt=1.0.0
20:29:11.578094 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:29:11.580524 [debug] [MainThread]: Tracking: tracking
20:29:11.588728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e85ff580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7d8fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7d8f580>]}
20:29:11.800187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:29:11.801646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:29:11.813177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9cd550b-c0a4-40a4-b575-6f1229083752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e79b00d0>]}
20:29:11.837339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9cd550b-c0a4-40a4-b575-6f1229083752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7d01340>]}
20:29:11.839107 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:29:11.845380 [info ] [MainThread]: 
20:29:11.848036 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:11.852897 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:29:11.872233 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:29:11.873523 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:29:11.874602 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:11.880529 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:11.882863 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:29:11.884211 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:29:11.888587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:29:11.891381 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:29:11.892935 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:29:11.894668 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:29:11.898026 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:29:11.900146 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:29:11.901952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:11.907168 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:11.908625 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:29:11.909928 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:29:11.913445 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:29:11.916872 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:29:11.918535 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:29:11.927056 [debug] [MainThread]: Using postgres connection "master"
20:29:11.928318 [debug] [MainThread]: On master: BEGIN
20:29:11.929591 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:11.934683 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:11.936057 [debug] [MainThread]: Using postgres connection "master"
20:29:11.937340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:11.950301 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:29:11.953146 [debug] [MainThread]: On master: ROLLBACK
20:29:11.954680 [debug] [MainThread]: Using postgres connection "master"
20:29:11.955852 [debug] [MainThread]: On master: BEGIN
20:29:11.957518 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:11.958786 [debug] [MainThread]: On master: COMMIT
20:29:11.960012 [debug] [MainThread]: Using postgres connection "master"
20:29:11.961042 [debug] [MainThread]: On master: COMMIT
20:29:11.962527 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:11.963667 [debug] [MainThread]: On master: Close
20:29:11.965474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:29:11.966975 [info ] [MainThread]: 
20:29:11.973441 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:29:11.974684 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:29:11.976481 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:29:11.978341 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:29:11.979522 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:29:12.007584 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:29:12.020849 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.022130 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:29:12.052299 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:29:12.061606 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:29:12.062838 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:29:12.064233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.069876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:12.071072 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:29:12.072251 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:29:12.074929 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.078787 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.080007 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:29:12.081423 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:29:12.083020 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.11s]
20:29:12.084550 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:29:12.086158 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:29:12.087617 [info ] [Thread-1  ]: 2 of 7 START test customers_nb_orders_check..................................... [RUN]
20:29:12.089490 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:29:12.091411 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:29:12.092786 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:29:12.097619 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:29:12.109162 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.110529 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:29:12.116473 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:29:12.126779 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:29:12.128122 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:29:12.129378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.136052 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:12.137485 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:29:12.138698 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:29:12.140695 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.143410 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.144633 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:29:12.146096 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:29:12.147844 [info ] [Thread-1  ]: 2 of 7 PASS customers_nb_orders_check........................................... [[32mPASS[0m in 0.06s]
20:29:12.150492 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:29:12.154913 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:29:12.156151 [info ] [Thread-1  ]: 3 of 7 START test not_null_stg_customers_id..................................... [RUN]
20:29:12.157853 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:29:12.159360 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:29:12.160607 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:29:12.206462 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:29:12.214027 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.217008 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:29:12.220691 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:29:12.228857 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:29:12.230638 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:29:12.232579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.237368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:12.238450 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:29:12.239336 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:29:12.241125 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.243652 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.244774 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:29:12.245849 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:29:12.247202 [info ] [Thread-1  ]: 3 of 7 PASS not_null_stg_customers_id........................................... [[32mPASS[0m in 0.09s]
20:29:12.249261 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:29:12.251439 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:29:12.252807 [info ] [Thread-1  ]: 4 of 7 START test not_null_stg_orders_order_id.................................. [RUN]
20:29:12.254708 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:29:12.256264 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:29:12.257721 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:29:12.264472 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:29:12.276192 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.277416 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:29:12.280479 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:29:12.292330 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:29:12.293643 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:29:12.294491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.299593 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:12.301051 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:29:12.302951 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:29:12.304846 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.307690 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.308704 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:29:12.309753 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:29:12.311063 [info ] [Thread-1  ]: 4 of 7 PASS not_null_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:29:12.312669 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:29:12.315821 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:29:12.317108 [info ] [Thread-1  ]: 5 of 7 START test relationships_stg_orders_customer_id__id__ref_stg_customers_.. [RUN]
20:29:12.318789 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:29:12.320522 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:29:12.321509 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:29:12.335635 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:29:12.343603 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.344796 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:29:12.349247 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:29:12.358572 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:29:12.359715 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: BEGIN
20:29:12.360682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.366650 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:12.368204 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:29:12.369151 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_database"."staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select id as to_field
    from "dbt_database"."staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
20:29:12.371531 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.373966 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.374964 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: ROLLBACK
20:29:12.376000 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: Close
20:29:12.377336 [info ] [Thread-1  ]: 5 of 7 PASS relationships_stg_orders_customer_id__id__ref_stg_customers_........ [[32mPASS[0m in 0.06s]
20:29:12.378960 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:29:12.382599 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:29:12.383845 [info ] [Thread-1  ]: 6 of 7 START test unique_stg_customers_id....................................... [RUN]
20:29:12.385687 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:29:12.387390 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:29:12.388501 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:29:12.400379 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:29:12.424865 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.426206 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:29:12.429274 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:29:12.439921 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:29:12.441059 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:29:12.442064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.446208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:12.447378 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:29:12.449276 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:29:12.451519 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.454166 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.455235 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:29:12.456362 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:29:12.457875 [info ] [Thread-1  ]: 6 of 7 PASS unique_stg_customers_id............................................. [[32mPASS[0m in 0.07s]
20:29:12.459256 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:29:12.461191 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:29:12.462370 [info ] [Thread-1  ]: 7 of 7 START test unique_stg_orders_order_id.................................... [RUN]
20:29:12.465217 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:29:12.466844 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:29:12.468099 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:29:12.474470 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:29:12.484401 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.487740 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:29:12.492075 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:29:12.503517 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:29:12.504770 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:29:12.505701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:12.509780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:12.510832 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:29:12.511756 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:29:12.513908 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:29:12.519454 [debug] [Thread-1  ]: finished collecting timing info
20:29:12.520954 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:29:12.522598 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:29:12.524405 [info ] [Thread-1  ]: 7 of 7 PASS unique_stg_orders_order_id.......................................... [[32mPASS[0m in 0.06s]
20:29:12.526353 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:29:12.531255 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:12.533238 [debug] [MainThread]: Using postgres connection "master"
20:29:12.535647 [debug] [MainThread]: On master: BEGIN
20:29:12.537119 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:12.543228 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:12.545108 [debug] [MainThread]: On master: COMMIT
20:29:12.546551 [debug] [MainThread]: Using postgres connection "master"
20:29:12.548067 [debug] [MainThread]: On master: COMMIT
20:29:12.549791 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:12.552128 [debug] [MainThread]: On master: Close
20:29:12.555750 [info ] [MainThread]: 
20:29:12.558878 [info ] [MainThread]: Finished running 7 tests in 0.71s.
20:29:12.561489 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:12.563902 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:29:12.592859 [info ] [MainThread]: 
20:29:12.594471 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:12.598032 [info ] [MainThread]: 
20:29:12.600845 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:29:12.603378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7961100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7961c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e7961040>]}


============================== 2024-07-21 20:43:57.296868 | 638a7657-a5bc-47de-8937-729655d53147 ==============================
20:43:57.296868 [info ] [MainThread]: Running with dbt=1.0.0
20:43:57.299333 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:43:57.301801 [debug] [MainThread]: Tracking: tracking
20:43:57.309253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785feff580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f8ddac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f8dd580>]}
20:43:57.538682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
20:43:57.540099 [debug] [MainThread]: Partial parsing: added file: commerce://models/staging/stg_commerce.md
20:43:57.541921 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/stg_commerce.yml
20:43:57.543752 [debug] [MainThread]: Partial parsing: deleted source source.commerce.raw.cust
20:43:57.545009 [debug] [MainThread]: Partial parsing: deleted source source.commerce.raw.ordr
20:43:57.546462 [debug] [MainThread]: Partial parsing: deleted source source.commerce.raw.pay
20:43:57.548379 [debug] [MainThread]: Partial parsing: update schema file: commerce://models/staging/src_commerce.yml
20:43:57.571513 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_orders.sql
20:43:57.589662 [debug] [MainThread]: 1699: static parser successfully parsed marts/customers_nb_orders.sql
20:43:57.594192 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customersorders.sql
20:43:57.598965 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customers.sql
20:43:57.794610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785feeb940>]}
20:43:57.816338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785ff7af10>]}
20:43:57.818002 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:43:57.822539 [info ] [MainThread]: 
20:43:57.824699 [debug] [MainThread]: Acquiring new postgres connection "master"
20:43:57.828502 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:43:57.849703 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:43:57.850964 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:43:57.852068 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:43:57.859271 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:43:57.862338 [debug] [ThreadPool]: On list_dbt_database: Close
20:43:57.864957 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:43:57.869694 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:43:57.870916 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:43:57.872083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:43:57.876983 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
20:43:57.880316 [debug] [ThreadPool]: On list_dbt_database: Close
20:43:57.884161 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:43:57.893261 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:43:57.894421 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:43:57.895926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:43:57.900277 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:43:57.901570 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:43:57.902587 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:43:57.905769 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:43:57.908029 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:43:57.909130 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:43:57.910588 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:43:57.914172 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:43:57.915196 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:43:57.916044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:43:57.920262 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:43:57.921271 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:43:57.922108 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:43:57.925060 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:43:57.927369 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:43:57.928838 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:43:57.935842 [debug] [MainThread]: Using postgres connection "master"
20:43:57.936885 [debug] [MainThread]: On master: BEGIN
20:43:57.937802 [debug] [MainThread]: Opening a new connection, currently in state init
20:43:57.941961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:43:57.942970 [debug] [MainThread]: Using postgres connection "master"
20:43:57.943839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:43:57.950865 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:43:57.953104 [debug] [MainThread]: On master: ROLLBACK
20:43:57.954227 [debug] [MainThread]: Using postgres connection "master"
20:43:57.955194 [debug] [MainThread]: On master: BEGIN
20:43:57.956452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:43:57.957442 [debug] [MainThread]: On master: COMMIT
20:43:57.958400 [debug] [MainThread]: Using postgres connection "master"
20:43:57.959237 [debug] [MainThread]: On master: COMMIT
20:43:57.960291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:43:57.961221 [debug] [MainThread]: On master: Close
20:43:57.962747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:43:57.964337 [info ] [MainThread]: 
20:43:57.972794 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:43:57.974034 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:43:57.975709 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:43:57.977484 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:43:57.989795 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:43:57.999999 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:43:58.006910 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.008263 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:43:58.057932 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:43:58.066213 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:43:58.067287 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:43:58.068215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:43:58.072284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:43:58.073329 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:43:58.074174 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:43:58.076521 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:43:58.086008 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:43:58.087139 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:43:58.088515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:43:58.099223 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:43:58.100310 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:43:58.101352 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:43:58.104314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:43:58.112010 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:43:58.113488 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:43:58.114754 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:43:58.117194 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.118376 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:43:58.119952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1da310>]}
20:43:58.121789 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.14s]
20:43:58.123363 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:43:58.126626 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:43:58.128621 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:43:58.130843 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:43:58.132063 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:43:58.133244 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:43:58.137393 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:43:58.145273 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.146723 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:43:58.152901 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:43:58.160721 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:43:58.163490 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:43:58.165421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:43:58.170695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:43:58.171954 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:43:58.173126 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:43:58.175311 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:43:58.180102 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:43:58.181976 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:43:58.184590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:43:58.186948 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:43:58.188086 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:43:58.188953 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:43:58.191722 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:43:58.194851 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:43:58.196700 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:43:58.198728 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:43:58.201230 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.202203 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:43:58.203712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1da100>]}
20:43:58.205305 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.07s]
20:43:58.206869 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:43:58.209226 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:43:58.210574 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:43:58.213593 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:43:58.216050 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:43:58.217346 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:43:58.222202 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:43:58.234957 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.236029 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:43:58.239618 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:43:58.251520 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:43:58.252560 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:43:58.253501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:43:58.257874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:43:58.258903 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:43:58.259767 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:43:58.262799 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:43:58.267691 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:43:58.268754 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:43:58.270021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:43:58.272294 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:43:58.273357 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:43:58.274294 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:43:58.276523 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:43:58.281613 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:43:58.282637 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:43:58.283790 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:43:58.286010 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.286992 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:43:58.288328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f150df0>]}
20:43:58.290229 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.08s]
20:43:58.291780 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:43:58.295159 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:43:58.296507 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:43:58.298256 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:43:58.299892 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:43:58.300827 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:43:58.305373 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:43:58.312671 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.314108 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:43:58.354430 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:43:58.360964 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.363833 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:43:58.364838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:43:58.369051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:43:58.370089 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.370958 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:43:58.377066 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:43:58.381022 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.382272 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:43:58.383564 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:43:58.388282 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.389371 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:43:58.390763 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:43:58.399347 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:43:58.400542 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.401487 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:43:58.404339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:43:58.407289 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:43:58.408433 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:43:58.411957 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:43:58.414566 [debug] [Thread-1  ]: finished collecting timing info
20:43:58.415737 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:43:58.417230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638a7657-a5bc-47de-8937-729655d53147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1815e0>]}
20:43:58.418596 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.12s]
20:43:58.421084 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:43:58.424317 [debug] [MainThread]: Acquiring new postgres connection "master"
20:43:58.425693 [debug] [MainThread]: Using postgres connection "master"
20:43:58.427065 [debug] [MainThread]: On master: BEGIN
20:43:58.428417 [debug] [MainThread]: Opening a new connection, currently in state closed
20:43:58.433206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:43:58.434538 [debug] [MainThread]: On master: COMMIT
20:43:58.435996 [debug] [MainThread]: Using postgres connection "master"
20:43:58.437224 [debug] [MainThread]: On master: COMMIT
20:43:58.438731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:43:58.439913 [debug] [MainThread]: On master: Close
20:43:58.441453 [info ] [MainThread]: 
20:43:58.443132 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.62s.
20:43:58.445444 [debug] [MainThread]: Connection 'master' was properly closed.
20:43:58.447677 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:43:58.470997 [info ] [MainThread]: 
20:43:58.472584 [info ] [MainThread]: [32mCompleted successfully[0m
20:43:58.474823 [info ] [MainThread]: 
20:43:58.476720 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:43:58.479697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1a5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1a5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f785f1d8550>]}


============================== 2024-07-21 20:44:15.457137 | dfd6b0ce-48c0-4a7b-b826-2747f29628d4 ==============================
20:44:15.457137 [info ] [MainThread]: Running with dbt=1.0.0
20:44:15.458761 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
20:44:15.463443 [debug] [MainThread]: Tracking: tracking
20:44:15.470327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb30bf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb2ab2b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb2ab2580>]}
20:44:15.699856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:44:15.701337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:44:15.712615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfd6b0ce-48c0-4a7b-b826-2747f29628d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb277c0a0>]}
20:44:15.735814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfd6b0ce-48c0-4a7b-b826-2747f29628d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb27e0d30>]}
20:44:15.737406 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:44:15.743543 [info ] [MainThread]: 
20:44:15.747136 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:15.750181 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:44:15.770132 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:44:15.771289 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:44:15.772375 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:44:15.778809 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:44:15.780948 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:44:15.782376 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:44:15.785667 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:44:15.788696 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:44:15.790047 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:44:15.791705 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:44:15.795951 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:44:15.798063 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:44:15.800048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:44:15.804602 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:44:15.805952 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:44:15.807218 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:44:15.811956 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:44:15.815371 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:44:15.816833 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:44:15.824019 [debug] [MainThread]: Using postgres connection "master"
20:44:15.825192 [debug] [MainThread]: On master: BEGIN
20:44:15.826390 [debug] [MainThread]: Opening a new connection, currently in state init
20:44:15.831290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:15.832382 [debug] [MainThread]: Using postgres connection "master"
20:44:15.833306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:44:15.845294 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:44:15.847913 [debug] [MainThread]: On master: ROLLBACK
20:44:15.849187 [debug] [MainThread]: Using postgres connection "master"
20:44:15.850146 [debug] [MainThread]: On master: BEGIN
20:44:15.851407 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:15.852487 [debug] [MainThread]: On master: COMMIT
20:44:15.853420 [debug] [MainThread]: Using postgres connection "master"
20:44:15.854309 [debug] [MainThread]: On master: COMMIT
20:44:15.855400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:15.856463 [debug] [MainThread]: On master: Close
20:44:15.857745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:44:15.859223 [info ] [MainThread]: 
20:44:15.866419 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:44:15.867683 [info ] [Thread-1  ]: 1 of 11 START test accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [RUN]
20:44:15.869453 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:44:15.870966 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:44:15.872400 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:44:15.899975 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:44:15.908326 [debug] [Thread-1  ]: finished collecting timing info
20:44:15.909942 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:44:15.940202 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:44:15.952691 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:44:15.954303 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: BEGIN
20:44:15.955551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:15.961947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:15.963894 [debug] [Thread-1  ]: Using postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:44:15.965316 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_database"."staging"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','completed','returned','return_pending','shipped'
)



      
    ) dbt_internal_test
20:44:15.970696 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:15.976980 [debug] [Thread-1  ]: finished collecting timing info
20:44:15.978551 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: ROLLBACK
20:44:15.980008 [debug] [Thread-1  ]: On test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec: Close
20:44:15.981774 [info ] [Thread-1  ]: 1 of 11 PASS accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped [[32mPASS[0m in 0.11s]
20:44:15.983753 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:44:15.985841 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:44:15.987274 [info ] [Thread-1  ]: 2 of 11 START test customers_nb_orders_check.................................... [RUN]
20:44:15.989185 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:44:15.991197 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:44:15.993260 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:44:15.999735 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:44:16.008398 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.010493 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:44:16.019584 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.customers_nb_orders_check"
20:44:16.029142 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:44:16.032407 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: BEGIN
20:44:16.034057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.039722 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:16.041355 [debug] [Thread-1  ]: Using postgres connection "test.commerce.customers_nb_orders_check"
20:44:16.043004 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.customers_nb_orders_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select full_name
from "dbt_database"."marts"."customers_nb_orders"
where nb_orders < 0
      
    ) dbt_internal_test
20:44:16.047648 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.050808 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.051855 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: ROLLBACK
20:44:16.052988 [debug] [Thread-1  ]: On test.commerce.customers_nb_orders_check: Close
20:44:16.054346 [info ] [Thread-1  ]: 2 of 11 PASS customers_nb_orders_check.......................................... [[32mPASS[0m in 0.07s]
20:44:16.055971 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:44:16.057770 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:44:16.059317 [info ] [Thread-1  ]: 3 of 11 START test not_null_stg_customers_id.................................... [RUN]
20:44:16.062492 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:44:16.064342 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:44:16.065356 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:44:16.109608 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:44:16.121519 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.122885 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:44:16.126421 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:44:16.136373 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:44:16.137564 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: BEGIN
20:44:16.138593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.143102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:44:16.144565 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:44:16.145516 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_customers_id.6bd2c50f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_customers"
where id is null



      
    ) dbt_internal_test
20:44:16.147448 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.150106 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.151145 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: ROLLBACK
20:44:16.152239 [debug] [Thread-1  ]: On test.commerce.not_null_stg_customers_id.6bd2c50f02: Close
20:44:16.153542 [info ] [Thread-1  ]: 3 of 11 PASS not_null_stg_customers_id.......................................... [[32mPASS[0m in 0.09s]
20:44:16.155956 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:44:16.158469 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:44:16.161742 [info ] [Thread-1  ]: 4 of 11 START test not_null_stg_orders_order_id................................. [RUN]
20:44:16.163674 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:44:16.165207 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:44:16.166335 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:44:16.172204 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:44:16.185687 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.187144 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:44:16.191189 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:44:16.202773 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:44:16.204076 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
20:44:16.205008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.209205 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:44:16.211086 [debug] [Thread-1  ]: Using postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:44:16.212575 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
20:44:16.215460 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.218136 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.219231 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
20:44:16.220467 [debug] [Thread-1  ]: On test.commerce.not_null_stg_orders_order_id.81cfe2fe64: Close
20:44:16.221827 [info ] [Thread-1  ]: 4 of 11 PASS not_null_stg_orders_order_id....................................... [[32mPASS[0m in 0.06s]
20:44:16.224190 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:44:16.225787 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:44:16.227949 [info ] [Thread-1  ]: 5 of 11 START test relationships_stg_orders_customer_id__id__ref_stg_customers_. [RUN]
20:44:16.229626 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:44:16.231172 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:44:16.232528 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:44:16.245513 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:44:16.255624 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.257074 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:44:16.261635 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:44:16.271445 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:44:16.272654 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: BEGIN
20:44:16.273728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.279253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:16.280649 [debug] [Thread-1  ]: Using postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:44:16.281599 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_database"."staging"."stg_orders"
    where customer_id is not null
),

parent as (
    select id as to_field
    from "dbt_database"."staging"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
20:44:16.283883 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.286428 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.287463 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: ROLLBACK
20:44:16.288680 [debug] [Thread-1  ]: On test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a: Close
20:44:16.290057 [info ] [Thread-1  ]: 5 of 11 PASS relationships_stg_orders_customer_id__id__ref_stg_customers_....... [[32mPASS[0m in 0.06s]
20:44:16.291457 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:44:16.293846 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:44:16.295069 [info ] [Thread-1  ]: 6 of 11 START test source_not_null_raw_cust_id.................................. [RUN]
20:44:16.296696 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:44:16.298476 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:44:16.299603 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_cust_id.93b15e3909
20:44:16.305208 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:44:16.320348 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.321614 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:44:16.325659 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:44:16.344671 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:44:16.346048 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_cust_id.93b15e3909: BEGIN
20:44:16.347673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.353600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:16.354863 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:44:16.356041 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_cust_id.93b15e3909: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.source_not_null_raw_cust_id.93b15e3909"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."raw"."customers"
where id is null



      
    ) dbt_internal_test
20:44:16.357830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.361186 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.363167 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_cust_id.93b15e3909: ROLLBACK
20:44:16.364569 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_cust_id.93b15e3909: Close
20:44:16.366419 [info ] [Thread-1  ]: 6 of 11 PASS source_not_null_raw_cust_id........................................ [[32mPASS[0m in 0.07s]
20:44:16.368000 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:44:16.369855 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:44:16.371375 [info ] [Thread-1  ]: 7 of 11 START test source_not_null_raw_ordr_id.................................. [RUN]
20:44:16.372948 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:44:16.374580 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:44:16.375643 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:44:16.383191 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:44:16.394245 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.395817 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:44:16.402624 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:44:16.417001 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:44:16.418333 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_ordr_id.7f74ca2883: BEGIN
20:44:16.419558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.424615 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:16.425844 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:44:16.427821 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_ordr_id.7f74ca2883: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt_database"."raw"."orders"
where id is null



      
    ) dbt_internal_test
20:44:16.430524 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.433199 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.434177 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_ordr_id.7f74ca2883: ROLLBACK
20:44:16.435195 [debug] [Thread-1  ]: On test.commerce.source_not_null_raw_ordr_id.7f74ca2883: Close
20:44:16.436553 [info ] [Thread-1  ]: 7 of 11 PASS source_not_null_raw_ordr_id........................................ [[32mPASS[0m in 0.06s]
20:44:16.437881 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:44:16.439455 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:44:16.440575 [info ] [Thread-1  ]: 8 of 11 START test source_unique_raw_cust_id.................................... [RUN]
20:44:16.442155 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:44:16.445344 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:44:16.446378 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:44:16.456640 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:44:16.466825 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.468240 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:44:16.472068 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:44:16.484736 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:44:16.485767 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_cust_id.dc9b348fa2: BEGIN
20:44:16.486697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.491489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:44:16.492496 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:44:16.494425 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_cust_id.dc9b348fa2: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.source_unique_raw_cust_id.dc9b348fa2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."raw"."customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:44:16.497634 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.500623 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.501460 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_cust_id.dc9b348fa2: ROLLBACK
20:44:16.502484 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_cust_id.dc9b348fa2: Close
20:44:16.503739 [info ] [Thread-1  ]: 8 of 11 PASS source_unique_raw_cust_id.......................................... [[32mPASS[0m in 0.06s]
20:44:16.505252 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:44:16.506921 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:44:16.508420 [info ] [Thread-1  ]: 9 of 11 START test source_unique_raw_ordr_id.................................... [RUN]
20:44:16.512019 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:44:16.513783 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:44:16.514866 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:44:16.523253 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:44:16.535283 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.536776 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:44:16.540939 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:44:16.553675 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:44:16.554858 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_ordr_id.4f0ddf7783: BEGIN
20:44:16.555944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.561758 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:16.564186 [debug] [Thread-1  ]: Using postgres connection "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:44:16.565559 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_ordr_id.4f0ddf7783: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."raw"."orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:44:16.567807 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.570470 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.571560 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_ordr_id.4f0ddf7783: ROLLBACK
20:44:16.572691 [debug] [Thread-1  ]: On test.commerce.source_unique_raw_ordr_id.4f0ddf7783: Close
20:44:16.574054 [info ] [Thread-1  ]: 9 of 11 PASS source_unique_raw_ordr_id.......................................... [[32mPASS[0m in 0.06s]
20:44:16.575587 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:44:16.578546 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:44:16.579618 [info ] [Thread-1  ]: 10 of 11 START test unique_stg_customers_id..................................... [RUN]
20:44:16.581153 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:44:16.582700 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:44:16.584039 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:44:16.590141 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:44:16.601738 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.603203 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:44:16.606112 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:44:16.618713 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:44:16.620056 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: BEGIN
20:44:16.620875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.624931 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:44:16.626359 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:44:16.628235 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_customers_id.a6a76acf47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
20:44:16.631527 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.634333 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.635358 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: ROLLBACK
20:44:16.636472 [debug] [Thread-1  ]: On test.commerce.unique_stg_customers_id.a6a76acf47: Close
20:44:16.637868 [info ] [Thread-1  ]: 10 of 11 PASS unique_stg_customers_id........................................... [[32mPASS[0m in 0.06s]
20:44:16.639287 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:44:16.641006 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:44:16.642184 [info ] [Thread-1  ]: 11 of 11 START test unique_stg_orders_order_id.................................. [RUN]
20:44:16.644968 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:44:16.648454 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:44:16.649522 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:44:16.655277 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:44:16.666677 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.668272 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:44:16.671681 [debug] [Thread-1  ]: Writing runtime SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:44:16.683375 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:44:16.684622 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: BEGIN
20:44:16.685524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:16.689869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:44:16.690931 [debug] [Thread-1  ]: Using postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:44:16.691858 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "test.commerce.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_database"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
20:44:16.695075 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
20:44:16.698345 [debug] [Thread-1  ]: finished collecting timing info
20:44:16.699430 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
20:44:16.700553 [debug] [Thread-1  ]: On test.commerce.unique_stg_orders_order_id.e3b841c71a: Close
20:44:16.701855 [info ] [Thread-1  ]: 11 of 11 PASS unique_stg_orders_order_id........................................ [[32mPASS[0m in 0.06s]
20:44:16.703340 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:44:16.706616 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:16.707931 [debug] [MainThread]: Using postgres connection "master"
20:44:16.709049 [debug] [MainThread]: On master: BEGIN
20:44:16.710894 [debug] [MainThread]: Opening a new connection, currently in state closed
20:44:16.715546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:16.716660 [debug] [MainThread]: On master: COMMIT
20:44:16.717561 [debug] [MainThread]: Using postgres connection "master"
20:44:16.718653 [debug] [MainThread]: On master: COMMIT
20:44:16.719764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:16.721405 [debug] [MainThread]: On master: Close
20:44:16.722774 [info ] [MainThread]: 
20:44:16.724967 [info ] [MainThread]: Finished running 11 tests in 0.98s.
20:44:16.727937 [debug] [MainThread]: Connection 'master' was properly closed.
20:44:16.729814 [debug] [MainThread]: Connection 'test.commerce.unique_stg_orders_order_id.e3b841c71a' was properly closed.
20:44:16.752859 [info ] [MainThread]: 
20:44:16.754606 [info ] [MainThread]: [32mCompleted successfully[0m
20:44:16.756538 [info ] [MainThread]: 
20:44:16.758436 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
20:44:16.761292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb369a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb2b03940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bb23e18e0>]}


============================== 2024-07-21 20:45:09.792619 | 4e23cc89-6a78-4d6a-ac76-e24469888130 ==============================
20:45:09.792619 [info ] [MainThread]: Running with dbt=1.0.0
20:45:09.794213 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
20:45:09.796640 [debug] [MainThread]: Tracking: tracking
20:45:09.804057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7591b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7591b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7591b0d0>]}
20:45:10.019221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:45:10.020500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:45:10.031735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e23cc89-6a78-4d6a-ac76-e24469888130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7553c0a0>]}
20:45:10.052832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e23cc89-6a78-4d6a-ac76-e24469888130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f7559ebe0>]}
20:45:10.054647 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:45:10.060510 [info ] [MainThread]: 
20:45:10.063195 [debug] [MainThread]: Acquiring new postgres connection "master"
20:45:10.067272 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:45:10.086746 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:45:10.088027 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:45:10.089055 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:45:10.094835 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:45:10.096095 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:45:10.097672 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:45:10.102873 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:45:10.105773 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:45:10.107198 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:45:10.109170 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:45:10.112289 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:45:10.113740 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:45:10.115564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:45:10.121164 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:45:10.122371 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:45:10.123482 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:45:10.126889 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:45:10.129398 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:45:10.131354 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:45:10.140137 [debug] [MainThread]: Using postgres connection "master"
20:45:10.141073 [debug] [MainThread]: On master: BEGIN
20:45:10.142033 [debug] [MainThread]: Opening a new connection, currently in state init
20:45:10.146955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:45:10.148141 [debug] [MainThread]: Using postgres connection "master"
20:45:10.149230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:45:10.161245 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:45:10.164647 [debug] [MainThread]: On master: ROLLBACK
20:45:10.166442 [debug] [MainThread]: On master: Close
20:45:10.168064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:45:10.169615 [info ] [MainThread]: 
20:45:10.176466 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:45:10.177964 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:45:10.179082 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:45:10.180352 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:45:10.185397 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:45:10.193498 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.194793 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:45:10.196155 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.197940 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:45:10.200184 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:45:10.203033 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:45:10.204418 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:45:10.205656 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:45:10.210033 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:45:10.223589 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.224960 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:45:10.226200 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.227742 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:45:10.229003 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:45:10.231383 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:45:10.232930 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:45:10.234729 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_cust_id.93b15e3909
20:45:10.250873 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:45:10.261270 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.262577 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:45:10.263990 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.265843 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:45:10.267333 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:45:10.268729 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:45:10.269934 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:45:10.271133 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:45:10.277419 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:45:10.288731 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.290139 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:45:10.291461 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.293063 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:45:10.294430 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:45:10.295859 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:45:10.297508 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:45:10.298920 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:45:10.309570 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:45:10.321040 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.322413 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:45:10.323572 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.324942 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:45:10.326086 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:45:10.327431 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:45:10.328513 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:45:10.329669 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:45:10.364656 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:45:10.378573 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.380009 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:45:10.381559 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.383353 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:45:10.384787 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:45:10.386188 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:45:10.387226 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:45:10.388321 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:45:10.393401 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:45:10.403568 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.405009 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:45:10.406394 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.408014 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:45:10.409394 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:45:10.410961 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:45:10.412296 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:45:10.413522 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:45:10.419175 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:45:10.429233 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.431089 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:45:10.432371 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.433946 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:45:10.435341 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:45:10.436874 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:45:10.438198 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:45:10.439364 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:45:10.443831 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:45:10.454087 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.455723 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:45:10.457106 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.458779 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:45:10.460171 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:45:10.461876 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:45:10.463234 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:45:10.464722 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:45:10.479709 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:45:10.490614 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.491866 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:45:10.493173 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.494877 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:45:10.496262 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:45:10.498036 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:45:10.499390 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:45:10.500684 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:45:10.506343 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:45:10.516859 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.518105 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:45:10.519554 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.521164 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:45:10.522567 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:45:10.523972 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:45:10.525215 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:45:10.526399 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:45:10.538452 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:45:10.549883 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.551451 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:45:10.552653 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.554190 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:45:10.555628 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:45:10.557123 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:45:10.558433 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:45:10.559759 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:45:10.565981 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:45:10.575919 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.577275 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:45:10.578568 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.580245 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:45:10.581986 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:45:10.583469 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:45:10.584751 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:45:10.585926 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:45:10.590044 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:45:10.599199 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.600521 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:45:10.601754 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.603168 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:45:10.605083 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:45:10.606584 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:45:10.607716 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:45:10.608809 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:45:10.612479 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:45:10.623046 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.624572 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:45:10.625896 [debug] [Thread-1  ]: finished collecting timing info
20:45:10.627658 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:45:10.630559 [debug] [MainThread]: Connection 'master' was properly closed.
20:45:10.631913 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
20:45:10.651256 [info ] [MainThread]: Done.
20:45:10.676524 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:45:10.677800 [info ] [MainThread]: Building catalog
20:45:10.685254 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_database.information_schema"
20:45:10.702101 [debug] [ThreadPool]: Using postgres connection "dbt_database.information_schema"
20:45:10.703467 [debug] [ThreadPool]: On dbt_database.information_schema: BEGIN
20:45:10.704823 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:45:10.710245 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:45:10.711390 [debug] [ThreadPool]: Using postgres connection "dbt_database.information_schema"
20:45:10.712438 [debug] [ThreadPool]: On dbt_database.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "dbt_database.information_schema"} */

    
    

    select
        'dbt_database' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('staging') or upper(sch.nspname) = upper('raw') or upper(sch.nspname) = upper('marts'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:45:10.725910 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.01 seconds
20:45:10.747948 [debug] [ThreadPool]: On dbt_database.information_schema: ROLLBACK
20:45:10.749360 [debug] [ThreadPool]: On dbt_database.information_schema: Close
20:45:10.775923 [info ] [MainThread]: Catalog written to /app/dbt_project/target/catalog.json
20:45:10.777844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f751d5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f751d55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f751d5550>]}
20:45:11.206275 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:45:11.208402 [debug] [MainThread]: Connection 'dbt_database.information_schema' was properly closed.


============================== 2024-07-21 20:45:27.339659 | 1f7a49ac-bf0c-4678-8555-0128c741f39e ==============================
20:45:27.339659 [info ] [MainThread]: Running with dbt=1.0.0
20:45:27.341214 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
20:45:27.347538 [debug] [MainThread]: Tracking: tracking
20:45:27.353782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f381d6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f381d66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f381d68e0>]}
20:45:27.379181 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:45:27.382575 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:45:27.385158 [info ] [MainThread]: 
20:45:27.387645 [info ] [MainThread]: 
20:45:27.389802 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2024-07-21 20:46:23.882542 | e09ce123-c51a-4e78-a5af-fafa2b446f63 ==============================
20:46:23.882542 [info ] [MainThread]: Running with dbt=1.0.0
20:46:23.884327 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
20:46:23.886395 [debug] [MainThread]: Tracking: tracking
20:46:23.893547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b4f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b4f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9339b4f820>]}
20:46:23.918463 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:46:23.920832 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:46:23.924947 [info ] [MainThread]: 
20:46:23.929071 [info ] [MainThread]: 
20:46:23.937400 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2024-07-21 20:49:32.250132 | 1db4a7d6-708c-4dd5-a25d-6f909b0ee491 ==============================
20:49:32.250132 [info ] [MainThread]: Running with dbt=1.0.0
20:49:32.252868 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
20:49:32.256448 [debug] [MainThread]: Tracking: tracking
20:49:32.262169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56794ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56794f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff56794f370>]}
20:49:32.384899 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:49:32.386806 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:49:32.401294 [info ] [MainThread]: 
20:49:32.422712 [info ] [MainThread]: 
20:49:32.429541 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2024-07-21 20:53:39.370708 | d399d48c-eaf0-4dd3-a637-25e8c5a95706 ==============================
20:53:39.370708 [info ] [MainThread]: Running with dbt=1.0.0
20:53:39.372288 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
20:53:39.374673 [debug] [MainThread]: Tracking: tracking
20:53:39.381810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf872e8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf872e85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf872e8520>]}
20:53:39.599703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:53:39.601051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:53:39.615877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86ffc0d0>]}
20:53:39.639137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf879753a0>]}
20:53:39.640820 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:53:39.646394 [info ] [MainThread]: 
20:53:39.648739 [debug] [MainThread]: Acquiring new postgres connection "master"
20:53:39.652874 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:53:39.671290 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:53:39.672706 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:53:39.673946 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:53:39.680942 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:53:39.684933 [debug] [ThreadPool]: On list_dbt_database: Close
20:53:39.686762 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database"
20:53:39.690057 [debug] [ThreadPool]: Using postgres connection "list_dbt_database"
20:53:39.691496 [debug] [ThreadPool]: On list_dbt_database: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database"} */

    select distinct nspname from pg_namespace
  
20:53:39.692782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:53:39.699722 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
20:53:39.703237 [debug] [ThreadPool]: On list_dbt_database: Close
20:53:39.706461 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:53:39.718556 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:53:39.719646 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:53:39.720701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:53:39.725514 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:53:39.727027 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:53:39.728311 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:53:39.732644 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:53:39.735342 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:53:39.737053 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:53:39.738892 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:53:39.742098 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:53:39.743283 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:53:39.744535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:53:39.749842 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:53:39.751194 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:53:39.752490 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:53:39.756052 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
20:53:39.758665 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:53:39.760189 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:53:39.769074 [debug] [MainThread]: Using postgres connection "master"
20:53:39.770320 [debug] [MainThread]: On master: BEGIN
20:53:39.771265 [debug] [MainThread]: Opening a new connection, currently in state init
20:53:39.775996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:53:39.777425 [debug] [MainThread]: Using postgres connection "master"
20:53:39.778734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:53:39.786397 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:53:39.789029 [debug] [MainThread]: On master: ROLLBACK
20:53:39.790609 [debug] [MainThread]: Using postgres connection "master"
20:53:39.791893 [debug] [MainThread]: On master: BEGIN
20:53:39.793619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:53:39.794932 [debug] [MainThread]: On master: COMMIT
20:53:39.796259 [debug] [MainThread]: Using postgres connection "master"
20:53:39.797586 [debug] [MainThread]: On master: COMMIT
20:53:39.799034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:53:39.800326 [debug] [MainThread]: On master: Close
20:53:39.801839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:53:39.803331 [info ] [MainThread]: 
20:53:39.831577 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:53:39.833526 [info ] [Thread-1  ]: 1 of 4 START view model staging.stg_customers................................... [RUN]
20:53:39.835356 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:53:39.837296 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:53:39.838473 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:53:39.843315 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:53:39.856433 [debug] [Thread-1  ]: finished collecting timing info
20:53:39.858490 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:53:39.902681 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customers"
20:53:39.912189 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:53:39.913800 [debug] [Thread-1  ]: On model.commerce.stg_customers: BEGIN
20:53:39.915474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:53:39.920607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:53:39.922088 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:53:39.923399 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */

  create view "dbt_database"."staging"."stg_customers__dbt_tmp" as (
    select *,
concat(first_name,' ',last_name) as full_name
from "dbt_database"."raw"."customers"
  );
20:53:39.926201 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:53:39.964884 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:53:39.966260 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
alter table "dbt_database"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
20:53:39.968062 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:53:39.978950 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:53:39.981088 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:53:39.982495 [debug] [Thread-1  ]: On model.commerce.stg_customers: COMMIT
20:53:39.985444 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:53:39.993049 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customers"
20:53:39.994432 [debug] [Thread-1  ]: On model.commerce.stg_customers: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customers"} */
drop view if exists "dbt_database"."staging"."stg_customers__dbt_backup" cascade
20:53:39.996342 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:53:39.998934 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.000292 [debug] [Thread-1  ]: On model.commerce.stg_customers: Close
20:53:40.001973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86f686d0>]}
20:53:40.003567 [info ] [Thread-1  ]: 1 of 4 OK created view model staging.stg_customers.............................. [[32mCREATE VIEW[0m in 0.17s]
20:53:40.005142 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:53:40.006918 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:53:40.008482 [info ] [Thread-1  ]: 2 of 4 START view model staging.stg_orders...................................... [RUN]
20:53:40.010297 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:53:40.012616 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:53:40.013937 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:53:40.020538 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:53:40.032378 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.034107 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:53:40.037844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_orders"
20:53:40.048772 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:53:40.050616 [debug] [Thread-1  ]: On model.commerce.stg_orders: BEGIN
20:53:40.052629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:53:40.057334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:53:40.058386 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:53:40.059302 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */

  create view "dbt_database"."staging"."stg_orders__dbt_tmp" as (
    SELECT
    id AS order_id,
    user_id AS customer_id,
    order_date,
    status
FROM
"dbt_database"."raw"."orders"
  );
20:53:40.061512 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:53:40.067505 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:53:40.068618 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
alter table "dbt_database"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
20:53:40.070044 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:53:40.072312 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:53:40.073328 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:53:40.074206 [debug] [Thread-1  ]: On model.commerce.stg_orders: COMMIT
20:53:40.076524 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:53:40.079611 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_orders"
20:53:40.081348 [debug] [Thread-1  ]: On model.commerce.stg_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_orders"} */
drop view if exists "dbt_database"."staging"."stg_orders__dbt_backup" cascade
20:53:40.082534 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:53:40.084781 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.085939 [debug] [Thread-1  ]: On model.commerce.stg_orders: Close
20:53:40.087409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf8794db50>]}
20:53:40.088853 [info ] [Thread-1  ]: 2 of 4 OK created view model staging.stg_orders................................. [[32mCREATE VIEW[0m in 0.08s]
20:53:40.090244 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:53:40.092922 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:53:40.094145 [info ] [Thread-1  ]: 3 of 4 START view model staging.stg_customersorders............................. [RUN]
20:53:40.096070 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:53:40.098036 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:53:40.099143 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:53:40.103678 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:53:40.113187 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.114523 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:53:40.120418 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.stg_customersorders"
20:53:40.128806 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:53:40.130933 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: BEGIN
20:53:40.132421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:53:40.138272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:53:40.139532 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:53:40.140525 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */

  create view "dbt_database"."staging"."stg_customersorders__dbt_tmp" as (
    select  o.order_id,
        c.full_name,
        o.order_date,
        o.status
from "dbt_database"."staging"."stg_orders" as o
left join "dbt_database"."staging"."stg_customers"  as c on o.customer_id = c.id
  );
20:53:40.143054 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
20:53:40.147776 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:53:40.149257 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
alter table "dbt_database"."staging"."stg_customersorders__dbt_tmp" rename to "stg_customersorders"
20:53:40.151487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:53:40.153842 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:53:40.154897 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:53:40.156013 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: COMMIT
20:53:40.158561 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:53:40.161505 [debug] [Thread-1  ]: Using postgres connection "model.commerce.stg_customersorders"
20:53:40.162633 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.stg_customersorders"} */
drop view if exists "dbt_database"."staging"."stg_customersorders__dbt_backup" cascade
20:53:40.165007 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
20:53:40.167663 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.168782 [debug] [Thread-1  ]: On model.commerce.stg_customersorders: Close
20:53:40.170252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86f2fbe0>]}
20:53:40.171770 [info ] [Thread-1  ]: 3 of 4 OK created view model staging.stg_customersorders........................ [[32mCREATE VIEW[0m in 0.07s]
20:53:40.173226 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:53:40.176095 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:53:40.177512 [info ] [Thread-1  ]: 4 of 4 START table model marts.customers_nb_orders.............................. [RUN]
20:53:40.179525 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:53:40.181503 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:53:40.182786 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:53:40.186720 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:53:40.196736 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.198226 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:53:40.238107 [debug] [Thread-1  ]: Writing runtime SQL for node "model.commerce.customers_nb_orders"
20:53:40.245929 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.247654 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: BEGIN
20:53:40.248607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:53:40.252770 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:53:40.253888 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.255101 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */


  create  table "dbt_database"."marts"."customers_nb_orders__dbt_tmp"
  as (
    select full_name,
      count(order_id) nb_orders  
from "dbt_database"."staging"."stg_customersorders"
group by full_name
  );
20:53:40.261628 [debug] [Thread-1  ]: SQL status: SELECT 62 in 0.01 seconds
20:53:40.267479 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.268587 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders" rename to "customers_nb_orders__dbt_backup"
20:53:40.269932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:53:40.273542 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.274582 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
alter table "dbt_database"."marts"."customers_nb_orders__dbt_tmp" rename to "customers_nb_orders"
20:53:40.275878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:53:40.285524 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:53:40.286764 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.287698 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: COMMIT
20:53:40.290172 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:53:40.293187 [debug] [Thread-1  ]: Using postgres connection "model.commerce.customers_nb_orders"
20:53:40.294279 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "node_id": "model.commerce.customers_nb_orders"} */
drop table if exists "dbt_database"."marts"."customers_nb_orders__dbt_backup" cascade
20:53:40.298471 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:53:40.301533 [debug] [Thread-1  ]: finished collecting timing info
20:53:40.302689 [debug] [Thread-1  ]: On model.commerce.customers_nb_orders: Close
20:53:40.304446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd399d48c-eaf0-4dd3-a637-25e8c5a95706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86f4f9a0>]}
20:53:40.306051 [info ] [Thread-1  ]: 4 of 4 OK created table model marts.customers_nb_orders......................... [[32mSELECT 62[0m in 0.13s]
20:53:40.307465 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:53:40.310941 [debug] [MainThread]: Acquiring new postgres connection "master"
20:53:40.312013 [debug] [MainThread]: Using postgres connection "master"
20:53:40.313548 [debug] [MainThread]: On master: BEGIN
20:53:40.315126 [debug] [MainThread]: Opening a new connection, currently in state closed
20:53:40.320351 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:53:40.321551 [debug] [MainThread]: On master: COMMIT
20:53:40.322759 [debug] [MainThread]: Using postgres connection "master"
20:53:40.323711 [debug] [MainThread]: On master: COMMIT
20:53:40.324920 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:53:40.326163 [debug] [MainThread]: On master: Close
20:53:40.327571 [info ] [MainThread]: 
20:53:40.328868 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0.68s.
20:53:40.331743 [debug] [MainThread]: Connection 'master' was properly closed.
20:53:40.333531 [debug] [MainThread]: Connection 'model.commerce.customers_nb_orders' was properly closed.
20:53:40.355430 [info ] [MainThread]: 
20:53:40.357196 [info ] [MainThread]: [32mCompleted successfully[0m
20:53:40.359458 [info ] [MainThread]: 
20:53:40.364047 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
20:53:40.370677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86be70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86be7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf86f06df0>]}


============================== 2024-07-21 20:54:03.779423 | 643f6aa9-a697-4ba8-87b9-941d340d4628 ==============================
20:54:03.779423 [info ] [MainThread]: Running with dbt=1.0.0
20:54:03.780888 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
20:54:03.783480 [debug] [MainThread]: Tracking: tracking
20:54:03.789504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f7a0ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f7a0fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f7a0f8b0>]}
20:54:04.016660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:54:04.018612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:54:04.037249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '643f6aa9-a697-4ba8-87b9-941d340d4628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f6dfc070>]}
20:54:04.063411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '643f6aa9-a697-4ba8-87b9-941d340d4628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f7163b50>]}
20:54:04.065310 [info ] [MainThread]: Found 4 models, 11 tests, 0 snapshots, 0 analyses, 166 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
20:54:04.071205 [info ] [MainThread]: 
20:54:04.074806 [debug] [MainThread]: Acquiring new postgres connection "master"
20:54:04.078595 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_marts"
20:54:04.099154 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:54:04.100147 [debug] [ThreadPool]: On list_dbt_database_marts: BEGIN
20:54:04.101004 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:04.106873 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:54:04.108283 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_marts"
20:54:04.109808 [debug] [ThreadPool]: On list_dbt_database_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_marts"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
  
20:54:04.113964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
20:54:04.116679 [debug] [ThreadPool]: On list_dbt_database_marts: ROLLBACK
20:54:04.117893 [debug] [ThreadPool]: On list_dbt_database_marts: Close
20:54:04.119423 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_database_staging"
20:54:04.123153 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:54:04.124669 [debug] [ThreadPool]: On list_dbt_database_staging: BEGIN
20:54:04.126752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:54:04.131198 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:54:04.132321 [debug] [ThreadPool]: Using postgres connection "list_dbt_database_staging"
20:54:04.133280 [debug] [ThreadPool]: On list_dbt_database_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "list_dbt_database_staging"} */
select
      'dbt_database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
20:54:04.136343 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
20:54:04.139380 [debug] [ThreadPool]: On list_dbt_database_staging: ROLLBACK
20:54:04.140675 [debug] [ThreadPool]: On list_dbt_database_staging: Close
20:54:04.148688 [debug] [MainThread]: Using postgres connection "master"
20:54:04.149796 [debug] [MainThread]: On master: BEGIN
20:54:04.150724 [debug] [MainThread]: Opening a new connection, currently in state init
20:54:04.154962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:54:04.156212 [debug] [MainThread]: Using postgres connection "master"
20:54:04.157199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:54:04.169799 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
20:54:04.173425 [debug] [MainThread]: On master: ROLLBACK
20:54:04.175081 [debug] [MainThread]: On master: Close
20:54:04.176418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:54:04.177818 [info ] [MainThread]: 
20:54:04.185045 [debug] [Thread-1  ]: Began running node model.commerce.stg_customers
20:54:04.186531 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customers"
20:54:04.189063 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customers
20:54:04.190992 [debug] [Thread-1  ]: Compiling model.commerce.stg_customers
20:54:04.199665 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customers"
20:54:04.216278 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.218987 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customers
20:54:04.229503 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.231592 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customers
20:54:04.233172 [debug] [Thread-1  ]: Began running node model.commerce.stg_orders
20:54:04.235089 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_orders"
20:54:04.236301 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_orders
20:54:04.237483 [debug] [Thread-1  ]: Compiling model.commerce.stg_orders
20:54:04.244606 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_orders"
20:54:04.256863 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.258428 [debug] [Thread-1  ]: Began executing node model.commerce.stg_orders
20:54:04.259821 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.261600 [debug] [Thread-1  ]: Finished running node model.commerce.stg_orders
20:54:04.263230 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:54:04.265396 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:54:04.267013 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:54:04.268269 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_cust_id.93b15e3909
20:54:04.290747 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_cust_id.93b15e3909"
20:54:04.301610 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.303311 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:54:04.304625 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.306375 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_cust_id.93b15e3909
20:54:04.307770 [debug] [Thread-1  ]: Began running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:54:04.309253 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:54:04.310552 [debug] [Thread-1  ]: Began compiling node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:54:04.311759 [debug] [Thread-1  ]: Compiling test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:54:04.319893 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_not_null_raw_ordr_id.7f74ca2883"
20:54:04.332129 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.333696 [debug] [Thread-1  ]: Began executing node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:54:04.334993 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.336620 [debug] [Thread-1  ]: Finished running node test.commerce.source_not_null_raw_ordr_id.7f74ca2883
20:54:04.337976 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:54:04.339857 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:54:04.341069 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:54:04.342339 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:54:04.357584 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_cust_id.dc9b348fa2"
20:54:04.368748 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.370165 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:54:04.371602 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.373849 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_cust_id.dc9b348fa2
20:54:04.375220 [debug] [Thread-1  ]: Began running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:54:04.376833 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:54:04.378381 [debug] [Thread-1  ]: Began compiling node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:54:04.379987 [debug] [Thread-1  ]: Compiling test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:54:04.455403 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.source_unique_raw_ordr_id.4f0ddf7783"
20:54:04.467310 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.468881 [debug] [Thread-1  ]: Began executing node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:54:04.470311 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.472210 [debug] [Thread-1  ]: Finished running node test.commerce.source_unique_raw_ordr_id.4f0ddf7783
20:54:04.474037 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:54:04.475898 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:54:04.477316 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:54:04.478720 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_customers_id.6bd2c50f02
20:54:04.486822 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_customers_id.6bd2c50f02"
20:54:04.496503 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.497750 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:54:04.498671 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.499924 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_customers_id.6bd2c50f02
20:54:04.500955 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_customers_id.a6a76acf47
20:54:04.502197 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_customers_id.a6a76acf47"
20:54:04.503163 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_customers_id.a6a76acf47
20:54:04.504130 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_customers_id.a6a76acf47
20:54:04.509526 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_customers_id.a6a76acf47"
20:54:04.517590 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.518928 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_customers_id.a6a76acf47
20:54:04.520031 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.521334 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_customers_id.a6a76acf47
20:54:04.522883 [debug] [Thread-1  ]: Began running node model.commerce.stg_customersorders
20:54:04.524476 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.stg_customersorders"
20:54:04.525422 [debug] [Thread-1  ]: Began compiling node model.commerce.stg_customersorders
20:54:04.526337 [debug] [Thread-1  ]: Compiling model.commerce.stg_customersorders
20:54:04.530408 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.stg_customersorders"
20:54:04.537846 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.539501 [debug] [Thread-1  ]: Began executing node model.commerce.stg_customersorders
20:54:04.540520 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.541747 [debug] [Thread-1  ]: Finished running node model.commerce.stg_customersorders
20:54:04.542778 [debug] [Thread-1  ]: Began running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:54:04.544153 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:54:04.545130 [debug] [Thread-1  ]: Began compiling node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:54:04.546051 [debug] [Thread-1  ]: Compiling test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:54:04.560870 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec"
20:54:04.569396 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.570728 [debug] [Thread-1  ]: Began executing node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:54:04.571932 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.573724 [debug] [Thread-1  ]: Finished running node test.commerce.accepted_values_stg_orders_status__placed__completed__returned__return_pending__shipped.28db4404ec
20:54:04.574813 [debug] [Thread-1  ]: Began running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:54:04.576042 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:54:04.576972 [debug] [Thread-1  ]: Began compiling node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:54:04.577910 [debug] [Thread-1  ]: Compiling test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:54:04.582934 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.not_null_stg_orders_order_id.81cfe2fe64"
20:54:04.592015 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.593278 [debug] [Thread-1  ]: Began executing node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:54:04.594275 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.595544 [debug] [Thread-1  ]: Finished running node test.commerce.not_null_stg_orders_order_id.81cfe2fe64
20:54:04.596563 [debug] [Thread-1  ]: Began running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:54:04.597766 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:54:04.598700 [debug] [Thread-1  ]: Began compiling node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:54:04.599623 [debug] [Thread-1  ]: Compiling test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:54:04.611351 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a"
20:54:04.621303 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.623622 [debug] [Thread-1  ]: Began executing node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:54:04.625009 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.626313 [debug] [Thread-1  ]: Finished running node test.commerce.relationships_stg_orders_customer_id__id__ref_stg_customers_.c4293d696a
20:54:04.627437 [debug] [Thread-1  ]: Began running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:54:04.628657 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:54:04.629582 [debug] [Thread-1  ]: Began compiling node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:54:04.630486 [debug] [Thread-1  ]: Compiling test.commerce.unique_stg_orders_order_id.e3b841c71a
20:54:04.636215 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.unique_stg_orders_order_id.e3b841c71a"
20:54:04.644979 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.646272 [debug] [Thread-1  ]: Began executing node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:54:04.647529 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.649116 [debug] [Thread-1  ]: Finished running node test.commerce.unique_stg_orders_order_id.e3b841c71a
20:54:04.650368 [debug] [Thread-1  ]: Began running node model.commerce.customers_nb_orders
20:54:04.652063 [debug] [Thread-1  ]: Acquiring new postgres connection "model.commerce.customers_nb_orders"
20:54:04.653144 [debug] [Thread-1  ]: Began compiling node model.commerce.customers_nb_orders
20:54:04.654291 [debug] [Thread-1  ]: Compiling model.commerce.customers_nb_orders
20:54:04.658430 [debug] [Thread-1  ]: Writing injected SQL for node "model.commerce.customers_nb_orders"
20:54:04.666184 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.667472 [debug] [Thread-1  ]: Began executing node model.commerce.customers_nb_orders
20:54:04.668614 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.669954 [debug] [Thread-1  ]: Finished running node model.commerce.customers_nb_orders
20:54:04.671759 [debug] [Thread-1  ]: Began running node test.commerce.customers_nb_orders_check
20:54:04.673519 [debug] [Thread-1  ]: Acquiring new postgres connection "test.commerce.customers_nb_orders_check"
20:54:04.674623 [debug] [Thread-1  ]: Began compiling node test.commerce.customers_nb_orders_check
20:54:04.675762 [debug] [Thread-1  ]: Compiling test.commerce.customers_nb_orders_check
20:54:04.680437 [debug] [Thread-1  ]: Writing injected SQL for node "test.commerce.customers_nb_orders_check"
20:54:04.689765 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.690972 [debug] [Thread-1  ]: Began executing node test.commerce.customers_nb_orders_check
20:54:04.692121 [debug] [Thread-1  ]: finished collecting timing info
20:54:04.693971 [debug] [Thread-1  ]: Finished running node test.commerce.customers_nb_orders_check
20:54:04.696281 [debug] [MainThread]: Connection 'master' was properly closed.
20:54:04.697337 [debug] [MainThread]: Connection 'test.commerce.customers_nb_orders_check' was properly closed.
20:54:04.715837 [info ] [MainThread]: Done.
20:54:04.738060 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:54:04.740439 [info ] [MainThread]: Building catalog
20:54:04.747074 [debug] [ThreadPool]: Acquiring new postgres connection "dbt_database.information_schema"
20:54:04.763426 [debug] [ThreadPool]: Using postgres connection "dbt_database.information_schema"
20:54:04.764795 [debug] [ThreadPool]: On dbt_database.information_schema: BEGIN
20:54:04.765943 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:04.771216 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:54:04.773533 [debug] [ThreadPool]: Using postgres connection "dbt_database.information_schema"
20:54:04.774930 [debug] [ThreadPool]: On dbt_database.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "commerce", "target_name": "dev", "connection_name": "dbt_database.information_schema"} */

    
    

    select
        'dbt_database' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('staging') or upper(sch.nspname) = upper('raw') or upper(sch.nspname) = upper('marts'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:54:04.782733 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.0 seconds
20:54:04.803355 [debug] [ThreadPool]: On dbt_database.information_schema: ROLLBACK
20:54:04.805206 [debug] [ThreadPool]: On dbt_database.information_schema: Close
20:54:04.833386 [info ] [MainThread]: Catalog written to /app/dbt_project/target/catalog.json
20:54:04.835217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f6d2d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f6d2da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f6d2dcd0>]}
20:54:05.229392 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:54:05.240469 [debug] [MainThread]: Connection 'dbt_database.information_schema' was properly closed.


============================== 2024-07-21 20:54:21.848112 | 4a08d21f-ae07-416b-9b67-73c824023cbb ==============================
20:54:21.848112 [info ] [MainThread]: Running with dbt=1.0.0
20:54:21.849320 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
20:54:21.851873 [debug] [MainThread]: Tracking: tracking
20:54:21.859066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5ad53e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5ad53bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5ad53d30>]}
20:54:21.882020 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:54:21.883693 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:54:21.886764 [info ] [MainThread]: 
20:54:21.890646 [info ] [MainThread]: 
20:54:21.893644 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2024-07-21 20:54:41.985341 | 248f43c3-f344-4be3-a8da-59dfaa8291ab ==============================
20:54:41.985341 [info ] [MainThread]: Running with dbt=1.0.0
20:54:41.986625 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/app/dbt_project', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
20:54:41.989963 [debug] [MainThread]: Tracking: tracking
20:54:41.996374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e8d93b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e8d93a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e8d93130>]}
20:54:42.027030 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:54:42.029192 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:54:42.031169 [info ] [MainThread]: 
20:54:42.036768 [info ] [MainThread]: 
20:54:42.038648 [info ] [MainThread]: Press Ctrl+C to exit.
